var BrowserFS=(()=>{var bn=Object.defineProperty;var Zc=Object.getOwnPropertyDescriptor;var Vc=Object.getOwnPropertyNames;var Wc=Object.prototype.hasOwnProperty;var yn=Math.pow;var Dt=(r,t)=>{for(var e in t)bn(r,e,{get:t[e],enumerable:!0})},qc=(r,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Vc(t))!Wc.call(r,n)&&n!==e&&bn(r,n,{get:()=>t[n],enumerable:!(i=Zc(t,n))||i.enumerable});return r};var Yc=r=>qc(bn({},"__esModule",{value:!0}),r);var Oh={};Dt(Oh,{BFSRequire:()=>Hc,EmscriptenFS:()=>_r,Errors:()=>Fn,FileSystem:()=>$r,configure:()=>kh,configureAsync:()=>Bh,getFileSystem:()=>mn,initialize:()=>ya,install:()=>xh,registerFileSystem:()=>Ah,setImmediate:()=>xe});var En={};Dt(En,{Buffer:()=>g,INSPECT_MAX_BYTES:()=>Aa,SlowBuffer:()=>nu,isBuffer:()=>Pa,kMaxLength:()=>Qc});var De=[],Ce=[],Kc=typeof Uint8Array!="undefined"?Uint8Array:Array,_n=!1;function Fa(){_n=!0;for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,e=r.length;t<e;++t)De[t]=r[t],Ce[r.charCodeAt(t)]=t;Ce["-".charCodeAt(0)]=62,Ce["_".charCodeAt(0)]=63}function Xc(r){_n||Fa();var t,e,i,n,s,a,o=r.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s=r[o-2]==="="?2:r[o-1]==="="?1:0,a=new Kc(o*3/4-s),i=s>0?o-4:o;var c=0;for(t=0,e=0;t<i;t+=4,e+=3)n=Ce[r.charCodeAt(t)]<<18|Ce[r.charCodeAt(t+1)]<<12|Ce[r.charCodeAt(t+2)]<<6|Ce[r.charCodeAt(t+3)],a[c++]=n>>16&255,a[c++]=n>>8&255,a[c++]=n&255;return s===2?(n=Ce[r.charCodeAt(t)]<<2|Ce[r.charCodeAt(t+1)]>>4,a[c++]=n&255):s===1&&(n=Ce[r.charCodeAt(t)]<<10|Ce[r.charCodeAt(t+1)]<<4|Ce[r.charCodeAt(t+2)]>>2,a[c++]=n>>8&255,a[c++]=n&255),a}function Gc(r){return De[r>>18&63]+De[r>>12&63]+De[r>>6&63]+De[r&63]}function $c(r,t,e){for(var i,n=[],s=t;s<e;s+=3)i=(r[s]<<16)+(r[s+1]<<8)+r[s+2],n.push(Gc(i));return n.join("")}function va(r){_n||Fa();for(var t,e=r.length,i=e%3,n="",s=[],a=16383,o=0,c=e-i;o<c;o+=a)s.push($c(r,o,o+a>c?c:o+a));return i===1?(t=r[e-1],n+=De[t>>2],n+=De[t<<4&63],n+="=="):i===2&&(t=(r[e-2]<<8)+r[e-1],n+=De[t>>10],n+=De[t>>4&63],n+=De[t<<2&63],n+="="),s.push(n),s.join("")}function ii(r,t,e,i,n){var s,a,o=n*8-i-1,c=(1<<o)-1,l=c>>1,u=-7,d=e?n-1:0,h=e?-1:1,p=r[t+d];for(d+=h,s=p&(1<<-u)-1,p>>=-u,u+=o;u>0;s=s*256+r[t+d],d+=h,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=i;u>0;a=a*256+r[t+d],d+=h,u-=8);if(s===0)s=1-l;else{if(s===c)return a?NaN:(p?-1:1)*(1/0);a=a+Math.pow(2,i),s=s-l}return(p?-1:1)*a*Math.pow(2,s-i)}function Ca(r,t,e,i,n,s){var a,o,c,l=s*8-n-1,u=(1<<l)-1,d=u>>1,h=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,m=i?1:-1,y=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+d>=1?t+=h/c:t+=h*Math.pow(2,1-d),t*c>=2&&(a++,c/=2),a+d>=u?(o=0,a=u):a+d>=1?(o=(t*c-1)*Math.pow(2,n),a=a+d):(o=t*Math.pow(2,d-1)*Math.pow(2,n),a=0));n>=8;r[e+p]=o&255,p+=m,o/=256,n-=8);for(a=a<<n|o,l+=n;l>0;r[e+p]=a&255,p+=m,a/=256,l-=8);r[e+p-m]|=y*128}var Jc={}.toString,xa=Array.isArray||function(r){return Jc.call(r)=="[object Array]"};var Aa=50;g.TYPED_ARRAY_SUPPORT=globalThis.TYPED_ARRAY_SUPPORT!==void 0?globalThis.TYPED_ARRAY_SUPPORT:!0;var Qc=ti();function ti(){return g.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function je(r,t){if(ti()<t)throw new RangeError("Invalid typed array length");return g.TYPED_ARRAY_SUPPORT?(r=new Uint8Array(t),r.__proto__=g.prototype):(r===null&&(r=new g(t)),r.length=t),r}function g(r,t,e){if(!g.TYPED_ARRAY_SUPPORT&&!(this instanceof g))return new g(r,t,e);if(typeof r=="number"){if(typeof t=="string")throw new Error("If encoding is specified then the first argument must be a string");return vn(this,r)}return ka(this,r,t,e)}g.poolSize=8192;g._augment=function(r){return r.__proto__=g.prototype,r};function ka(r,t,e,i){if(typeof t=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer?ru(r,t,e,i):typeof t=="string"?tu(r,t,e):iu(r,t)}g.from=function(r,t,e){return ka(null,r,t,e)};g.TYPED_ARRAY_SUPPORT&&(g.prototype.__proto__=Uint8Array.prototype,g.__proto__=Uint8Array);function Ba(r){if(typeof r!="number")throw new TypeError('"size" argument must be a number');if(r<0)throw new RangeError('"size" argument must not be negative')}function eu(r,t,e,i){return Ba(t),t<=0?je(r,t):e!==void 0?typeof i=="string"?je(r,t).fill(e,i):je(r,t).fill(e):je(r,t)}g.alloc=function(r,t,e){return eu(null,r,t,e)};function vn(r,t){if(Ba(t),r=je(r,t<0?0:wn(t)|0),!g.TYPED_ARRAY_SUPPORT)for(var e=0;e<t;++e)r[e]=0;return r}g.allocUnsafe=function(r){return vn(null,r)};g.allocUnsafeSlow=function(r){return vn(null,r)};function tu(r,t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!g.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var i=Oa(t,e)|0;r=je(r,i);var n=r.write(t,e);return n!==i&&(r=r.slice(0,n)),r}function Sn(r,t){var e=t.length<0?0:wn(t.length)|0;r=je(r,e);for(var i=0;i<e;i+=1)r[i]=t[i]&255;return r}function ru(r,t,e,i){if(t.byteLength,e<0||t.byteLength<e)throw new RangeError("'offset' is out of bounds");if(t.byteLength<e+(i||0))throw new RangeError("'length' is out of bounds");return e===void 0&&i===void 0?t=new Uint8Array(t):i===void 0?t=new Uint8Array(t,e):t=new Uint8Array(t,e,i),g.TYPED_ARRAY_SUPPORT?(r=t,r.__proto__=g.prototype):r=Sn(r,t),r}function iu(r,t){if(Re(t)){var e=wn(t.length)|0;return r=je(r,e),r.length===0||t.copy(r,0,0,e),r}if(t){if(typeof ArrayBuffer!="undefined"&&t.buffer instanceof ArrayBuffer||"length"in t)return typeof t.length!="number"||Eu(t.length)?je(r,0):Sn(r,t);if(t.type==="Buffer"&&xa(t.data))return Sn(r,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function wn(r){if(r>=ti())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ti().toString(16)+" bytes");return r|0}function nu(r){return+r!=r&&(r=0),g.alloc(+r)}g.isBuffer=Pa;function Re(r){return!!(r!=null&&r._isBuffer)}g.compare=function(t,e){if(!Re(t)||!Re(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,s=0,a=Math.min(i,n);s<a;++s)if(t[s]!==e[s]){i=t[s],n=e[s];break}return i<n?-1:n<i?1:0};g.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};g.concat=function(t,e){if(!xa(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return g.alloc(0);var i;if(e===void 0)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=g.allocUnsafe(e),s=0;for(i=0;i<t.length;++i){var a=t[i];if(!Re(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,s),s+=a.length}return n};function Oa(r,t){if(Re(r))return r.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(r)||r instanceof ArrayBuffer))return r.byteLength;typeof r!="string"&&(r=""+r);var e=r.length;if(e===0)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return ri(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return Ma(r).length;default:if(i)return ri(r).length;t=(""+t).toLowerCase(),i=!0}}g.byteLength=Oa;function su(r,t,e){var i=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,t>>>=0,e<=t))return"";for(r||(r="utf8");;)switch(r){case"hex":return gu(this,t,e);case"utf8":case"utf-8":return Da(this,t,e);case"ascii":return hu(this,t,e);case"latin1":case"binary":return pu(this,t,e);case"base64":return fu(this,t,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return mu(this,t,e);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}g.prototype._isBuffer=!0;function Rt(r,t,e){var i=r[t];r[t]=r[e],r[e]=i}g.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Rt(this,e,e+1);return this};g.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Rt(this,e,e+3),Rt(this,e+1,e+2);return this};g.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Rt(this,e,e+7),Rt(this,e+1,e+6),Rt(this,e+2,e+5),Rt(this,e+3,e+4);return this};g.prototype.toString=function(){var t=this.length|0;return t===0?"":arguments.length===0?Da(this,0,t):su.apply(this,arguments)};g.prototype.equals=function(t){if(!Re(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:g.compare(this,t)===0};g.prototype.inspect=function(){var t="",e=Aa;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"};g.prototype.compare=function(t,e,i,n,s){if(!Re(t))throw new TypeError("Argument must be a Buffer");if(e===void 0&&(e=0),i===void 0&&(i=t?t.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),e<0||i>t.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&e>=i)return 0;if(n>=s)return-1;if(e>=i)return 1;if(e>>>=0,i>>>=0,n>>>=0,s>>>=0,this===t)return 0;for(var a=s-n,o=i-e,c=Math.min(a,o),l=this.slice(n,s),u=t.slice(e,i),d=0;d<c;++d)if(l[d]!==u[d]){a=l[d],o=u[d];break}return a<o?-1:o<a?1:0};function Ia(r,t,e,i,n){if(r.length===0)return-1;if(typeof e=="string"?(i=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=n?0:r.length-1),e<0&&(e=r.length+e),e>=r.length){if(n)return-1;e=r.length-1}else if(e<0)if(n)e=0;else return-1;if(typeof t=="string"&&(t=g.from(t,i)),Re(t))return t.length===0?-1:wa(r,t,e,i,n);if(typeof t=="number")return t=t&255,g.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,t,e):Uint8Array.prototype.lastIndexOf.call(r,t,e):wa(r,[t],e,i,n);throw new TypeError("val must be string, number or Buffer")}function wa(r,t,e,i,n){var s=1,a=r.length,o=t.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||t.length<2)return-1;s=2,a/=2,o/=2,e/=2}function c(p,m){return s===1?p[m]:p.readUInt16BE(m*s)}var l;if(n){var u=-1;for(l=e;l<a;l++)if(c(r,l)===c(t,u===-1?0:l-u)){if(u===-1&&(u=l),l-u+1===o)return u*s}else u!==-1&&(l-=l-u),u=-1}else for(e+o>a&&(e=a-o),l=e;l>=0;l--){for(var d=!0,h=0;h<o;h++)if(c(r,l+h)!==c(t,h)){d=!1;break}if(d)return l}return-1}g.prototype.includes=function(t,e,i){return this.indexOf(t,e,i)!==-1};g.prototype.indexOf=function(t,e,i){return Ia(this,t,e,i,!0)};g.prototype.lastIndexOf=function(t,e,i){return Ia(this,t,e,i,!1)};function au(r,t,e,i){e=Number(e)||0;var n=r.length-e;i?(i=Number(i),i>n&&(i=n)):i=n;var s=t.length;if(s%2!==0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var a=0;a<i;++a){var o=parseInt(t.substr(a*2,2),16);if(isNaN(o))return a;r[e+a]=o}return a}function ou(r,t,e,i){return ai(ri(t,r.length-e),r,e,i)}function Ta(r,t,e,i){return ai(vu(t),r,e,i)}function lu(r,t,e,i){return Ta(r,t,e,i)}function cu(r,t,e,i){return ai(Ma(t),r,e,i)}function uu(r,t,e,i){return ai(wu(t,r.length-e),r,e,i)}g.prototype.write=function(t,e,i,n){if(e===void 0)n="utf8",i=this.length,e=0;else if(i===void 0&&typeof e=="string")n=e,i=this.length,e=0;else if(isFinite(e))e=e|0,isFinite(i)?(i=i|0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s=this.length-e;if((i===void 0||i>s)&&(i=s),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return au(this,t,e,i);case"utf8":case"utf-8":return ou(this,t,e,i);case"ascii":return Ta(this,t,e,i);case"latin1":case"binary":return lu(this,t,e,i);case"base64":return cu(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return uu(this,t,e,i);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}};g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function fu(r,t,e){return t===0&&e===r.length?va(r):va(r.slice(t,e))}function Da(r,t,e){e=Math.min(r.length,e);for(var i=[],n=t;n<e;){var s=r[n],a=null,o=s>239?4:s>223?3:s>191?2:1;if(n+o<=e){var c,l,u,d;switch(o){case 1:s<128&&(a=s);break;case 2:c=r[n+1],(c&192)===128&&(d=(s&31)<<6|c&63,d>127&&(a=d));break;case 3:c=r[n+1],l=r[n+2],(c&192)===128&&(l&192)===128&&(d=(s&15)<<12|(c&63)<<6|l&63,d>2047&&(d<55296||d>57343)&&(a=d));break;case 4:c=r[n+1],l=r[n+2],u=r[n+3],(c&192)===128&&(l&192)===128&&(u&192)===128&&(d=(s&15)<<18|(c&63)<<12|(l&63)<<6|u&63,d>65535&&d<1114112&&(a=d))}}a===null?(a=65533,o=1):a>65535&&(a-=65536,i.push(a>>>10&1023|55296),a=56320|a&1023),i.push(a),n+=o}return du(i)}var Ea=4096;function du(r){var t=r.length;if(t<=Ea)return String.fromCharCode.apply(String,r);for(var e="",i=0;i<t;)e+=String.fromCharCode.apply(String,r.slice(i,i+=Ea));return e}function hu(r,t,e){var i="";e=Math.min(r.length,e);for(var n=t;n<e;++n)i+=String.fromCharCode(r[n]&127);return i}function pu(r,t,e){var i="";e=Math.min(r.length,e);for(var n=t;n<e;++n)i+=String.fromCharCode(r[n]);return i}function gu(r,t,e){var i=r.length;(!t||t<0)&&(t=0),(!e||e<0||e>i)&&(e=i);for(var n="",s=t;s<e;++s)n+=_u(r[s]);return n}function mu(r,t,e){for(var i=r.slice(t,e),n="",s=0;s<i.length;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}g.prototype.slice=function(t,e){var i=this.length;t=~~t,e=e===void 0?i:~~e,t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),e<t&&(e=t);var n;if(g.TYPED_ARRAY_SUPPORT)n=this.subarray(t,e),n.__proto__=g.prototype;else{var s=e-t;n=new g(s,void 0);for(var a=0;a<s;++a)n[a]=this[a+t]}return n};function ae(r,t,e){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+t>e)throw new RangeError("Trying to access beyond buffer length")}g.prototype.readUIntLE=function(t,e,i){t=t|0,e=e|0,i||ae(t,e,this.length);for(var n=this[t],s=1,a=0;++a<e&&(s*=256);)n+=this[t+a]*s;return n};g.prototype.readUIntBE=function(t,e,i){t=t|0,e=e|0,i||ae(t,e,this.length);for(var n=this[t+--e],s=1;e>0&&(s*=256);)n+=this[t+--e]*s;return n};g.prototype.readUInt8=function(t,e){return e||ae(t,1,this.length),this[t]};g.prototype.readUInt16LE=function(t,e){return e||ae(t,2,this.length),this[t]|this[t+1]<<8};g.prototype.readUInt16BE=function(t,e){return e||ae(t,2,this.length),this[t]<<8|this[t+1]};g.prototype.readUInt32LE=function(t,e){return e||ae(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};g.prototype.readUInt32BE=function(t,e){return e||ae(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};g.prototype.readIntLE=function(t,e,i){t=t|0,e=e|0,i||ae(t,e,this.length);for(var n=this[t],s=1,a=0;++a<e&&(s*=256);)n+=this[t+a]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*e)),n};g.prototype.readIntBE=function(t,e,i){t=t|0,e=e|0,i||ae(t,e,this.length);for(var n=e,s=1,a=this[t+--n];n>0&&(s*=256);)a+=this[t+--n]*s;return s*=128,a>=s&&(a-=Math.pow(2,8*e)),a};g.prototype.readInt8=function(t,e){return e||ae(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]};g.prototype.readInt16LE=function(t,e){e||ae(t,2,this.length);var i=this[t]|this[t+1]<<8;return i&32768?i|4294901760:i};g.prototype.readInt16BE=function(t,e){e||ae(t,2,this.length);var i=this[t+1]|this[t]<<8;return i&32768?i|4294901760:i};g.prototype.readInt32LE=function(t,e){return e||ae(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};g.prototype.readInt32BE=function(t,e){return e||ae(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};g.prototype.readFloatLE=function(t,e){return e||ae(t,4,this.length),ii(this,t,!0,23,4)};g.prototype.readFloatBE=function(t,e){return e||ae(t,4,this.length),ii(this,t,!1,23,4)};g.prototype.readDoubleLE=function(t,e){return e||ae(t,8,this.length),ii(this,t,!0,52,8)};g.prototype.readDoubleBE=function(t,e){return e||ae(t,8,this.length),ii(this,t,!1,52,8)};function me(r,t,e,i,n,s){if(!Re(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw new RangeError('"value" argument is out of bounds');if(e+i>r.length)throw new RangeError("Index out of range")}g.prototype.writeUIntLE=function(t,e,i,n){if(t=+t,e=e|0,i=i|0,!n){var s=Math.pow(2,8*i)-1;me(this,t,e,i,s,0)}var a=1,o=0;for(this[e]=t&255;++o<i&&(a*=256);)this[e+o]=t/a&255;return e+i};g.prototype.writeUIntBE=function(t,e,i,n){if(t=+t,e=e|0,i=i|0,!n){var s=Math.pow(2,8*i)-1;me(this,t,e,i,s,0)}var a=i-1,o=1;for(this[e+a]=t&255;--a>=0&&(o*=256);)this[e+a]=t/o&255;return e+i};g.prototype.writeUInt8=function(t,e,i){return t=+t,e=e|0,i||me(this,t,e,1,255,0),g.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t&255,e+1};function ni(r,t,e,i){t<0&&(t=65535+t+1);for(var n=0,s=Math.min(r.length-e,2);n<s;++n)r[e+n]=(t&255<<8*(i?n:1-n))>>>(i?n:1-n)*8}g.prototype.writeUInt16LE=function(t,e,i){return t=+t,e=e|0,i||me(this,t,e,2,65535,0),g.TYPED_ARRAY_SUPPORT?(this[e]=t&255,this[e+1]=t>>>8):ni(this,t,e,!0),e+2};g.prototype.writeUInt16BE=function(t,e,i){return t=+t,e=e|0,i||me(this,t,e,2,65535,0),g.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t&255):ni(this,t,e,!1),e+2};function si(r,t,e,i){t<0&&(t=4294967295+t+1);for(var n=0,s=Math.min(r.length-e,4);n<s;++n)r[e+n]=t>>>(i?n:3-n)*8&255}g.prototype.writeUInt32LE=function(t,e,i){return t=+t,e=e|0,i||me(this,t,e,4,4294967295,0),g.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t&255):si(this,t,e,!0),e+4};g.prototype.writeUInt32BE=function(t,e,i){return t=+t,e=e|0,i||me(this,t,e,4,4294967295,0),g.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255):si(this,t,e,!1),e+4};g.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e=e|0,!n){var s=Math.pow(2,8*i-1);me(this,t,e,i,s-1,-s)}var a=0,o=1,c=0;for(this[e]=t&255;++a<i&&(o*=256);)t<0&&c===0&&this[e+a-1]!==0&&(c=1),this[e+a]=(t/o>>0)-c&255;return e+i};g.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e=e|0,!n){var s=Math.pow(2,8*i-1);me(this,t,e,i,s-1,-s)}var a=i-1,o=1,c=0;for(this[e+a]=t&255;--a>=0&&(o*=256);)t<0&&c===0&&this[e+a+1]!==0&&(c=1),this[e+a]=(t/o>>0)-c&255;return e+i};g.prototype.writeInt8=function(t,e,i){return t=+t,e=e|0,i||me(this,t,e,1,127,-128),g.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=t&255,e+1};g.prototype.writeInt16LE=function(t,e,i){return t=+t,e=e|0,i||me(this,t,e,2,32767,-32768),g.TYPED_ARRAY_SUPPORT?(this[e]=t&255,this[e+1]=t>>>8):ni(this,t,e,!0),e+2};g.prototype.writeInt16BE=function(t,e,i){return t=+t,e=e|0,i||me(this,t,e,2,32767,-32768),g.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t&255):ni(this,t,e,!1),e+2};g.prototype.writeInt32LE=function(t,e,i){return t=+t,e=e|0,i||me(this,t,e,4,2147483647,-2147483648),g.TYPED_ARRAY_SUPPORT?(this[e]=t&255,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):si(this,t,e,!0),e+4};g.prototype.writeInt32BE=function(t,e,i){return t=+t,e=e|0,i||me(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),g.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255):si(this,t,e,!1),e+4};function Ra(r,t,e,i,n,s){if(e+i>r.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function Na(r,t,e,i,n){return n||Ra(r,t,e,4),Ca(r,t,e,i,23,4),e+4}g.prototype.writeFloatLE=function(t,e,i){return Na(this,t,e,!0,i)};g.prototype.writeFloatBE=function(t,e,i){return Na(this,t,e,!1,i)};function La(r,t,e,i,n){return n||Ra(r,t,e,8),Ca(r,t,e,i,52,8),e+8}g.prototype.writeDoubleLE=function(t,e,i){return La(this,t,e,!0,i)};g.prototype.writeDoubleBE=function(t,e,i){return La(this,t,e,!1,i)};g.prototype.copy=function(t,e,i,n){if(i||(i=0),!n&&n!==0&&(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var s=n-i,a;if(this===t&&i<e&&e<n)for(a=s-1;a>=0;--a)t[a+e]=this[a+i];else if(s<1e3||!g.TYPED_ARRAY_SUPPORT)for(a=0;a<s;++a)t[a+e]=this[a+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+s),e);return s};g.prototype.fill=function(t,e,i,n){if(typeof t=="string"){if(typeof e=="string"?(n=e,e=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),t.length===1){var s=t.charCodeAt(0);s<256&&(t=s)}if(n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!g.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else typeof t=="number"&&(t=t&255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;e=e>>>0,i=i===void 0?this.length:i>>>0,t||(t=0);var a;if(typeof t=="number")for(a=e;a<i;++a)this[a]=t;else{var o=Re(t)?t:ri(new g(t,n).toString()),c=o.length;for(a=0;a<i-e;++a)this[a+e]=o[a%c]}return this};var bu=/[^+\/0-9A-Za-z-_]/g;function yu(r){if(r=Su(r).replace(bu,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function Su(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function _u(r){return r<16?"0"+r.toString(16):r.toString(16)}function ri(r,t){t=t||1/0;for(var e,i=r.length,n=null,s=[],a=0;a<i;++a){if(e=r.charCodeAt(a),e>55295&&e<57344){if(!n){if(e>56319){(t-=3)>-1&&s.push(239,191,189);continue}else if(a+1===i){(t-=3)>-1&&s.push(239,191,189);continue}n=e;continue}if(e<56320){(t-=3)>-1&&s.push(239,191,189),n=e;continue}e=(n-55296<<10|e-56320)+65536}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,e<128){if((t-=1)<0)break;s.push(e)}else if(e<2048){if((t-=2)<0)break;s.push(e>>6|192,e&63|128)}else if(e<65536){if((t-=3)<0)break;s.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((t-=4)<0)break;s.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return s}function vu(r){for(var t=[],e=0;e<r.length;++e)t.push(r.charCodeAt(e)&255);return t}function wu(r,t){for(var e,i,n,s=[],a=0;a<r.length&&!((t-=2)<0);++a)e=r.charCodeAt(a),i=e>>8,n=e%256,s.push(n),s.push(i);return s}function Ma(r){return Xc(yu(r))}function ai(r,t,e,i){for(var n=0;n<i&&!(n+e>=t.length||n>=r.length);++n)t[n+e]=r[n];return n}function Eu(r){return r!==r}function Pa(r){return r!=null&&(!!r._isBuffer||Ua(r)||Fu(r))}function Ua(r){return!!r.constructor&&typeof r.constructor.isBuffer=="function"&&r.constructor.isBuffer(r)}function Fu(r){return typeof r.readFloatLE=="function"&&typeof r.slice=="function"&&Ua(r.slice(0,0))}var Fn={};Dt(Fn,{ApiError:()=>f,ErrorCode:()=>H,ErrorStrings:()=>J});var H=(y=>(y[y.EPERM=1]="EPERM",y[y.ENOENT=2]="ENOENT",y[y.EIO=5]="EIO",y[y.EBADF=9]="EBADF",y[y.EACCES=13]="EACCES",y[y.EBUSY=16]="EBUSY",y[y.EEXIST=17]="EEXIST",y[y.ENOTDIR=20]="ENOTDIR",y[y.EISDIR=21]="EISDIR",y[y.EINVAL=22]="EINVAL",y[y.EFBIG=27]="EFBIG",y[y.ENOSPC=28]="ENOSPC",y[y.EROFS=30]="EROFS",y[y.ENOTEMPTY=39]="ENOTEMPTY",y[y.ENOTSUP=95]="ENOTSUP",y))(H||{}),J={};J[1]="Operation not permitted.";J[2]="No such file or directory.";J[5]="Input/output error.";J[9]="Bad file descriptor.";J[13]="Permission denied.";J[16]="Resource busy or locked.";J[17]="File exists.";J[20]="File is not a directory.";J[21]="File is a directory.";J[22]="Invalid argument.";J[27]="File is too big.";J[28]="No space left on disk.";J[30]="Cannot modify a read-only file system.";J[39]="Directory is not empty.";J[95]="Operation is not supported.";var f=class extends Error{constructor(e,i=J[e],n){super(i);this.syscall="";this.errno=e,this.code=H[e],this.path=n,this.message=`Error: ${this.code}: ${i}${this.path?`, '${this.path}'`:""}`}static fromJSON(e){let i=new f(e.errno,e.message,e.path);return i.code=e.code,i.stack=e.stack,i}static fromBuffer(e,i=0){return f.fromJSON(JSON.parse(e.toString("utf8",i+4,i+4+e.readUInt32LE(i))))}static FileError(e,i){return new f(e,J[e],i)}static EACCES(e){return this.FileError(13,e)}static ENOENT(e){return this.FileError(2,e)}static EEXIST(e){return this.FileError(17,e)}static EISDIR(e){return this.FileError(21,e)}static ENOTDIR(e){return this.FileError(20,e)}static EPERM(e){return this.FileError(1,e)}static ENOTEMPTY(e){return this.FileError(39,e)}toString(){return this.message}toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message}}writeToBuffer(e=g.alloc(this.bufferSize()),i=0){let n=e.write(JSON.stringify(this.toJSON()),i+4);return e.writeUInt32LE(n,i),e}bufferSize(){return 4+g.byteLength(JSON.stringify(this.toJSON()))}};var Nt=class{static getFileFlag(t){return Nt.flagCache.has(t)||Nt.flagCache.set(t,new Nt(t)),Nt.flagCache.get(t)}constructor(t){if(this.flagStr=t,Nt.validFlagStrs.indexOf(t)<0)throw new f(22,"Invalid flag: "+t)}getFlagString(){return this.flagStr}getMode(){let t=0;return t<<=1,t+=+this.isReadable(),t<<=1,t+=+this.isWriteable(),t<<=1,t}isReadable(){return this.flagStr.indexOf("r")!==-1||this.flagStr.indexOf("+")!==-1}isWriteable(){return this.flagStr.indexOf("w")!==-1||this.flagStr.indexOf("a")!==-1||this.flagStr.indexOf("+")!==-1}isTruncating(){return this.flagStr.indexOf("w")!==-1}isAppendable(){return this.flagStr.indexOf("a")!==-1}isSynchronous(){return this.flagStr.indexOf("s")!==-1}isExclusive(){return this.flagStr.indexOf("x")!==-1}pathExistsAction(){return this.isExclusive()?1:this.isTruncating()?2:0}pathNotExistsAction(){return(this.isWriteable()||this.isAppendable())&&this.flagStr!=="r+"?3:1}},T=Nt;T.flagCache=new Map,T.validFlagStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"];var be={};Dt(be,{basename:()=>$,default:()=>xu,delimiter:()=>Ha,dirname:()=>B,extname:()=>ja,isAbsolute:()=>An,join:()=>V,normalize:()=>xn,relative:()=>oi,resolve:()=>Y,sep:()=>ot});function za(r,t){for(var e=0,i=r.length-1;i>=0;i--){var n=r[i];n==="."?r.splice(i,1):n===".."?(r.splice(i,1),e++):e&&(r.splice(i,1),e--)}if(t)for(;e--;e)r.unshift("..");return r}var Cu=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Cn=function(r){return Cu.exec(r).slice(1)};function Y(){for(var r="",t=!1,e=arguments.length-1;e>=-1&&!t;e--){var i=e>=0?arguments[e]:"/";if(typeof i!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!i)continue;r=i+"/"+r,t=i.charAt(0)==="/"}return r=za(kn(r.split("/"),function(n){return!!n}),!t).join("/"),(t?"/":"")+r||"."}function xn(r){var t=An(r),e=Au(r,-1)==="/";return r=za(kn(r.split("/"),function(i){return!!i}),!t).join("/"),!r&&!t&&(r="."),r&&e&&(r+="/"),(t?"/":"")+r}function An(r){return r.charAt(0)==="/"}function V(){var r=Array.prototype.slice.call(arguments,0);return xn(kn(r,function(t,e){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function oi(r,t){r=Y(r).substr(1),t=Y(t).substr(1);function e(l){for(var u=0;u<l.length&&l[u]==="";u++);for(var d=l.length-1;d>=0&&l[d]==="";d--);return u>d?[]:l.slice(u,d-u+1)}for(var i=e(r.split("/")),n=e(t.split("/")),s=Math.min(i.length,n.length),a=s,o=0;o<s;o++)if(i[o]!==n[o]){a=o;break}for(var c=[],o=a;o<i.length;o++)c.push("..");return c=c.concat(n.slice(a)),c.join("/")}var ot="/",Ha=":";function B(r){var t=Cn(r),e=t[0],i=t[1];return!e&&!i?".":(i&&(i=i.substr(0,i.length-1)),e+i)}function $(r,t){var e=Cn(r)[2];return t&&e.substr(-1*t.length)===t&&(e=e.substr(0,e.length-t.length)),e}function ja(r){return Cn(r)[3]}var xu={extname:ja,basename:$,dirname:B,sep:ot,delimiter:Ha,relative:oi,join:V,isAbsolute:An,normalize:xn,resolve:Y};function kn(r,t){if(r.filter)return r.filter(t);for(var e=[],i=0;i<r.length;i++)t(r[i],i,r)&&e.push(r[i]);return e}var Au="ab".substr(-1)==="b"?function(r,t,e){return r.substr(t,e)}:function(r,t,e){return t<0&&(t=r.length+t),r.substr(t,e)};var Bn=class{constructor(t,e,i,n,s,a){this.uid=t;this.gid=e;this.suid=i;this.sgid=n;this.euid=s;this.egid=a}},z=Bn;z.Root=new Bn(0,0,0,0,0,0);var C=class{constructor(t,e,i,n,s,a,o,c,l){this.dev=0;this.ino=0;this.rdev=0;this.nlink=1;this.blksize=4096;this.uid=0;this.gid=0;this.fileData=null;this.size=e;let u=0;if(typeof n!="number"&&(u=Date.now(),n=u),typeof s!="number"&&(u||(u=Date.now()),s=u),typeof a!="number"&&(u||(u=Date.now()),a=u),typeof l!="number"&&(u||(u=Date.now()),l=u),typeof o!="number"&&(o=0),typeof c!="number"&&(c=0),this.atimeMs=n,this.ctimeMs=a,this.mtimeMs=s,this.birthtimeMs=l,i)this.mode=i;else switch(t){case 32768:this.mode=420;break;case 16384:default:this.mode=511}this.blocks=Math.ceil(e/512),this.mode<4096&&(this.mode|=t)}static fromBuffer(t){let e=t.readUInt32LE(0),i=t.readUInt32LE(4),n=t.readDoubleLE(8),s=t.readDoubleLE(16),a=t.readDoubleLE(24),o=t.readUInt32LE(32),c=t.readUInt32LE(36);return new C(i&61440,e,i&4095,n,s,a,o,c)}static clone(t){return new C(t.mode&61440,t.size,t.mode&4095,t.atimeMs,t.mtimeMs,t.ctimeMs,t.uid,t.gid,t.birthtimeMs)}get atime(){return new Date(this.atimeMs)}get mtime(){return new Date(this.mtimeMs)}get ctime(){return new Date(this.ctimeMs)}get birthtime(){return new Date(this.birthtimeMs)}toBuffer(){let t=g.alloc(32);return t.writeUInt32LE(this.size,0),t.writeUInt32LE(this.mode,4),t.writeDoubleLE(this.atime.getTime(),8),t.writeDoubleLE(this.mtime.getTime(),16),t.writeDoubleLE(this.ctime.getTime(),24),t.writeUInt32LE(this.uid,32),t.writeUInt32LE(this.gid,36),t}isFile(){return(this.mode&61440)===32768}isDirectory(){return(this.mode&61440)===16384}isSymbolicLink(){return(this.mode&61440)===40960}hasAccess(t,e){if(e.euid===0||e.egid===0)return!0;let i=this.mode&4095,n=15,s=15,a=15;if(e.euid==this.uid){let l=(3840&i)>>8;n=(t^l)&t}if(e.egid==this.gid){let l=(240&i)>>4;s=(t^l)&t}let o=15&i;return a=(t^o)&t,!(n&s&a)}getCred(t=this.uid,e=this.gid){return new z(t,e,this.uid,this.gid,t,e)}chmod(t){this.mode=this.mode&61440|t}chown(t,e){!isNaN(+t)&&0<=+t&&+t<yn(2,32)&&(this.uid=t),!isNaN(+e)&&0<=+e&&+e<yn(2,32)&&(this.gid=e)}isSocket(){return!1}isBlockDevice(){return!1}isCharacterDevice(){return!1}isFIFO(){return!1}};var yr;if(typeof setImmediate!="undefined")yr=setImmediate;else{let r=globalThis,t=[],e="zero-timeout-message";if(function(){if(typeof r.importScripts!="undefined"||!r.postMessage)return!1;let n=!0,s=r.onmessage;return r.onmessage=function(){n=!1},r.postMessage("","*"),r.onmessage=s,n}()){yr=function(s){t.push(s),r.postMessage(e,"*")};let n=function(s){if(s.source===self&&s.data===e&&(s.stopPropagation?s.stopPropagation():s.cancelBubble=!0,t.length>0))return t.shift()()};r.addEventListener?r.addEventListener("message",n,!0):r.attachEvent("onmessage",n)}else if(r.MessageChannel){let n=new r.MessageChannel;n.port1.onmessage=s=>{if(t.length>0)return t.shift()()},yr=s=>{t.push(s),n.port2.postMessage("")}}else yr=function(n){return setTimeout(n,0)}}var xe=yr;var Va=function(r,t){return r};function D(r,t){if(typeof r!="function")throw new Error("Callback must be a function.");let e=Va(r,t);switch(t){case 1:return function(i){xe(function(){return e(i)})};case 2:return function(i,n){xe(function(){return e(i,n)})};case 3:return function(i,n,s){xe(function(){return e(i,n,s)})};default:throw new Error("Invalid invocation of wrapCb.")}}function A(r){if(r)return r;throw new f(5,"Initialize BrowserFS with a file system using BrowserFS.initialize(filesystem)")}function lt(r,t){switch(typeof r){case"number":return r;case"string":let e=parseInt(r,8);return isNaN(e)?t:e;default:return t}}function $t(r){if(r instanceof Date)return r;if(typeof r=="number")return new Date(r*1e3);throw new f(22,"Invalid time.")}function F(r){if(r.indexOf("\0")>=0)throw new f(22,"Path must be a string without null bytes.");if(r==="")throw new f(22,"Path must not be empty.");return Y(r)}function Jt(r,t,e,i){switch(r===null?"null":typeof r){case"object":return{encoding:typeof r.encoding!="undefined"?r.encoding:t,flag:typeof r.flag!="undefined"?r.flag:e,mode:lt(r.mode,i)};case"string":return{encoding:r,flag:e,mode:i};case"null":case"undefined":case"function":return{encoding:t,flag:e,mode:i};default:throw new TypeError(`"options" must be a string or an object, got ${typeof r} instead.`)}}function O(){}var Ze=class{constructor(){this.F_OK=0;this.R_OK=4;this.W_OK=2;this.X_OK=1;this.root=null;this.fdMap={};this.nextFd=100}initialize(t,e){if(!t.constructor.isAvailable())throw new f(22,"Tried to instantiate BrowserFS with an unavailable file system.");return this.cred=e,this.root=t}_toUnixTimestamp(t){if(typeof t=="number")return t;if(t instanceof Date)return t.getTime()/1e3;throw new Error("Cannot parse time: "+t)}getRootFS(){return this.root?this.root:null}rename(t,e,i=O){let n=D(i,1);try{A(this.root).rename(F(t),F(e),this.cred,n)}catch(s){n(s)}}renameSync(t,e){A(this.root).renameSync(F(t),F(e),this.cred)}exists(t,e=O){let i=D(e,1);try{return A(this.root).exists(F(t),this.cred,i)}catch(n){return i(!1)}}existsSync(t){try{return A(this.root).existsSync(F(t),this.cred)}catch(e){return!1}}stat(t,e=O){let i=D(e,2);try{return A(this.root).stat(F(t),!1,this.cred,i)}catch(n){return i(n)}}statSync(t){return A(this.root).statSync(F(t),!1,this.cred)}lstat(t,e=O){let i=D(e,2);try{return A(this.root).stat(F(t),!0,this.cred,i)}catch(n){return i(n)}}lstatSync(t){return A(this.root).statSync(F(t),!0,this.cred)}truncate(t,e=0,i=O){let n=0;typeof e=="function"?i=e:typeof e=="number"&&(n=e);let s=D(i,1);try{if(n<0)throw new f(22);return A(this.root).truncate(F(t),n,this.cred,s)}catch(a){return s(a)}}truncateSync(t,e=0){if(e<0)throw new f(22);return A(this.root).truncateSync(F(t),e,this.cred)}unlink(t,e=O){let i=D(e,1);try{return A(this.root).unlink(F(t),this.cred,i)}catch(n){return i(n)}}unlinkSync(t){return A(this.root).unlinkSync(F(t),this.cred)}open(t,e,i,n=O){let s=lt(i,420);n=typeof i=="function"?i:n;let a=D(n,2);try{A(this.root).open(F(t),T.getFileFlag(e),s,this.cred,(o,c)=>{c?a(o,this.getFdForFile(c)):a(o)})}catch(o){a(o)}}openSync(t,e,i=420){return this.getFdForFile(A(this.root).openSync(F(t),T.getFileFlag(e),lt(i,420),this.cred))}readFile(t,e={},i=O){let n=Jt(e,null,"r",null);i=typeof e=="function"?e:i;let s=D(i,2);try{let a=T.getFileFlag(n.flag);return a.isReadable()?A(this.root).readFile(F(t),n.encoding,a,this.cred,s):s(new f(22,"Flag passed to readFile must allow for reading."))}catch(a){return s(a)}}readFileSync(t,e={}){let i=Jt(e,null,"r",null),n=T.getFileFlag(i.flag);if(!n.isReadable())throw new f(22,"Flag passed to readFile must allow for reading.");return A(this.root).readFileSync(F(t),i.encoding,n,this.cred)}writeFile(t,e,i={},n=O){let s=Jt(i,"utf8","w",420);n=typeof i=="function"?i:n;let a=D(n,1);try{let o=T.getFileFlag(s.flag);return o.isWriteable()?A(this.root).writeFile(F(t),e,s.encoding,o,s.mode,this.cred,a):a(new f(22,"Flag passed to writeFile must allow for writing."))}catch(o){return a(o)}}writeFileSync(t,e,i){let n=Jt(i,"utf8","w",420),s=T.getFileFlag(n.flag);if(!s.isWriteable())throw new f(22,"Flag passed to writeFile must allow for writing.");return A(this.root).writeFileSync(F(t),e,n.encoding,s,n.mode,this.cred)}appendFile(t,e,i,n=O){let s=Jt(i,"utf8","a",420);n=typeof i=="function"?i:n;let a=D(n,1);try{let o=T.getFileFlag(s.flag);if(!o.isAppendable())return a(new f(22,"Flag passed to appendFile must allow for appending."));A(this.root).appendFile(F(t),e,s.encoding,o,s.mode,this.cred,a)}catch(o){a(o)}}appendFileSync(t,e,i){let n=Jt(i,"utf8","a",420),s=T.getFileFlag(n.flag);if(!s.isAppendable())throw new f(22,"Flag passed to appendFile must allow for appending.");return A(this.root).appendFileSync(F(t),e,n.encoding,s,n.mode,this.cred)}fstat(t,e=O){let i=D(e,2);try{this.fd2file(t).stat(i)}catch(n){i(n)}}fstatSync(t){return this.fd2file(t).statSync()}close(t,e=O){let i=D(e,1);try{this.fd2file(t).close(n=>{n||this.closeFd(t),i(n)})}catch(n){i(n)}}closeSync(t){this.fd2file(t).closeSync(),this.closeFd(t)}ftruncate(t,e,i=O){let n=typeof e=="number"?e:0;i=typeof e=="function"?e:i;let s=D(i,1);try{let a=this.fd2file(t);if(n<0)throw new f(22);a.truncate(n,s)}catch(a){s(a)}}ftruncateSync(t,e=0){let i=this.fd2file(t);if(e<0)throw new f(22);i.truncateSync(e)}fsync(t,e=O){let i=D(e,1);try{this.fd2file(t).sync(i)}catch(n){i(n)}}fsyncSync(t){this.fd2file(t).syncSync()}fdatasync(t,e=O){let i=D(e,1);try{this.fd2file(t).datasync(i)}catch(n){i(n)}}fdatasyncSync(t){this.fd2file(t).datasyncSync()}write(t,e,i,n,s,a=O){let o,c,l,u=null;if(typeof e=="string"){let h="utf8";switch(typeof i){case"function":a=i;break;case"number":u=i,h=typeof n=="string"?n:"utf8",a=typeof s=="function"?s:a;break;default:return a=typeof n=="function"?n:typeof s=="function"?s:a,a(new f(22,"Invalid arguments."))}o=g.from(e,h),c=0,l=o.length}else o=e,c=i,l=n,u=typeof s=="number"?s:null,a=typeof s=="function"?s:a;let d=D(a,3);try{let h=this.fd2file(t);u==null&&(u=h.getPos()),h.write(o,c,l,u,d)}catch(h){d(h)}}writeSync(t,e,i,n,s){let a,o=0,c,l;if(typeof e=="string"){l=typeof i=="number"?i:null;let d=typeof n=="string"?n:"utf8";o=0,a=g.from(e,d),c=a.length}else a=e,o=i,c=n,l=typeof s=="number"?s:null;let u=this.fd2file(t);return l==null&&(l=u.getPos()),u.writeSync(a,o,c,l)}read(t,e,i,n,s,a=O){let o,c,l,u,d;if(typeof e=="number"){l=e,o=i;let h=n;a=typeof s=="function"?s:a,c=0,u=g.alloc(l),d=D((p,m,y)=>{if(p)return a(p);a(p,y.toString(h),m)},3)}else u=e,c=i,l=n,o=s,d=D(a,3);try{let h=this.fd2file(t);o==null&&(o=h.getPos()),h.read(u,c,l,o,d)}catch(h){d(h)}}readSync(t,e,i,n,s){let a=!1,o,c,l,u,d="utf8";typeof e=="number"?(l=e,u=i,d=n,c=0,o=g.alloc(l),a=!0):(o=e,c=i,l=n,u=s);let h=this.fd2file(t);u==null&&(u=h.getPos());let p=h.readSync(o,c,l,u);return a?[o.toString(d),p]:p}fchown(t,e,i,n=O){let s=D(n,1);try{this.fd2file(t).chown(e,i,s)}catch(a){s(a)}}fchownSync(t,e,i){this.fd2file(t).chownSync(e,i)}fchmod(t,e,i){let n=D(i,1);try{let s=typeof e=="string"?parseInt(e,8):e;this.fd2file(t).chmod(s,n)}catch(s){n(s)}}fchmodSync(t,e){let i=typeof e=="string"?parseInt(e,8):e;this.fd2file(t).chmodSync(i)}futimes(t,e,i,n=O){let s=D(n,1);try{let a=this.fd2file(t);typeof e=="number"&&(e=new Date(e*1e3)),typeof i=="number"&&(i=new Date(i*1e3)),a.utimes(e,i,s)}catch(a){s(a)}}futimesSync(t,e,i){this.fd2file(t).utimesSync($t(e),$t(i))}rmdir(t,e=O){let i=D(e,1);try{t=F(t),A(this.root).rmdir(t,this.cred,i)}catch(n){i(n)}}rmdirSync(t){return t=F(t),A(this.root).rmdirSync(t,this.cred)}mkdir(t,e,i=O){typeof e=="function"&&(i=e,e=511);let n=D(i,1);try{t=F(t),A(this.root).mkdir(t,e,this.cred,n)}catch(s){n(s)}}mkdirSync(t,e){A(this.root).mkdirSync(F(t),lt(e,511),this.cred)}readdir(t,e=O){let i=D(e,2);try{t=F(t),A(this.root).readdir(t,this.cred,i)}catch(n){i(n)}}readdirSync(t){return t=F(t),A(this.root).readdirSync(t,this.cred)}link(t,e,i=O){let n=D(i,1);try{t=F(t),e=F(e),A(this.root).link(t,e,this.cred,n)}catch(s){n(s)}}linkSync(t,e){return t=F(t),e=F(e),A(this.root).linkSync(t,e,this.cred)}symlink(t,e,i,n=O){let s=typeof i=="string"?i:"file";n=typeof i=="function"?i:n;let a=D(n,1);try{if(s!=="file"&&s!=="dir")return a(new f(22,"Invalid type: "+s));t=F(t),e=F(e),A(this.root).symlink(t,e,s,this.cred,a)}catch(o){a(o)}}symlinkSync(t,e,i){if(!i)i="file";else if(i!=="file"&&i!=="dir")throw new f(22,"Invalid type: "+i);return t=F(t),e=F(e),A(this.root).symlinkSync(t,e,i,this.cred)}readlink(t,e=O){let i=D(e,2);try{t=F(t),A(this.root).readlink(t,this.cred,i)}catch(n){i(n)}}readlinkSync(t){return t=F(t),A(this.root).readlinkSync(t,this.cred)}chown(t,e,i,n=O){let s=D(n,1);try{t=F(t),A(this.root).chown(t,!1,e,i,this.cred,s)}catch(a){s(a)}}chownSync(t,e,i){t=F(t),A(this.root).chownSync(t,!1,e,i,this.cred)}lchown(t,e,i,n=O){let s=D(n,1);try{t=F(t),A(this.root).chown(t,!0,e,i,this.cred,s)}catch(a){s(a)}}lchownSync(t,e,i){t=F(t),A(this.root).chownSync(t,!0,e,i,this.cred)}chmod(t,e,i=O){let n=D(i,1);try{let s=lt(e,-1);if(s<0)throw new f(22,"Invalid mode.");A(this.root).chmod(F(t),!1,s,this.cred,n)}catch(s){n(s)}}chmodSync(t,e){let i=lt(e,-1);if(i<0)throw new f(22,"Invalid mode.");t=F(t),A(this.root).chmodSync(t,!1,i,this.cred)}lchmod(t,e,i=O){let n=D(i,1);try{let s=lt(e,-1);if(s<0)throw new f(22,"Invalid mode.");A(this.root).chmod(F(t),!0,s,this.cred,n)}catch(s){n(s)}}lchmodSync(t,e){let i=lt(e,-1);if(i<1)throw new f(22,"Invalid mode.");A(this.root).chmodSync(F(t),!0,i,this.cred)}utimes(t,e,i,n=O){let s=D(n,1);try{A(this.root).utimes(F(t),$t(e),$t(i),this.cred,s)}catch(a){s(a)}}utimesSync(t,e,i){A(this.root).utimesSync(F(t),$t(e),$t(i),this.cred)}realpath(t,e,i=O){let n=typeof e=="object"?e:{};i=typeof e=="function"?e:O;let s=D(i,2);try{t=F(t),A(this.root).realpath(t,n,this.cred,s)}catch(a){s(a)}}realpathSync(t,e={}){return t=F(t),A(this.root).realpathSync(t,e,this.cred)}watchFile(t,e,i=O){throw new f(95)}unwatchFile(t,e=O){throw new f(95)}watch(t,e,i=O){throw new f(95)}access(t,e,i=O){let n=typeof e=="number"?e:4;i=typeof e=="function"?e:O;let s=D(i,2);try{t=F(t),A(this.root).access(t,n,this.cred,s)}catch(a){s(a)}}accessSync(t,e=384){return t=F(t),A(this.root).accessSync(t,e,this.cred)}createReadStream(t,e){throw new f(95)}createWriteStream(t,e){throw new f(95)}wrapCallbacks(t){Va=t}getFdForFile(t){let e=this.nextFd++;return this.fdMap[e]=t,e}fd2file(t){let e=this.fdMap[t];if(e)return e;throw new f(9,"Invalid file descriptor.")}closeFd(t){delete this.fdMap[t]}};Ze.Stats=C;var Qt=new Ze,Lt={};for(let r of Object.getOwnPropertyNames(Ze.prototype))typeof Qt[r]=="function"?Lt[r]=function(...t){return Qt[r].apply(Qt,t)}:Lt[r]=Qt[r];Lt.changeFSModule=function(r){Qt=r};Lt.getFSModule=function(){return Qt};Lt.FS=Ze;Lt.Stats=Ze.Stats;var re=Lt;var Nn={};Dt(Nn,{arrayBuffer2Buffer:()=>ft,buffer2ArrayBuffer:()=>ut,buffer2Uint8array:()=>Mt,bufferValidator:()=>Sr,checkOptions:()=>Rn,copyingSlice:()=>Ve,deprecationMessage:()=>ku,emptyBuffer:()=>_e,fail:()=>Dn,isIE:()=>Tn,isWebWorker:()=>Bu,mkdirpSync:()=>ci,uint8Array2Buffer:()=>ct});function li(r,t,e,i,n){return r<t||e<t?r>e?e+1:r+1:i===n?t:t+1}function On(r,t){if(r===t)return 0;if(r.length>t.length){let h=r;r=t,t=h}let e=r.length,i=t.length;for(;e>0&&r.charCodeAt(e-1)===t.charCodeAt(i-1);)e--,i--;let n=0;for(;n<e&&r.charCodeAt(n)===t.charCodeAt(n);)n++;if(e-=n,i-=n,e===0||i===1)return i;let s=new Array(e<<1);for(let h=0;h<e;)s[e+h]=r.charCodeAt(n+h),s[h]=++h;let a,o,c,l,u;for(a=0;a+3<i;){let h=t.charCodeAt(n+(o=a)),p=t.charCodeAt(n+(c=a+1)),m=t.charCodeAt(n+(l=a+2)),y=t.charCodeAt(n+(u=a+3)),b=a+=4;for(let S=0;S<e;){let w=s[e+S],x=s[S];o=li(x,o,c,h,w),c=li(o,c,l,p,w),l=li(c,l,u,m,w),b=li(l,u,b,y,w),s[S++]=b,u=l,l=c,c=o,o=x}}let d=0;for(;a<i;){let h=t.charCodeAt(n+(o=a));d=++a;for(let p=0;p<e;p++){let m=s[p];s[p]=d=m<o||d<o?m>d?d+1:m+1:h===s[e+p]?o:o+1,o=m}}return d}function ku(r,t,e){r&&console.warn(`[${t}] Direct file system constructor usage is deprecated for this file system, and will be removed in the next major version. Please use the '${t}.Create(${JSON.stringify(e)}, callback)' method instead. See https://github.com/jvilk/BrowserFS/issues/176 for more details.`)}var Tn=typeof navigator!="undefined"&&!!(/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||navigator.userAgent.indexOf("Trident")!==-1),Bu=typeof window=="undefined";function Dn(){throw new Error("BFS has reached an impossible code path; please file a bug.")}function ci(r,t,e,i){i.existsSync(r,e)||(ci(B(r),t,e,i),i.mkdirSync(r,t,e))}function ut(r){let t=Mt(r),e=t.byteOffset,i=t.byteLength;return e===0&&i===t.buffer.byteLength?t.buffer:t.buffer.slice(e,e+i)}function Mt(r){return r instanceof Uint8Array?r:new Uint8Array(r)}function ct(r){return r instanceof g?r:r.byteOffset===0&&r.byteLength===r.buffer.byteLength?ft(r.buffer):g.from(r.buffer,r.byteOffset,r.byteLength)}function ft(r){return g.from(r)}function Ve(r,t=0,e=r.length){if(t<0||e<0||e>r.length||t>e)throw new TypeError(`Invalid slice bounds on buffer of length ${r.length}: [${t}, ${e}]`);if(r.length===0)return _e();{let i=Mt(r),n=r[0],s=(n+1)%255;return r[0]=s,i[0]===s?(i[0]=n,ct(i.slice(t,e))):(r[0]=n,ct(i.subarray(t,e)))}}var In=null;function _e(){return In||(In=g.alloc(0))}function Sr(r,t){g.isBuffer(r)?t():t(new f(22,"option must be a Buffer."))}function Rn(r,t,e){let i=r.Options,n=r.Name,s=0,a=!1,o=!1;function c(l){a||(l&&(a=!0,e(l)),s--,s===0&&o&&e())}for(let l in i)if(Object.prototype.hasOwnProperty.call(i,l)){let u=i[l],d=t&&t[l];if(d==null){if(!u.optional){let h=Object.keys(t).filter(p=>!(p in i)).map(p=>({str:p,distance:On(l,p)})).filter(p=>p.distance<5).sort((p,m)=>p.distance-m.distance);return a?void 0:(a=!0,e(new f(22,`[${n}] Required option '${l}' not provided.${h.length>0?` You provided unrecognized option '${h[0].str}'; perhaps you meant to type '${l}'.`:""}
Option description: ${u.description}`)))}}else{let h=!1;if(Array.isArray(u.type)?h=u.type.indexOf(typeof d)!==-1:h=typeof d===u.type,h)u.validator&&(s++,u.validator(d,c));else return a?void 0:(a=!0,e(new f(22,`[${n}] Value provided for option ${l} is not the proper type. Expected ${Array.isArray(u.type)?`one of {${u.type.join(", ")}}`:u.type}, but received ${typeof d}
Option description: ${u.description}`)))}}o=!0,s===0&&!a&&e()}var Ln=class{constructor(t){this.fs=t;this.nodefs=t.getNodeFS(),this.FS=t.getFS(),this.PATH=t.getPATH(),this.ERRNO_CODES=t.getERRNO_CODES()}open(t){let e=this.fs.realPath(t.node),i=this.FS;try{i.isFile(t.node.mode)&&(t.nfd=this.nodefs.openSync(e,this.fs.flagsToPermissionString(t.flags)))}catch(n){throw n.code?new i.ErrnoError(this.ERRNO_CODES[n.code]):n}}close(t){let e=this.FS;try{e.isFile(t.node.mode)&&t.nfd&&this.nodefs.closeSync(t.nfd)}catch(i){throw i.code?new e.ErrnoError(this.ERRNO_CODES[i.code]):i}}read(t,e,i,n,s){try{return this.nodefs.readSync(t.nfd,ct(e),i,n,s)}catch(a){throw new this.FS.ErrnoError(this.ERRNO_CODES[a.code])}}write(t,e,i,n,s){try{return this.nodefs.writeSync(t.nfd,ct(e),i,n,s)}catch(a){throw new this.FS.ErrnoError(this.ERRNO_CODES[a.code])}}llseek(t,e,i){let n=e;if(i===1)n+=t.position;else if(i===2&&this.FS.isFile(t.node.mode))try{let s=this.nodefs.fstatSync(t.nfd);n+=s.size}catch(s){throw new this.FS.ErrnoError(this.ERRNO_CODES[s.code])}if(n<0)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return t.position=n,n}},Mn=class{constructor(t){this.fs=t;this.nodefs=t.getNodeFS(),this.FS=t.getFS(),this.PATH=t.getPATH(),this.ERRNO_CODES=t.getERRNO_CODES()}getattr(t){let e=this.fs.realPath(t),i;try{i=this.nodefs.lstatSync(e)}catch(n){throw n.code?new this.FS.ErrnoError(this.ERRNO_CODES[n.code]):n}return{dev:i.dev,ino:i.ino,mode:i.mode,nlink:i.nlink,uid:i.uid,gid:i.gid,rdev:i.rdev,size:i.size,atime:i.atime,mtime:i.mtime,ctime:i.ctime,blksize:i.blksize,blocks:i.blocks}}setattr(t,e){let i=this.fs.realPath(t);try{if(e.mode!==void 0&&(this.nodefs.chmodSync(i,e.mode),t.mode=e.mode),e.timestamp!==void 0){let n=new Date(e.timestamp);this.nodefs.utimesSync(i,n,n)}}catch(n){if(!n.code)throw n;if(n.code!=="ENOTSUP")throw new this.FS.ErrnoError(this.ERRNO_CODES[n.code])}if(e.size!==void 0)try{this.nodefs.truncateSync(i,e.size)}catch(n){throw n.code?new this.FS.ErrnoError(this.ERRNO_CODES[n.code]):n}}lookup(t,e){let i=this.PATH.join2(this.fs.realPath(t),e),n=this.fs.getMode(i);return this.fs.createNode(t,e,n)}mknod(t,e,i,n){let s=this.fs.createNode(t,e,i,n),a=this.fs.realPath(s);try{this.FS.isDir(s.mode)?this.nodefs.mkdirSync(a,s.mode):this.nodefs.writeFileSync(a,"",{mode:s.mode})}catch(o){throw o.code?new this.FS.ErrnoError(this.ERRNO_CODES[o.code]):o}return s}rename(t,e,i){let n=this.fs.realPath(t),s=this.PATH.join2(this.fs.realPath(e),i);try{this.nodefs.renameSync(n,s),t.name=i,t.parent=e}catch(a){throw a.code?new this.FS.ErrnoError(this.ERRNO_CODES[a.code]):a}}unlink(t,e){let i=this.PATH.join2(this.fs.realPath(t),e);try{this.nodefs.unlinkSync(i)}catch(n){throw n.code?new this.FS.ErrnoError(this.ERRNO_CODES[n.code]):n}}rmdir(t,e){let i=this.PATH.join2(this.fs.realPath(t),e);try{this.nodefs.rmdirSync(i)}catch(n){throw n.code?new this.FS.ErrnoError(this.ERRNO_CODES[n.code]):n}}readdir(t){let e=this.fs.realPath(t);try{let i=this.nodefs.readdirSync(e);return i.push(".",".."),i}catch(i){throw i.code?new this.FS.ErrnoError(this.ERRNO_CODES[i.code]):i}}symlink(t,e,i){let n=this.PATH.join2(this.fs.realPath(t),e);try{this.nodefs.symlinkSync(i,n)}catch(s){throw s.code?new this.FS.ErrnoError(this.ERRNO_CODES[s.code]):s}}readlink(t){let e=this.fs.realPath(t);try{return this.nodefs.readlinkSync(e)}catch(i){throw i.code?new this.FS.ErrnoError(this.ERRNO_CODES[i.code]):i}}},_r=class{constructor(t=self.FS,e=self.PATH,i=self.ERRNO_CODES,n=re){this.flagsToPermissionStringMap={0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"};this.nodefs=n,this.FS=t,this.PATH=e,this.ERRNO_CODES=i,this.node_ops=new Mn(this),this.stream_ops=new Ln(this)}mount(t){return this.createNode(null,"/",this.getMode(t.opts.root),0)}createNode(t,e,i,n){let s=this.FS;if(!s.isDir(i)&&!s.isFile(i)&&!s.isLink(i))throw new s.ErrnoError(this.ERRNO_CODES.EINVAL);let a=s.createNode(t,e,i);return a.node_ops=this.node_ops,a.stream_ops=this.stream_ops,a}getMode(t){let e;try{e=this.nodefs.lstatSync(t)}catch(i){throw i.code?new this.FS.ErrnoError(this.ERRNO_CODES[i.code]):i}return e.mode}realPath(t){let e=[];for(;t.parent!==t;)e.push(t.name),t=t.parent;return e.push(t.mount.opts.root),e.reverse(),this.PATH.join.apply(null,e)}flagsToPermissionString(t){let e=typeof t=="string"?parseInt(t,10):t;return e&=8191,e in this.flagsToPermissionStringMap?this.flagsToPermissionStringMap[e]:t}getNodeFS(){return this.nodefs}getFS(){return this.FS}getPATH(){return this.PATH}getERRNO_CODES(){return this.ERRNO_CODES}};var ie=class{supportsLinks(){return!1}diskSpace(t,e){e(0,0)}openFile(t,e,i,n){throw new f(95)}createFile(t,e,i,n,s){throw new f(95)}open(t,e,i,n,s){let a=(o,c)=>{if(o)switch(e.pathNotExistsAction()){case 3:return this.stat(B(t),!1,n,(l,u)=>{l?s(l):u&&!u.isDirectory()?s(f.ENOTDIR(B(t))):this.createFile(t,e,i,n,s)});case 1:return s(f.ENOENT(t));default:return s(new f(22,"Invalid FileFlag object."))}else switch(e.pathExistsAction()){case 1:return s(f.EEXIST(t));case 2:return this.openFile(t,e,n,(l,u)=>{l?s(l):u?u.truncate(0,()=>{u.sync(()=>{s(null,u)})}):Dn()});case 0:return this.openFile(t,e,n,s);default:return s(new f(22,"Invalid FileFlag object."))}};this.stat(t,!1,n,a)}access(t,e,i,n){n(new f(95))}accessSync(t,e,i){throw new f(95)}rename(t,e,i,n){n(new f(95))}renameSync(t,e,i){throw new f(95)}stat(t,e,i,n){n(new f(95))}statSync(t,e,i){throw new f(95)}openFileSync(t,e,i){throw new f(95)}createFileSync(t,e,i,n){throw new f(95)}openSync(t,e,i,n){let s;try{s=this.statSync(t,!1,n)}catch(a){switch(e.pathNotExistsAction()){case 3:if(!this.statSync(B(t),!1,n).isDirectory())throw f.ENOTDIR(B(t));return this.createFileSync(t,e,i,n);case 1:throw f.ENOENT(t);default:throw new f(22,"Invalid FileFlag object.")}}if(!s.hasAccess(i,n))throw f.EACCES(t);switch(e.pathExistsAction()){case 1:throw f.EEXIST(t);case 2:return this.unlinkSync(t,n),this.createFileSync(t,e,s.mode,n);case 0:return this.openFileSync(t,e,n);default:throw new f(22,"Invalid FileFlag object.")}}unlink(t,e,i){i(new f(95))}unlinkSync(t,e){throw new f(95)}rmdir(t,e,i){i(new f(95))}rmdirSync(t,e){throw new f(95)}mkdir(t,e,i,n){n(new f(95))}mkdirSync(t,e,i){throw new f(95)}readdir(t,e,i){i(new f(95))}readdirSync(t,e){throw new f(95)}exists(t,e,i){this.stat(t,null,e,function(n){i(!n)})}existsSync(t,e){try{return this.statSync(t,!0,e),!0}catch(i){return!1}}realpath(t,e,i,n){if(this.supportsLinks()){let s=t.split(ot);for(let a=0;a<s.length;a++){let o=s.slice(0,a+1);s[a]=V.apply(null,o)}}else this.exists(t,i,function(s){s?n(null,t):n(f.ENOENT(t))})}realpathSync(t,e,i){if(this.supportsLinks()){let n=t.split(ot);for(let s=0;s<n.length;s++){let a=n.slice(0,s+1);n[s]=V.apply(be,a)}return n.join(ot)}else{if(this.existsSync(t,i))return t;throw f.ENOENT(t)}}truncate(t,e,i,n){this.open(t,T.getFileFlag("r+"),420,i,function(s,a){if(s)return n(s);a.truncate(e,function(o){a.close(function(c){n(o||c)})})})}truncateSync(t,e,i){let n=this.openSync(t,T.getFileFlag("r+"),420,i);try{n.truncateSync(e)}finally{n.closeSync()}}readFile(t,e,i,n,s){let a=s;this.open(t,i,420,n,(o,c)=>{if(o)return s(o);s=function(l,u){c.close(function(d){return l||(l=d),a(l,u)})},c.stat((l,u)=>{if(l)return s(l);let d=g.alloc(u.size);c.read(d,0,u.size,0,h=>{if(h)return s(h);if(e===null)return s(h,d);try{s(null,d.toString(e))}catch(p){s(p)}})})})}readFileSync(t,e,i,n){let s=this.openSync(t,i,420,n);try{let a=s.statSync(),o=g.alloc(a.size);return s.readSync(o,0,a.size,0),s.closeSync(),e===null?o:o.toString(e)}finally{s.closeSync()}}writeFile(t,e,i,n,s,a,o){let c=o;this.open(t,n,420,a,function(l,u){if(l)return o(l);o=function(d){u.close(function(h){c(d||h)})};try{typeof e=="string"&&(e=g.from(e,i))}catch(d){return o(d)}u.write(e,0,e.length,0,o)})}writeFileSync(t,e,i,n,s,a){let o=this.openSync(t,n,s,a);try{typeof e=="string"&&(e=g.from(e,i)),o.writeSync(e,0,e.length,0)}finally{o.closeSync()}}appendFile(t,e,i,n,s,a,o){let c=o;this.open(t,n,s,a,function(l,u){if(l)return o(l);o=function(d){u.close(function(h){c(d||h)})},typeof e=="string"&&(e=g.from(e,i)),u.write(e,0,e.length,null,o)})}appendFileSync(t,e,i,n,s,a){let o=this.openSync(t,n,s,a);try{typeof e=="string"&&(e=g.from(e,i)),o.writeSync(e,0,e.length,null)}finally{o.closeSync()}}chmod(t,e,i,n,s){s(new f(95))}chmodSync(t,e,i,n){throw new f(95)}chown(t,e,i,n,s,a){a(new f(95))}chownSync(t,e,i,n,s){throw new f(95)}utimes(t,e,i,n,s){s(new f(95))}utimesSync(t,e,i,n){throw new f(95)}link(t,e,i,n){n(new f(95))}linkSync(t,e,i){throw new f(95)}symlink(t,e,i,n,s){s(new f(95))}symlinkSync(t,e,i,n){throw new f(95)}readlink(t,e,i){i(new f(95))}readlinkSync(t,e){throw new f(95)}},Ae=class extends ie{supportsSynch(){return!0}access(t,e,i,n){try{this.accessSync(t,e,i),n()}catch(s){n(s)}}rename(t,e,i,n){try{this.renameSync(t,e,i),n()}catch(s){n(s)}}stat(t,e,i,n){try{n(null,this.statSync(t,e,i))}catch(s){n(s)}}open(t,e,i,n,s){try{s(null,this.openSync(t,e,i,n))}catch(a){s(a)}}unlink(t,e,i){try{this.unlinkSync(t,e),i()}catch(n){i(n)}}rmdir(t,e,i){try{this.rmdirSync(t,e),i()}catch(n){i(n)}}mkdir(t,e,i,n){try{this.mkdirSync(t,e,i),n()}catch(s){n(s)}}readdir(t,e,i){try{i(null,this.readdirSync(t,e))}catch(n){i(n)}}chmod(t,e,i,n,s){try{this.chmodSync(t,e,i,n),s()}catch(a){s(a)}}chown(t,e,i,n,s,a){try{this.chownSync(t,e,i,n,s),a()}catch(o){a(o)}}utimes(t,e,i,n,s){try{this.utimesSync(t,e,i,n),s()}catch(a){s(a)}}link(t,e,i,n){try{this.linkSync(t,e,i),n()}catch(s){n(s)}}symlink(t,e,i,n,s){try{this.symlinkSync(t,e,i,n),s()}catch(a){s(a)}}readlink(t,e,i){try{i(null,this.readlinkSync(t,e))}catch(n){i(n)}}};var dt=class{sync(t){t(new f(95))}syncSync(){throw new f(95)}datasync(t){this.sync(t)}datasyncSync(){return this.syncSync()}chown(t,e,i){i(new f(95))}chownSync(t,e){throw new f(95)}chmod(t,e){e(new f(95))}chmodSync(t){throw new f(95)}utimes(t,e,i){i(new f(95))}utimesSync(t,e){throw new f(95)}};var le=class extends dt{constructor(e,i,n,s,a){super();this._pos=0;this._dirty=!1;if(this._fs=e,this._path=i,this._flag=n,this._stat=s,this._buffer=a||_e(),this._stat.size!==this._buffer.length&&this._flag.isReadable())throw new Error(`Invalid buffer: Buffer is ${this._buffer.length} long, yet Stats object specifies that file is ${this._stat.size} long.`)}getBuffer(){return this._buffer}getStats(){return this._stat}getFlag(){return this._flag}getPath(){return this._path}getPos(){return this._flag.isAppendable()?this._stat.size:this._pos}advancePos(e){return this._pos+=e}setPos(e){return this._pos=e}sync(e){try{this.syncSync(),e()}catch(i){e(i)}}syncSync(){throw new f(95)}close(e){try{this.closeSync(),e()}catch(i){e(i)}}closeSync(){throw new f(95)}stat(e){try{e(null,C.clone(this._stat))}catch(i){e(i)}}statSync(){return C.clone(this._stat)}truncate(e,i){try{this.truncateSync(e),this._flag.isSynchronous()&&!re.getRootFS().supportsSynch()&&this.sync(i),i()}catch(n){return i(n)}}truncateSync(e){if(this._dirty=!0,!this._flag.isWriteable())throw new f(1,"File not opened with a writeable mode.");if(this._stat.mtimeMs=Date.now(),e>this._buffer.length){let n=g.alloc(e-this._buffer.length,0);this.writeSync(n,0,n.length,this._buffer.length),this._flag.isSynchronous()&&re.getRootFS().supportsSynch()&&this.syncSync();return}this._stat.size=e;let i=g.alloc(e);this._buffer.copy(i,0,0,e),this._buffer=i,this._flag.isSynchronous()&&re.getRootFS().supportsSynch()&&this.syncSync()}write(e,i,n,s,a){try{a(null,this.writeSync(e,i,n,s),e)}catch(o){a(o)}}writeSync(e,i,n,s){if(this._dirty=!0,s==null&&(s=this.getPos()),!this._flag.isWriteable())throw new f(1,"File not opened with a writeable mode.");let a=s+n;if(a>this._stat.size&&(this._stat.size=a,a>this._buffer.length)){let c=g.alloc(a);this._buffer.copy(c),this._buffer=c}let o=e.copy(this._buffer,s,i,i+n);return this._stat.mtimeMs=Date.now(),this._flag.isSynchronous()?(this.syncSync(),o):(this.setPos(s+o),o)}read(e,i,n,s,a){try{a(null,this.readSync(e,i,n,s),e)}catch(o){a(o)}}readSync(e,i,n,s){if(!this._flag.isReadable())throw new f(1,"File not opened with a readable mode.");s==null&&(s=this.getPos()),s+n>this._stat.size&&(n=this._stat.size-s);let o=this._buffer.copy(e,i,s,s+n);return this._stat.atimeMs=Date.now(),this._pos=s+n,o}chmod(e,i){try{this.chmodSync(e),i()}catch(n){i(n)}}chmodSync(e){if(!this._fs.supportsProps())throw new f(95);this._dirty=!0,this._stat.chmod(e),this.syncSync()}chown(e,i,n){try{this.chownSync(e,i),n()}catch(s){n(s)}}chownSync(e,i){if(!this._fs.supportsProps())throw new f(95);this._dirty=!0,this._stat.chown(e,i),this.syncSync()}isDirty(){return this._dirty}resetDirty(){this._dirty=!1}},ve=class extends le{constructor(t,e,i,n,s){super(t,e,i,n,s)}sync(t){t()}syncSync(){}close(t){t()}closeSync(){}};var Pn=class extends le{constructor(t,e,i,n,s){super(t,e,i,n,s)}syncSync(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())}closeSync(){this.syncSync()}},fi=class extends Ae{constructor(e,i){super();this._queue=[];this._queueRunning=!1;this._isInitialized=!1;this._initializeCallbacks=[];this._sync=e,this._async=i}static Create(e,i){try{let n=new fi(e.sync,e.async);n._initialize(s=>{s?i(s):i(null,n)})}catch(n){i(n)}}static CreateAsync(e){return new Promise((i,n)=>{this.Create(e,(s,a)=>{s||!a?n(s):i(a)})})}static isAvailable(){return!0}getName(){return fi.Name}_syncSync(e){let i=e.getStats();this._sync.writeFileSync(e.getPath(),e.getBuffer(),null,T.getFileFlag("w"),i.mode,i.getCred(0,0)),this.enqueueOp({apiMethod:"writeFile",arguments:[e.getPath(),e.getBuffer(),null,e.getFlag(),i.mode,i.getCred(0,0)]})}isReadOnly(){return!1}supportsSynch(){return!0}supportsLinks(){return!1}supportsProps(){return this._sync.supportsProps()&&this._async.supportsProps()}renameSync(e,i,n){this._sync.renameSync(e,i,n),this.enqueueOp({apiMethod:"rename",arguments:[e,i,n]})}statSync(e,i,n){return this._sync.statSync(e,i,n)}openSync(e,i,n,s){return this._sync.openSync(e,i,n,s).closeSync(),new Pn(this,e,i,this._sync.statSync(e,!1,s),this._sync.readFileSync(e,null,T.getFileFlag("r"),s))}unlinkSync(e,i){this._sync.unlinkSync(e,i),this.enqueueOp({apiMethod:"unlink",arguments:[e,i]})}rmdirSync(e,i){this._sync.rmdirSync(e,i),this.enqueueOp({apiMethod:"rmdir",arguments:[e,i]})}mkdirSync(e,i,n){this._sync.mkdirSync(e,i,n),this.enqueueOp({apiMethod:"mkdir",arguments:[e,i,n]})}readdirSync(e,i){return this._sync.readdirSync(e,i)}existsSync(e,i){return this._sync.existsSync(e,i)}chmodSync(e,i,n,s){this._sync.chmodSync(e,i,n,s),this.enqueueOp({apiMethod:"chmod",arguments:[e,i,n,s]})}chownSync(e,i,n,s,a){this._sync.chownSync(e,i,n,s,a),this.enqueueOp({apiMethod:"chown",arguments:[e,i,n,s,a]})}utimesSync(e,i,n,s){this._sync.utimesSync(e,i,n,s),this.enqueueOp({apiMethod:"utimes",arguments:[e,i,n,s]})}_initialize(e){let i=this._initializeCallbacks,n=s=>{this._isInitialized=!s,this._initializeCallbacks=[],i.forEach(a=>a(s))};if(this._isInitialized)e();else if(i.push(e)===1){let s=(c,l,u)=>{c!=="/"&&this._async.stat(c,!0,z.Root,(d,h)=>{d&&u(d),this._sync.mkdirSync(c,h.mode,h.getCred())}),this._async.readdir(c,z.Root,(d,h)=>{let p=0;function m(y){y?u(y):p<h.length?(o(V(c,h[p]),m),p++):u()}d?u(d):m()})},a=(c,l,u)=>{this._async.readFile(c,null,T.getFileFlag("r"),z.Root,(d,h)=>{if(d)u(d);else try{this._sync.writeFileSync(c,h,null,T.getFileFlag("w"),l,z.Root)}catch(p){d=p}finally{u(d)}})},o=(c,l)=>{this._async.stat(c,!1,z.Root,(u,d)=>{u?l(u):d.isDirectory()?s(c,d.mode,l):a(c,d.mode,l)})};s("/",0,n)}}enqueueOp(e){if(this._queue.push(e),!this._queueRunning){this._queueRunning=!0;let i=n=>{if(n)throw new Error(`WARNING: File system has desynchronized. Received following error: ${n}
$`);if(this._queue.length>0){let s=this._queue.shift(),a=s.arguments;a.push(i),this._async[s.apiMethod].apply(this._async,a)}else this._queueRunning=!1};i()}}},ht=fi;ht.Name="AsyncMirror",ht.Options={sync:{type:"object",description:"The synchronous file system to mirror the asynchronous file system to.",validator:(e,i)=>{e&&typeof e.supportsSynch=="function"&&e.supportsSynch()?i():i(new f(22,"'sync' option must be a file system that supports synchronous operations"))}},async:{type:"object",description:"The asynchronous file system to mirror."}};var Wa=globalThis.Dropbox?globalThis.Dropbox.Dropbox:void 0;function We(r){return r==="/"?"":r}function qe(r){let t=r.error;if(t[".tag"])return t;if(t.error){let e=t.error;return e[".tag"]?e:e.reason&&e.reason[".tag"]?e.reason:e}else if(typeof t=="string")try{let e=JSON.parse(t);if(e.error&&e.error.reason&&e.error.reason[".tag"])return e.error.reason}catch(e){}return t}function K(r){if(r.user_message)return r.user_message.text;if(r.error_summary)return r.error_summary;if(typeof r.error=="string")return r.error;if(typeof r.error=="object")return K(r.error);throw new Error(`Dropbox's servers gave us a garbage error message: ${JSON.stringify(r)}`)}function vr(r,t,e){switch(r[".tag"]){case"malformed_path":return new f(9,e,t);case"not_found":return f.ENOENT(t);case"not_file":return f.EISDIR(t);case"not_folder":return f.ENOTDIR(t);case"restricted_content":return f.EPERM(t);case"other":default:return new f(5,e,t)}}function er(r,t,e){switch(r[".tag"]){case"malformed_path":case"disallowed_name":return new f(9,e,t);case"conflict":case"no_write_permission":case"team_folder":return f.EPERM(t);case"insufficient_space":return new f(28,e);case"other":default:return new f(5,e,t)}}function di(r,t,e){let i={path:We(t)};r.filesDeleteV2(i).then(()=>{e()}).catch(n=>{let s=qe(n);switch(s[".tag"]){case"path_lookup":e(vr(s.path_lookup,t,K(n)));break;case"path_write":e(er(s.path_write,t,K(n)));break;case"too_many_write_operations":setTimeout(()=>di(r,t,e),500+300*Math.random());break;case"other":default:e(new f(5,K(n),t));break}})}var hi=class extends le{constructor(t,e,i,n,s){super(t,e,i,n,s)}sync(t){this._fs._syncFile(this.getPath(),this.getBuffer(),t)}close(t){this.sync(t)}},pi=class extends ie{constructor(e){super();this._client=e}static Create(e,i){i(null,new pi(e.client))}static CreateAsync(e){return new Promise((i,n)=>{this.Create(e,(s,a)=>{s||!a?n(s):i(a)})})}static isAvailable(){return typeof Wa!="undefined"}getName(){return pi.Name}isReadOnly(){return!1}supportsSymlinks(){return!1}supportsProps(){return!1}supportsSynch(){return!1}empty(e){this.readdir("/",z.Root,(i,n)=>{if(n){let s=a=>{n.length===0?e():di(this._client,n.shift(),s)};s()}else e(i)})}rename(e,i,n,s){this.stat(i,!1,n,(a,o)=>{let c=()=>{let l={from_path:We(e),to_path:We(i)};this._client.filesMoveV2(l).then(()=>s()).catch(function(u){let d=qe(u);switch(d[".tag"]){case"from_lookup":s(vr(d.from_lookup,e,K(u)));break;case"from_write":s(er(d.from_write,e,K(u)));break;case"to":s(er(d.to,i,K(u)));break;case"cant_copy_shared_folder":case"cant_nest_shared_folder":s(new f(1,K(u),e));break;case"cant_move_folder_into_itself":case"duplicated_or_nested_paths":s(new f(9,K(u),e));break;case"too_many_files":s(new f(28,K(u),e));break;case"other":default:s(new f(5,K(u),e));break}})};a?c():e===i?a?s(f.ENOENT(i)):s():o&&o.isDirectory()?s(f.EISDIR(i)):this.unlink(i,n,l=>{l?s(l):c()})})}stat(e,i,n,s){if(e==="/"){xe(function(){s(null,new C(16384,4096))});return}let a={path:We(e)};this._client.filesGetMetadata(a).then(o=>{switch(o[".tag"]){case"file":let c=o;s(null,new C(32768,c.size));break;case"folder":s(null,new C(16384,4096));break;case"deleted":s(f.ENOENT(e));break;default:break}}).catch(o=>{let c=qe(o);switch(c[".tag"]){case"path":s(vr(c.path,e,K(o)));break;default:s(new f(5,K(o),e));break}})}openFile(e,i,n,s){let a={path:We(e)};this._client.filesDownload(a).then(o=>{let c=o.fileBlob,l=new FileReader;l.onload=()=>{let u=l.result;s(null,new hi(this,e,i,new C(32768,u.byteLength),ft(u)))},l.readAsArrayBuffer(c)}).catch(o=>{let c=qe(o);switch(c[".tag"]){case"path":s(vr(c.path,e,K(o)));break;case"other":default:s(new f(5,K(o),e));break}})}createFile(e,i,n,s,a){let o=g.alloc(0),l={contents:new Blob([ut(o)],{type:"octet/stream"}),path:We(e)};this._client.filesUpload(l).then(u=>{a(null,new hi(this,e,i,new C(32768,0),o))}).catch(u=>{let d=qe(u);switch(d[".tag"]){case"path":a(er(d.path.reason,e,K(u)));break;case"too_many_write_operations":setTimeout(()=>this.createFile(e,i,n,s,a),500+300*Math.random());break;case"other":default:a(new f(5,K(u),e));break}})}unlink(e,i,n){this.stat(e,!1,i,(s,a)=>{a?a.isDirectory()?n(f.EISDIR(e)):di(this._client,e,n):n(s)})}rmdir(e,i,n){this.readdir(e,i,(s,a)=>{a?a.length>0?n(f.ENOTEMPTY(e)):di(this._client,e,n):n(s)})}mkdir(e,i,n,s){let a=B(e);this.stat(a,!1,n,(o,c)=>{if(o)s(o);else if(c&&!c.isDirectory())s(f.ENOTDIR(a));else{let l={path:We(e)};this._client.filesCreateFolderV2(l).then(()=>s()).catch(u=>{qe(u)[".tag"]==="too_many_write_operations"?setTimeout(()=>this.mkdir(e,i,n,s),500+300*Math.random()):s(er(qe(u).path,e,K(u)))})}})}readdir(e,i,n){let s={path:We(e)};this._client.filesListFolder(s).then(a=>{Ya(this._client,e,a,[],n)}).catch(a=>{qa(a,e,n)})}_syncFile(e,i,n){let a={contents:new Blob([ut(i)],{type:"octet/stream"}),path:We(e),mode:{".tag":"overwrite"}};this._client.filesUpload(a).then(()=>{n()}).catch(o=>{let c=qe(o);switch(c[".tag"]){case"path":n(er(c.path.reason,e,K(o)));break;case"too_many_write_operations":setTimeout(()=>this._syncFile(e,i,n),500+300*Math.random());break;case"other":default:n(new f(5,K(o),e));break}})}},pt=pi;pt.Name="DropboxV2",pt.Options={client:{type:"object",description:"An *authenticated* Dropbox client. Must be from the 2.5.x JS SDK."}};function qa(r,t,e){let i=qe(r);switch(i[".tag"]){case"path":e(vr(i.path,t,K(r)));break;case"other":default:e(new f(5,K(r),t));break}}function Ya(r,t,e,i,n){let s=e.entries.map(o=>o.path_display).filter(o=>!!o),a=i.concat(s);if(!e.has_more)n(null,a);else{let o={cursor:e.cursor};r.filesListFolderContinue(o).then(c=>{Ya(r,t,c,a,n)}).catch(c=>{qa(c,t,n)})}}function W(r,t=""){let e=r.errno,i=r.node,n=[];for(;i&&(n.unshift(i.name),i!==i.parent);)i=i.parent;return new f(e,J[e],n.length>0?"/"+n.join("/"):t)}var Un=class extends dt{constructor(e,i,n,s){super();this._fs=e;this._FS=i;this._path=n;this._stream=s}getPos(){}close(e){let i=null;try{this.closeSync()}catch(n){i=n}finally{e(i)}}closeSync(){try{this._FS.close(this._stream)}catch(e){throw W(e,this._path)}}stat(e){try{e(null,this.statSync())}catch(i){e(i)}}statSync(){try{return this._fs.statSync(this._path,!1,z.Root)}catch(e){throw W(e,this._path)}}truncate(e,i){let n=null;try{this.truncateSync(e)}catch(s){n=s}finally{i(n)}}truncateSync(e){try{this._FS.ftruncate(this._stream.fd,e)}catch(i){throw W(i,this._path)}}write(e,i,n,s,a){try{a(null,this.writeSync(e,i,n,s),e)}catch(o){a(o)}}writeSync(e,i,n,s){try{let a=Mt(e),o=s===null?void 0:s;return this._FS.write(this._stream,a,i,n,o)}catch(a){throw W(a,this._path)}}read(e,i,n,s,a){try{a(null,this.readSync(e,i,n,s),e)}catch(o){a(o)}}readSync(e,i,n,s){try{let a=Mt(e),o=s===null?void 0:s;return this._FS.read(this._stream,a,i,n,o)}catch(a){throw W(a,this._path)}}sync(e){e()}syncSync(){}chown(e,i,n){let s=null;try{this.chownSync(e,i)}catch(a){s=a}finally{n(s)}}chownSync(e,i){try{this._FS.fchown(this._stream.fd,e,i)}catch(n){throw W(n,this._path)}}chmod(e,i){let n=null;try{this.chmodSync(e)}catch(s){n=s}finally{i(n)}}chmodSync(e){try{this._FS.fchmod(this._stream.fd,e)}catch(i){throw W(i,this._path)}}utimes(e,i,n){let s=null;try{this.utimesSync(e,i)}catch(a){s=a}finally{n(s)}}utimesSync(e,i){this._fs.utimesSync(this._path,e,i,z.Root)}},zn=class extends Ae{constructor(e){super();this._FS=e}static Create(e,i){i(null,new zn(e.FS))}static CreateAsync(e){return new Promise((i,n)=>{this.Create(e,(s,a)=>{s||!a?n(s):i(a)})})}static isAvailable(){return!0}getName(){return this._FS.DB_NAME()}isReadOnly(){return!1}supportsLinks(){return!0}supportsProps(){return!0}supportsSynch(){return!0}renameSync(e,i,n){try{this._FS.rename(e,i)}catch(s){throw s.errno===2?W(s,this.existsSync(e,n)?i:e):W(s)}}statSync(e,i,n){try{let s=i?this._FS.lstat(e):this._FS.stat(e),a=this.modeToFileType(s.mode);return new C(a,s.size,s.mode,s.atime.getTime(),s.mtime.getTime(),s.ctime.getTime())}catch(s){throw W(s,e)}}openSync(e,i,n,s){try{let a=this._FS.open(e,i.getFlagString(),n);return new Un(this,this._FS,e,a)}catch(a){throw W(a,e)}}unlinkSync(e,i){try{this._FS.unlink(e)}catch(n){throw W(n,e)}}rmdirSync(e,i){try{this._FS.rmdir(e)}catch(n){throw W(n,e)}}mkdirSync(e,i,n){try{this._FS.mkdir(e,i)}catch(s){throw W(s,e)}}readdirSync(e,i){try{return this._FS.readdir(e).filter(n=>n!=="."&&n!=="..")}catch(n){throw W(n,e)}}truncateSync(e,i,n){try{this._FS.truncate(e,i)}catch(s){throw W(s,e)}}readFileSync(e,i,n,s){try{let a=this._FS.readFile(e,{flags:n.getFlagString()}),o=ct(a);return i?o.toString(i):o}catch(a){throw W(a,e)}}writeFileSync(e,i,n,s,a,o){try{n&&(i=g.from(i,n));let c=Mt(i);this._FS.writeFile(e,c,{flags:s.getFlagString(),encoding:"binary"}),this._FS.chmod(e,a)}catch(c){throw W(c,e)}}chmodSync(e,i,n,s){try{i?this._FS.lchmod(e,n):this._FS.chmod(e,n)}catch(a){throw W(a,e)}}chownSync(e,i,n,s,a){try{i?this._FS.lchown(e,n,s):this._FS.chown(e,n,s)}catch(o){throw W(o,e)}}symlinkSync(e,i,n,s){try{this._FS.symlink(e,i)}catch(a){throw W(a)}}readlinkSync(e,i){try{return this._FS.readlink(e)}catch(n){throw W(n,e)}}utimesSync(e,i,n,s){try{this._FS.utime(e,i.getTime(),n.getTime())}catch(a){throw W(a,e)}}modeToFileType(e){if(this._FS.isDir(e))return 16384;if(this._FS.isFile(e))return 32768;if(this._FS.isLink(e))return 40960;throw f.EPERM(`Invalid mode: ${e}`)}},gt=zn;gt.Name="EmscriptenFileSystem",gt.Options={FS:{type:"object",description:"The Emscripten file system to use (the `FS` variable)"}};var ce=(r,t="")=>e=>{if(e.name==="NotFoundError")return r(f.ENOENT(t));r(e)},Ou=(r,t,e)=>{let i=[],n=()=>{r.next().then(({done:s,value:a})=>{if(s)return t(null,i);i.push(a),n()}).catch(ce(t,e))};n()},Hn=class extends le{constructor(t,e,i,n,s){super(t,e,i,n,s)}sync(t){this.isDirty()?this._fs._sync(this.getPath(),this.getBuffer(),this.getStats(),z.Root,e=>{e||this.resetDirty(),t(e)}):t()}close(t){this.sync(t)}},gi=class extends ie{constructor(e){super();this._handles={"/":e}}static Create({handle:e},i){i(null,new gi(e))}static CreateAsync(e){return new Promise((i,n)=>{this.Create(e,(s,a)=>{s||!a?n(s):i(a)})})}static isAvailable(){return typeof FileSystemHandle=="function"}getName(){return gi.Name}isReadOnly(){return!1}supportsSymlinks(){return!1}supportsProps(){return!1}supportsSynch(){return!1}_sync(e,i,n,s,a){this.stat(e,!1,s,(o,c)=>{n.mtime!==c.mtime?this.writeFile(e,i,null,T.getFileFlag("w"),c.mode,s,a):a(o)})}rename(e,i,n,s){this.getHandle(e,(a,o)=>{if(a)return s(a);o instanceof FileSystemDirectoryHandle&&this.readdir(e,n,(c,l=[])=>{if(c)return s(c);this.mkdir(i,"wx",n,u=>{if(u)return s(u);l.length===0?this.unlink(e,n,s):l.forEach(d=>this.rename(V(e,d),V(i,d),n,()=>this.unlink(e,n,s)))})}),o instanceof FileSystemFileHandle&&o.getFile().then(c=>this.getHandle(B(i),(l,u)=>{if(l)return s(l);u instanceof FileSystemDirectoryHandle&&u.getFileHandle($(i),{create:!0}).then(d=>d.createWritable().then(h=>c.arrayBuffer().then(p=>h.write(p).then(()=>{h.close(),this.unlink(e,n,s)}).catch(ce(s,i))).catch(ce(s,e))).catch(ce(s,i))).catch(ce(s,i))})).catch(ce(s,e))})}writeFile(e,i,n,s,a,o,c,l){this.getHandle(B(e),(u,d)=>{if(u)return c(u);d instanceof FileSystemDirectoryHandle&&d.getFileHandle($(e),{create:!0}).then(h=>h.createWritable().then(p=>p.write(i).then(()=>{p.close().catch(ce(c,e)),c(null,l?this.newFile(e,s,i):void 0)}).catch(ce(c,e))).catch(ce(c,e))).catch(ce(c,e))})}createFile(e,i,n,s,a){this.writeFile(e,_e(),null,i,n,s,a,!0)}stat(e,i,n,s){this.getHandle(e,(a,o)=>{if(a)return s(a);if(!o)return s(f.FileError(22,e));if(o instanceof FileSystemDirectoryHandle)return s(null,new C(16384,4096));o instanceof FileSystemFileHandle&&o.getFile().then(({lastModified:c,size:l})=>s(null,new C(32768,l,void 0,void 0,c))).catch(ce(s,e))})}exists(e,i,n){this.getHandle(e,s=>n(s===null))}openFile(e,i,n,s){this.getHandle(e,(a,o)=>{if(a)return s(a);o instanceof FileSystemFileHandle&&o.getFile().then(c=>c.arrayBuffer().then(l=>s(null,this.newFile(e,i,l,c.size,c.lastModified))).catch(ce(s,e))).catch(ce(s,e))})}unlink(e,i,n){this.getHandle(B(e),(s,a)=>{if(s)return n(s);a instanceof FileSystemDirectoryHandle&&a.removeEntry($(e),{recursive:!0}).then(()=>n(null)).catch(ce(n,e))})}rmdir(e,i,n){this.unlink(e,i,n)}mkdir(e,i,n,s){let a=i&&i.flag&&i.flag.includes("w")&&!i.flag.includes("x");this.getHandle(e,(o,c)=>{if(c&&!a)return s(f.EEXIST(e));this.getHandle(B(e),(l,u)=>{if(l)return s(l);u instanceof FileSystemDirectoryHandle&&u.getDirectoryHandle($(e),{create:!0}).then(()=>s(null)).catch(ce(s,e))})})}readdir(e,i,n){this.getHandle(e,(s,a)=>{if(s)return n(s);a instanceof FileSystemDirectoryHandle&&Ou(a.keys(),n,e)})}newFile(e,i,n,s,a){return new Hn(this,e,i,new C(32768,s||0,void 0,void 0,a||new Date().getTime()),g.from(n))}getHandle(e,i){if(e==="/")return i(null,this._handles["/"]);let n="/",[,...s]=e.split("/"),a=([o,...c])=>{let l=V(n,o),u=h=>{if(n=l,this._handles[n]=h,c.length===0)return i(null,this._handles[e]);a(c)},d=this._handles[n];d.getDirectoryHandle(o).then(u).catch(h=>{h.name==="TypeMismatchError"?d.getFileHandle(o).then(u).catch(ce(i,l)):h.message==="Name is not allowed."?i(new f(2,h.message,l)):ce(i,l)(h)})};a(s)}},mt=gi;mt.Name="FileSystemAccess",mt.Options={};var jn=class extends ie{constructor(e,i){super();this._folder=e,this._wrapped=i}static Create(e,i){let n=new jn(e.folder,e.wrapped);n._initialize(function(s){s?i(s):i(null,n)})}static CreateAsync(e){return new Promise((i,n)=>{this.Create(e,(s,a)=>{s||!a?n(s):i(a)})})}static isAvailable(){return!0}getName(){return this._wrapped.getName()}isReadOnly(){return this._wrapped.isReadOnly()}supportsProps(){return this._wrapped.supportsProps()}supportsSynch(){return this._wrapped.supportsSynch()}supportsLinks(){return!1}_initialize(e){this._wrapped.exists(this._folder,z.Root,i=>{i?e():this._wrapped.isReadOnly()?e(f.ENOENT(this._folder)):this._wrapped.mkdir(this._folder,511,z.Root,e)})}},Ne=jn;Ne.Name="FolderAdapter",Ne.Options={folder:{type:"string",description:"The folder to use as the root directory"},wrapped:{type:"object",description:"The file system to wrap"}};function Ka(r,t){if(t!==null&&typeof t=="object"){let e=t,i=e.path;i&&(i="/"+oi(r,i),e.message=e.message.replace(e.path,i),e.path=i)}return t}function Iu(r,t){return typeof t=="function"?function(e){arguments.length>0&&(arguments[0]=Ka(r,e)),t.apply(null,arguments)}:t}function Xa(r,t,e){return r.slice(r.length-4)!=="Sync"?function(){return arguments.length>0&&(t&&(arguments[0]=V(this._folder,arguments[0])),e&&(arguments[1]=V(this._folder,arguments[1])),arguments[arguments.length-1]=Iu(this._folder,arguments[arguments.length-1])),this._wrapped[r].apply(this._wrapped,arguments)}:function(){try{return t&&(arguments[0]=V(this._folder,arguments[0])),e&&(arguments[1]=V(this._folder,arguments[1])),this._wrapped[r].apply(this._wrapped,arguments)}catch(i){throw Ka(this._folder,i)}}}["diskSpace","stat","statSync","open","openSync","unlink","unlinkSync","rmdir","rmdirSync","mkdir","mkdirSync","readdir","readdirSync","exists","existsSync","realpath","realpathSync","truncate","truncateSync","readFile","readFileSync","writeFile","writeFileSync","appendFile","appendFileSync","chmod","chmodSync","chown","chownSync","utimes","utimesSync","readlink","readlinkSync"].forEach(r=>{Ne.prototype[r]=Xa(r,!0,!1)});["rename","renameSync","link","linkSync","symlink","symlinkSync"].forEach(r=>{Ne.prototype[r]=Xa(r,!0,!0)});var Ke={};Dt(Ke,{addListener:()=>fo,argv:()=>so,binding:()=>yo,browser:()=>io,chdir:()=>So,config:()=>co,cwd:()=>bi,default:()=>ir,emit:()=>bo,env:()=>no,hrtime:()=>vo,nextTick:()=>ue,off:()=>po,on:()=>uo,once:()=>ho,platform:()=>ro,release:()=>lo,removeAllListeners:()=>mo,removeListener:()=>go,title:()=>to,umask:()=>_o,uptime:()=>wo,version:()=>ao,versions:()=>oo});function Ga(){throw new Error("setTimeout has not been defined")}function $a(){throw new Error("clearTimeout has not been defined")}var bt=Ga,yt=$a;typeof globalThis.setTimeout=="function"&&(bt=setTimeout);typeof globalThis.clearTimeout=="function"&&(yt=clearTimeout);function Ja(r){if(bt===setTimeout)return setTimeout(r,0);if((bt===Ga||!bt)&&setTimeout)return bt=setTimeout,setTimeout(r,0);try{return bt(r,0)}catch(t){try{return bt.call(null,r,0)}catch(e){return bt.call(this,r,0)}}}function Tu(r){if(yt===clearTimeout)return clearTimeout(r);if((yt===$a||!yt)&&clearTimeout)return yt=clearTimeout,clearTimeout(r);try{return yt(r)}catch(t){try{return yt.call(null,r)}catch(e){return yt.call(this,r)}}}var Ye=[],rr=!1,Ut,mi=-1;function Du(){!rr||!Ut||(rr=!1,Ut.length?Ye=Ut.concat(Ye):mi=-1,Ye.length&&Qa())}function Qa(){if(!rr){var r=Ja(Du);rr=!0;for(var t=Ye.length;t;){for(Ut=Ye,Ye=[];++mi<t;)Ut&&Ut[mi].run();mi=-1,t=Ye.length}Ut=null,rr=!1,Tu(r)}}function ue(r){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];Ye.push(new eo(r,t)),Ye.length===1&&!rr&&Ja(Qa)}function eo(r,t){this.fun=r,this.array=t}eo.prototype.run=function(){this.fun.apply(null,this.array)};var to="browser",ro="browser",io=!0,no={},so=[],ao="",oo={},lo={},co={};function zt(){}var uo=zt,fo=zt,ho=zt,po=zt,go=zt,mo=zt,bo=zt;function yo(r){throw new Error("process.binding is not supported")}function bi(){return"/"}function So(r){throw new Error("process.chdir is not supported")}function _o(){return 0}var tr=globalThis.performance||{},Ru=tr.now||tr.mozNow||tr.msNow||tr.oNow||tr.webkitNow||function(){return new Date().getTime()};function vo(r){var t=Ru.call(tr)*.001,e=Math.floor(t),i=Math.floor(t%1*1e9);return r&&(e=e-r[0],i=i-r[1],i<0&&(e--,i+=1e9)),[e,i]}var Nu=new Date;function wo(){var r=new Date,t=r-Nu;return t/1e3}var Lu={nextTick:ue,title:to,browser:io,env:no,argv:so,version:ao,versions:oo,on:uo,addListener:fo,once:ho,off:po,removeListener:go,removeAllListeners:mo,emit:bo,binding:yo,cwd:bi,chdir:So,umask:_o,hrtime:vo,platform:ro,release:lo,config:co,uptime:wo},ir=Lu;var we=class{constructor(t,e,i,n,s,a,o,c){this.id=t;this.size=e;this.mode=i;this.atime=n;this.mtime=s;this.ctime=a;this.uid=o;this.gid=c}static fromBuffer(t){if(t===void 0)throw new Error("NO");return new we(t.toString("ascii",38),t.readUInt32LE(0),t.readUInt16LE(4),t.readDoubleLE(6),t.readDoubleLE(14),t.readDoubleLE(22),t.readUInt32LE(30),t.readUInt32LE(34))}toStats(){return new C((this.mode&61440)===16384?16384:32768,this.size,this.mode,this.atime,this.mtime,this.ctime,this.uid,this.gid)}getSize(){return 38+this.id.length}toBuffer(t=g.alloc(this.getSize())){return t.writeUInt32LE(this.size,0),t.writeUInt16LE(this.mode,4),t.writeDoubleLE(this.atime,6),t.writeDoubleLE(this.mtime,14),t.writeDoubleLE(this.ctime,22),t.writeUInt32LE(this.uid,30),t.writeUInt32LE(this.gid,34),t.write(this.id,38,this.id.length,"ascii"),t}update(t){let e=!1;this.size!==t.size&&(this.size=t.size,e=!0),this.mode!==t.mode&&(this.mode=t.mode,e=!0);let i=t.atime.getTime();this.atime!==i&&(this.atime=i,e=!0);let n=t.mtime.getTime();this.mtime!==n&&(this.mtime=n,e=!0);let s=t.ctime.getTime();return this.ctime!==s&&(this.ctime=s,e=!0),this.uid!==t.uid&&(this.uid=t.uid,e=!0),this.uid!==t.uid&&(this.uid=t.uid,e=!0),e}isFile(){return(this.mode&61440)===32768}isDirectory(){return(this.mode&61440)===16384}};var Xe="/",Zn=null;function Eo(){return Zn||(Zn=g.from("{}"))}function yi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){let t=Math.random()*16|0;return(r==="x"?t:t&3|8).toString(16)})}function Ee(r,t){return r?(t(r),!1):!0}function Q(r,t,e){return r?(t.abort(()=>{e(r)}),!1):!0}var Si=class{constructor(t,e){this.key=t;this.value=e;this.prev=null;this.next=null}},Vn=class{constructor(t){this.limit=t;this.size=0;this.map={};this.head=null;this.tail=null}set(t,e){let i=new Si(t,e);this.map[t]?(this.map[t].value=i.value,this.remove(i.key)):this.size>=this.limit&&(delete this.map[this.tail.key],this.size--,this.tail=this.tail.prev,this.tail.next=null),this.setHead(i)}get(t){if(this.map[t]){let e=this.map[t].value,i=new Si(t,e);return this.remove(t),this.setHead(i),e}else return null}remove(t){let e=this.map[t];e&&(e.prev!==null?e.prev.next=e.next:this.head=e.next,e.next!==null?e.next.prev=e.prev:this.tail=e.prev,delete this.map[t],this.size--)}removeAll(){this.size=0,this.map={},this.head=null,this.tail=null}setHead(t){t.next=this.head,t.prev=null,this.head!==null&&(this.head.prev=t),this.head=t,this.tail===null&&(this.tail=t),this.size++,this.map[t.key]=t}},nr=class{constructor(t){this.store=t;this.originalData={};this.modifiedKeys=[]}get(t){let e=this.store.get(t);return this.stashOldValue(t,e),e}put(t,e,i){return this.markModified(t),this.store.put(t,e,i)}del(t){this.markModified(t),this.store.del(t)}commit(){}abort(){for(let t of this.modifiedKeys){let e=this.originalData[t];e?this.store.put(t,e,!0):this.store.del(t)}}_has(t){return Object.prototype.hasOwnProperty.call(this.originalData,t)}stashOldValue(t,e){this._has(t)||(this.originalData[t]=e)}markModified(t){this.modifiedKeys.indexOf(t)===-1&&(this.modifiedKeys.push(t),this._has(t)||(this.originalData[t]=this.store.get(t)))}},_i=class extends le{constructor(t,e,i,n,s){super(t,e,i,n,s)}syncSync(){this.isDirty()&&(this._fs._syncSync(this.getPath(),this.getBuffer(),this.getStats()),this.resetDirty())}closeSync(){this.syncSync()}},sr=class extends Ae{constructor(e){super();this.store=e.store,this.makeRootDirectory()}static isAvailable(){return!0}getName(){return this.store.name()}isReadOnly(){return!1}supportsSymlinks(){return!1}supportsProps(){return!0}supportsSynch(){return!0}empty(){this.store.clear(),this.makeRootDirectory()}accessSync(e,i,n){let s=this.store.beginTransaction("readonly");if(!this.findINode(s,e).toStats().hasAccess(i,n))throw f.EACCES(e)}renameSync(e,i,n){let s=this.store.beginTransaction("readwrite"),a=B(e),o=$(e),c=B(i),l=$(i),u=this.findINode(s,a),d=this.getDirListing(s,a,u);if(!u.toStats().hasAccess(2,n))throw f.EACCES(e);if(!d[o])throw f.ENOENT(e);let h=d[o];if(delete d[o],(c+"/").indexOf(e+"/")===0)throw new f(16,a);let p,m;if(c===a?(p=u,m=d):(p=this.findINode(s,c),m=this.getDirListing(s,c,p)),m[l]){let y=this.getINode(s,i,m[l]);if(y.isFile())try{s.del(y.id),s.del(m[l])}catch(b){throw s.abort(),b}else throw f.EPERM(i)}m[l]=h;try{s.put(u.id,g.from(JSON.stringify(d)),!0),s.put(p.id,g.from(JSON.stringify(m)),!0)}catch(y){throw s.abort(),y}s.commit()}statSync(e,i,n){let s=this.findINode(this.store.beginTransaction("readonly"),e).toStats();if(!s.hasAccess(4,n))throw f.EACCES(e);return s}createFileSync(e,i,n,s){let a=this.store.beginTransaction("readwrite"),o=_e(),c=this.commitNewFile(a,e,32768,n,s,o);return new _i(this,e,i,c.toStats(),o)}openFileSync(e,i,n){let s=this.store.beginTransaction("readonly"),a=this.findINode(s,e),o=s.get(a.id);if(!a.toStats().hasAccess(i.getMode(),n))throw f.EACCES(e);if(o===void 0)throw f.ENOENT(e);return new _i(this,e,i,a.toStats(),o)}unlinkSync(e,i){this.removeEntry(e,!1,i)}rmdirSync(e,i){if(this.readdirSync(e,i).length>0)throw f.ENOTEMPTY(e);this.removeEntry(e,!0,i)}mkdirSync(e,i,n){let s=this.store.beginTransaction("readwrite"),a=g.from("{}");this.commitNewFile(s,e,16384,i,n,a)}readdirSync(e,i){let n=this.store.beginTransaction("readonly"),s=this.findINode(n,e);if(!s.toStats().hasAccess(4,i))throw f.EACCES(e);return Object.keys(this.getDirListing(n,e,s))}chmodSync(e,i,n,s){let a=i?e:this.realpathSync(e,{},s);this.openFileSync(a,T.getFileFlag("r+"),s).chmodSync(n)}chownSync(e,i,n,s,a){let o=i?e:this.realpathSync(e,{},a);this.openFileSync(o,T.getFileFlag("r+"),a).chownSync(a.euid,a.egid)}_syncSync(e,i,n){let s=this.store.beginTransaction("readwrite"),a=this._findINode(s,B(e),$(e)),o=this.getINode(s,e,a),c=o.update(n);try{s.put(o.id,i,!0),c&&s.put(a,o.toBuffer(),!0)}catch(l){throw s.abort(),l}s.commit()}makeRootDirectory(){let e=this.store.beginTransaction("readwrite");if(e.get(Xe)===void 0){let i=new Date().getTime(),n=new we(yi(),4096,16895,i,i,i,0,0);e.put(n.id,Eo(),!1),e.put(Xe,n.toBuffer(),!1),e.commit()}}_findINode(e,i,n){let s=a=>{let o=this.getDirListing(e,i,a);if(o[n])return o[n];throw f.ENOENT(Y(i,n))};return i==="."&&(i=bi()),i==="/"?n===""?Xe:s(this.getINode(e,i,Xe)):s(this.getINode(e,i+ot+n,this._findINode(e,B(i),$(i))))}findINode(e,i){return this.getINode(e,i,this._findINode(e,B(i),$(i)))}getINode(e,i,n){let s=e.get(n);if(s===void 0)throw f.ENOENT(i);return we.fromBuffer(s)}getDirListing(e,i,n){if(!n.isDirectory())throw f.ENOTDIR(i);let s=e.get(n.id);if(s===void 0)throw f.ENOENT(i);return JSON.parse(s.toString())}addNewNode(e,i){let s;for(;0<5;)try{return s=yi(),e.put(s,i,!1),s}catch(a){}throw new f(5,"Unable to commit data to key-value store.")}commitNewFile(e,i,n,s,a,o){let c=B(i),l=$(i),u=this.findINode(e,c),d=this.getDirListing(e,c,u),h=new Date().getTime();if(!u.toStats().hasAccess(4,a))throw f.EACCES(i);if(i==="/")throw f.EEXIST(i);if(d[l])throw f.EEXIST(i);let p;try{let m=this.addNewNode(e,o);p=new we(m,o.length,s|n,h,h,h,a.uid,a.gid);let y=this.addNewNode(e,p.toBuffer());d[l]=y,e.put(u.id,g.from(JSON.stringify(d)),!0)}catch(m){throw e.abort(),m}return e.commit(),p}removeEntry(e,i,n){let s=this.store.beginTransaction("readwrite"),a=B(e),o=this.findINode(s,a),c=this.getDirListing(s,a,o),l=$(e);if(!c[l])throw f.ENOENT(e);let u=c[l],d=this.getINode(s,e,u);if(!d.toStats().hasAccess(2,n))throw f.EACCES(e);if(delete c[l],!i&&d.isDirectory())throw f.EISDIR(e);if(i&&!d.isDirectory())throw f.ENOTDIR(e);try{s.del(d.id),s.del(u),s.put(o.id,g.from(JSON.stringify(c)),!0)}catch(h){throw s.abort(),h}s.commit()}},vi=class extends le{constructor(t,e,i,n,s){super(t,e,i,n,s)}sync(t){this.isDirty()?this._fs._sync(this.getPath(),this.getBuffer(),this.getStats(),e=>{e||this.resetDirty(),t(e)}):t()}close(t){this.sync(t)}},wi=class extends ie{constructor(e){super();this._cache=null;e>0&&(this._cache=new Vn(e))}static isAvailable(){return!0}init(e,i){this.store=e,this.makeRootDirectory(i)}getName(){return this.store.name()}isReadOnly(){return!1}supportsSymlinks(){return!1}supportsProps(){return!0}supportsSynch(){return!1}empty(e){this._cache&&this._cache.removeAll(),this.store.clear(i=>{Ee(i,e)&&this.makeRootDirectory(e)})}access(e,i,n,s){let a=this.store.beginTransaction("readonly");this.findINode(a,e,o=>{o instanceof we?o.toStats().hasAccess(i,n)||s(f.EACCES(e)):s(o)})}rename(e,i,n,s){if(this._cache){let b=this._cache;this._cache=null,b.removeAll();let S=s;s=w=>{this._cache=b,S(w)}}let a=this.store.beginTransaction("readwrite"),o=B(e),c=$(e),l=B(i),u=$(i),d={},h={},p=!1;if((l+"/").indexOf(e+"/")===0)return s(new f(16,o));let m=()=>{if(p||!Object.prototype.hasOwnProperty.call(h,o)||!Object.prototype.hasOwnProperty.call(h,l))return;let b=h[o],S=d[o],w=h[l],x=d[l];if(!b[c])s(f.ENOENT(e));else{let _=b[c];delete b[c];let I=()=>{w[u]=_,a.put(S.id,g.from(JSON.stringify(b)),!0,q=>{Q(q,a,s)&&(o===l?a.commit(s):a.put(x.id,g.from(JSON.stringify(w)),!0,E=>{Q(E,a,s)&&a.commit(s)}))})};w[u]?this.getINode(a,i,w[u],(q,E)=>{Q(q,a,s)&&(E.isFile()?a.del(E.id,L=>{Q(L,a,s)&&a.del(w[u],N=>{Q(N,a,s)&&I()})}):a.abort(L=>{s(f.EPERM(i))}))}):I()}},y=b=>{this.findINodeAndDirListing(a,b,(S,w,x)=>{if(!w.toStats().hasAccess(2,n))throw f.EACCES(b);S?p||(p=!0,a.abort(()=>{s(S)})):(d[b]=w,h[b]=x,m())})};y(o),o!==l&&y(l)}stat(e,i,n,s){let a=this.store.beginTransaction("readonly");this.findINode(a,e,(o,c)=>{if(Ee(o,s)){let l=c.toStats();l.hasAccess(4,n)||s(f.EACCES(e)),s(null,l)}})}createFile(e,i,n,s,a){let o=this.store.beginTransaction("readwrite"),c=_e();this.commitNewFile(o,e,32768,n,s,c,(l,u)=>{Ee(l,a)&&a(null,new vi(this,e,i,u.toStats(),c))})}openFile(e,i,n,s){let a=this.store.beginTransaction("readonly");this.findINode(a,e,(o,c)=>{if(Ee(o,s)){let l=c.toStats();l.hasAccess(i.getMode(),n)||s(f.EACCES(e)),a.get(c.id,(u,d)=>{Ee(u,s)&&(d===void 0?s(f.ENOENT(e)):s(null,new vi(this,e,i,l,d)))})}})}unlink(e,i,n){this.removeEntry(e,!1,i,n)}rmdir(e,i,n){this.readdir(e,i,(s,a)=>{s?n(s):a.length>0?n(f.ENOTEMPTY(e)):this.removeEntry(e,!0,i,n)})}mkdir(e,i,n,s){let a=this.store.beginTransaction("readwrite"),o=g.from("{}");this.commitNewFile(a,e,16384,i,n,o,s)}readdir(e,i,n){let s=this.store.beginTransaction("readonly");this.findINode(s,e,(a,o)=>{Ee(a,n)&&(o.toStats().hasAccess(4,i)||n(f.EACCES(e)),this.getDirListing(s,e,o,(c,l)=>{Ee(c,n)&&n(null,Object.keys(l))}))})}_sync(e,i,n,s){let a=this.store.beginTransaction("readwrite");this._findINode(a,B(e),$(e),(o,c)=>{Q(o,a,s)&&this.getINode(a,e,c,(l,u)=>{if(Q(l,a,s)){let d=u.update(n);a.put(u.id,i,!0,h=>{Q(h,a,s)&&(d?a.put(c,u.toBuffer(),!0,p=>{Q(p,a,s)&&a.commit(s)}):a.commit(s))})}})})}makeRootDirectory(e){let i=this.store.beginTransaction("readwrite");i.get(Xe,(n,s)=>{if(n||s===void 0){let a=new Date().getTime(),o=new we(yi(),4096,16895,a,a,a,0,0);i.put(o.id,Eo(),!1,c=>{Q(c,i,e)&&i.put(Xe,o.toBuffer(),!1,l=>{l?i.abort(()=>{e(l)}):i.commit(e)})})}else i.commit(e)})}_findINode(e,i,n,s){if(this._cache){let o=this._cache.get(V(i,n));if(o)return s(null,o)}let a=(o,c,l)=>{if(o)s(o);else if(l[n]){let u=l[n];this._cache&&this._cache.set(V(i,n),u),s(null,u)}else s(f.ENOENT(Y(i,n)))};i==="/"?n===""?(this._cache&&this._cache.set(V(i,n),Xe),s(null,Xe)):this.getINode(e,i,Xe,(o,c)=>{Ee(o,s)&&this.getDirListing(e,i,c,(l,u)=>{a(l,c,u)})}):this.findINodeAndDirListing(e,i,a)}findINode(e,i,n){this._findINode(e,B(i),$(i),(s,a)=>{Ee(s,n)&&this.getINode(e,i,a,n)})}getINode(e,i,n,s){e.get(n,(a,o)=>{Ee(a,s)&&(o===void 0?s(f.ENOENT(i)):s(null,we.fromBuffer(o)))})}getDirListing(e,i,n,s){n.isDirectory()?e.get(n.id,(a,o)=>{if(Ee(a,s))try{s(null,JSON.parse(o.toString()))}catch(c){s(f.ENOENT(i))}}):s(f.ENOTDIR(i))}findINodeAndDirListing(e,i,n){this.findINode(e,i,(s,a)=>{Ee(s,n)&&this.getDirListing(e,i,a,(o,c)=>{Ee(o,n)&&n(null,a,c)})})}addNewNode(e,i,n){let s=0,a,o=()=>{++s===5?n(new f(5,"Unable to commit data to key-value store.")):(a=yi(),e.put(a,i,!1,(c,l)=>{c||!l?o():n(null,a)}))};o()}commitNewFile(e,i,n,s,a,o,c){let l=B(i),u=$(i),d=new Date().getTime();if(i==="/")return c(f.EEXIST(i));this.findINodeAndDirListing(e,l,(h,p,m)=>{p.toStats().hasAccess(2,a)||c(f.EACCES(i)),Q(h,e,c)&&(m[u]?e.abort(()=>{c(f.EEXIST(i))}):this.addNewNode(e,o,(y,b)=>{if(Q(y,e,c)){let S=new we(b,o.length,s|n,d,d,d,a.euid,a.egid);this.addNewNode(e,S.toBuffer(),(w,x)=>{Q(w,e,c)&&(m[u]=x,e.put(p.id,g.from(JSON.stringify(m)),!0,_=>{Q(_,e,c)&&e.commit(I=>{Q(I,e,c)&&c(null,S)})}))})}}))})}removeEntry(e,i,n,s){this._cache&&this._cache.remove(e);let a=this.store.beginTransaction("readwrite"),o=B(e),c=$(e);this.findINodeAndDirListing(a,o,(l,u,d)=>{if(u.toStats().hasAccess(2,n)||s(f.EACCES(e)),Q(l,a,s))if(!d[c])a.abort(()=>{s(f.ENOENT(e))});else{let h=d[c];delete d[c],this.getINode(a,e,h,(p,m)=>{Q(p,a,s)&&(!i&&m.isDirectory()?a.abort(()=>{s(f.EISDIR(e))}):i&&!m.isDirectory()?a.abort(()=>{s(f.ENOTDIR(e))}):a.del(m.id,y=>{Q(y,a,s)&&a.del(h,b=>{Q(b,a,s)&&a.put(u.id,g.from(JSON.stringify(d)),!0,S=>{Q(S,a,s)&&a.commit(s)})})}))})}})}};var Wn=class{constructor(){this.store=new Map}name(){return Be.Name}clear(){this.store.clear()}beginTransaction(t){return new nr(this)}get(t){return this.store.get(t)}put(t,e,i){return!i&&this.store.has(t)?!1:(this.store.set(t,e),!0)}del(t){this.store.delete(t)}},qn=class extends sr{static Create(t,e){e(null,new qn)}static CreateAsync(t){return new Promise((e,i)=>{this.Create(t,(n,s)=>{n||!s?i(n):e(s)})})}constructor(){super({store:new Wn})}},Be=qn;Be.Name="InMemory",Be.Options={};var Yn=(()=>{try{return globalThis.indexedDB||globalThis.mozIndexedDB||globalThis.webkitIndexedDB||globalThis.msIndexedDB}catch(r){return null}})();function wr(r,t=r.toString()){switch(r.name){case"NotFoundError":return new f(2,t);case"QuotaExceededError":return new f(28,t);default:return new f(5,t)}}function Er(r,t=5,e=null){return function(i){i.preventDefault(),r(new f(t,e!==null?e:void 0))}}var Ei=class{constructor(t,e){this.tx=t;this.store=e}get(t,e){try{let i=this.store.get(t);i.onerror=Er(e),i.onsuccess=n=>{let s=n.target.result;s===void 0?e(null,s):e(null,ft(s))}}catch(i){e(wr(i))}}},Kn=class extends Ei{constructor(t,e){super(t,e)}put(t,e,i,n){try{let s=ut(e),a;a=i?this.store.put(s,t):this.store.add(s,t),a.onerror=Er(n),a.onsuccess=o=>{n(null,!0)}}catch(s){n(wr(s))}}del(t,e){try{let i=this.store.delete(t);i.onerror=Er(e),i.onsuccess=n=>{e()}}catch(i){e(wr(i))}}commit(t){setTimeout(t,0)}abort(t){let e=null;try{this.tx.abort()}catch(i){e=wr(i)}finally{t(e)}}},Fr=class{constructor(t,e){this.db=t;this.storeName=e}static Create(t,e){let i=Yn.open(t,1);i.onupgradeneeded=n=>{let s=n.target.result;s.objectStoreNames.contains(t)&&s.deleteObjectStore(t),s.createObjectStore(t)},i.onsuccess=n=>{e(null,new Fr(n.target.result,t))},i.onerror=Er(e,13)}name(){return Ge.Name+" - "+this.storeName}clear(t){try{let e=this.db.transaction(this.storeName,"readwrite"),i=e.objectStore(this.storeName),n=i.clear();n.onsuccess=s=>{setTimeout(t,0)},n.onerror=Er(t)}catch(e){t(wr(e))}}beginTransaction(t="readonly"){let e=this.db.transaction(this.storeName,t),i=e.objectStore(this.storeName);if(t==="readwrite")return new Kn(e,i);if(t==="readonly")return new Ei(e,i);throw new f(22,"Invalid transaction type.")}},Xn=class extends wi{static Create(t,e){t||(t={storeName:"browserfs",cacheSize:100}),Fr.Create(t.storeName||"browserfs",(i,n)=>{if(n){let s=new Xn(t.cacheSize||100);s.init(n,a=>{a?e(a):e(null,s)})}else e(i)})}static CreateAsync(t){return new Promise((e,i)=>{this.Create(t,(n,s)=>{n||!s?i(n):e(s)})})}static isAvailable(){try{return typeof Yn!="undefined"&&Yn.open("__browserfs_test__")!==null}catch(t){return!1}}constructor(t){super(t)}},Ge=Xn;Ge.Name="IndexedDB",Ge.Options={storeName:{type:"string",optional:!0,description:"The name of this file system. You can have multiple IndexedDB file systems operating at once, but each must have a different name."},cacheSize:{type:"number",optional:!0,description:"The size of the inode cache. Defaults to 100. A size of 0 or below disables caching."}};var Gn=!1,Cr;try{globalThis.localStorage.setItem("__test__",String.fromCharCode(55296)),Gn=globalThis.localStorage.getItem("__test__")===String.fromCharCode(55296)}catch(r){Gn=!1}Cr=Gn?"binary_string":"binary_string_ie";g.isEncoding(Cr)||(Cr="base64");var $n=class{name(){return $e.Name}clear(){globalThis.localStorage.clear()}beginTransaction(t){return new nr(this)}get(t){try{let e=globalThis.localStorage.getItem(t);if(e!==null)return g.from(e,Cr)}catch(e){}}put(t,e,i){try{return!i&&globalThis.localStorage.getItem(t)!==null?!1:(globalThis.localStorage.setItem(t,e.toString(Cr)),!0)}catch(n){throw new f(28,"LocalStorage is full.")}}del(t){try{globalThis.localStorage.removeItem(t)}catch(e){throw new f(5,"Unable to delete key "+t+": "+e)}}},Jn=class extends sr{static Create(t,e){e(null,new Jn)}static CreateAsync(t){return new Promise((e,i)=>{this.Create(t,(n,s)=>{n||!s?i(n):e(s)})})}static isAvailable(){return typeof globalThis.localStorage!="undefined"}constructor(){super({store:new $n})}},$e=Jn;$e.Name="LocalStorage",$e.Options={};var Fi=class extends ie{constructor(e){super();this.mountList=[];this.mntMap={},this.rootFs=e}static Create(e,i){Be.Create({},(n,s)=>{if(s){let a=new Fi(s);try{for(let o of Object.keys(e))a.mount(o,e[o],z.Root)}catch(o){return i(o)}i(null,a)}else i(n)})}static CreateAsync(e){return new Promise((i,n)=>{this.Create(e,(s,a)=>{s||!a?n(s):i(a)})})}static isAvailable(){return!0}mount(e,i,n){if(e[0]!=="/"&&(e=`/${e}`),e=Y(e),this.mntMap[e])throw new f(22,"Mount point "+e+" is already in use.");ci(e,511,n,this.rootFs),this.mntMap[e]=i,this.mountList.push(e),this.mountList=this.mountList.sort((s,a)=>a.length-s.length)}umount(e,i){if(e[0]!=="/"&&(e=`/${e}`),e=Y(e),!this.mntMap[e])throw new f(22,"Mount point "+e+" is already unmounted.");for(delete this.mntMap[e],this.mountList.splice(this.mountList.indexOf(e),1);e!=="/"&&this.rootFs.readdirSync(e,i).length===0;)this.rootFs.rmdirSync(e,i),e=B(e)}_getFs(e){let i=this.mountList,n=i.length;for(let s=0;s<n;s++){let a=i[s];if(a.length<=e.length&&e.indexOf(a)===0)return e=e.substr(a.length>1?a.length:0),e===""&&(e="/"),{fs:this.mntMap[a],path:e,mountPoint:a}}return{fs:this.rootFs,path:e,mountPoint:"/"}}getName(){return Fi.Name}diskSpace(e,i){i(0,0)}isReadOnly(){return!1}supportsLinks(){return!1}supportsProps(){return!1}supportsSynch(){return!0}standardizeError(e,i,n){let s=e.message.indexOf(i);return s!==-1&&(e.message=e.message.substr(0,s)+n+e.message.substr(s+i.length),e.path=n),e}rename(e,i,n,s){let a=this._getFs(e),o=this._getFs(i);return a.fs===o.fs?a.fs.rename(a.path,o.path,n,c=>{c&&this.standardizeError(this.standardizeError(c,a.path,e),o.path,i),s(c)}):re.readFile(e,function(c,l){if(c)return s(c);re.writeFile(i,l,function(u){if(u)return s(u);re.unlink(e,s)})})}renameSync(e,i,n){let s=this._getFs(e),a=this._getFs(i);if(s.fs===a.fs)try{return s.fs.renameSync(s.path,a.path,n)}catch(c){throw this.standardizeError(this.standardizeError(c,s.path,e),a.path,i),c}let o=re.readFileSync(e);return re.writeFileSync(i,o),re.unlinkSync(e)}readdirSync(e,i){let n=this._getFs(e),s=null;if(n.fs!==this.rootFs)try{s=this.rootFs.readdirSync(e,i)}catch(a){}try{let a=n.fs.readdirSync(n.path,i);return s===null?a:a.concat(s.filter(o=>a.indexOf(o)===-1))}catch(a){if(s===null)throw this.standardizeError(a,n.path,e);return s}}readdir(e,i,n){let s=this._getFs(e);s.fs.readdir(s.path,i,(a,o)=>{if(s.fs!==this.rootFs)try{let c=this.rootFs.readdirSync(e,i);o?o=o.concat(c.filter(l=>o.indexOf(l)===-1)):o=c}catch(c){if(a)return n(this.standardizeError(a,s.path,e))}else if(a)return n(this.standardizeError(a,s.path,e));n(null,o)})}realpathSync(e,i,n){let s=this._getFs(e);try{let a=s.fs.realpathSync(s.path,{},n);return Y(V(s.mountPoint,a))}catch(a){throw this.standardizeError(a,s.path,e)}}realpath(e,i,n,s){let a=this._getFs(e);a.fs.realpath(a.path,{},n,(o,c)=>{o?s(this.standardizeError(o,a.path,e)):s(null,Y(V(a.mountPoint,c)))})}rmdirSync(e,i){let n=this._getFs(e);if(this._containsMountPt(e))throw f.ENOTEMPTY(e);try{n.fs.rmdirSync(n.path,i)}catch(s){throw this.standardizeError(s,n.path,e)}}rmdir(e,i,n){let s=this._getFs(e);this._containsMountPt(e)?n(f.ENOTEMPTY(e)):s.fs.rmdir(s.path,i,a=>{n(a?this.standardizeError(a,s.path,e):null)})}_containsMountPt(e){let i=this.mountList,n=i.length;for(let s=0;s<n;s++){let a=i[s];if(a.length>=e.length&&a.slice(0,e.length)===e)return!0}return!1}},Le=Fi;Le.Name="MountableFileSystem",Le.Options={};function Fo(r,t,e){return t?function(...i){let n=i[0],s=this._getFs(n);i[0]=s.path;try{return s.fs[r].apply(s.fs,i)}catch(a){throw this.standardizeError(a,s.path,n),a}}:function(...i){let n=i[0],s=this._getFs(n);if(i[0]=s.path,typeof i[i.length-1]=="function"){let a=i[i.length-1];i[i.length-1]=(...o)=>{o.length>0&&o[0]instanceof f&&this.standardizeError(o[0],s.path,n),a.apply(null,o)}}return s.fs[r].apply(s.fs,i)}}var Co=[["exists","unlink","readlink"],["stat","mkdir","truncate"],["open","readFile","chmod","utimes"],["chown"],["writeFile","appendFile"]];for(let r=0;r<Co.length;r++){let t=Co[r];for(let e of t)Le.prototype[e]=Fo(e,!1,r+1),Le.prototype[e+"Sync"]=Fo(e+"Sync",!0,r+1)}var xr=class{constructor(){this._locked=!1;this._waiters=[]}lock(t){if(this._locked){this._waiters.push(t);return}this._locked=!0,t()}unlock(){if(!this._locked)throw new Error("unlock of a non-locked mutex");let t=this._waiters.shift();if(t){xe(t);return}this._locked=!1}tryLock(){return this._locked?!1:(this._locked=!0,!0)}isLocked(){return this._locked}};var Ar=class{constructor(t){this._fs=t,this._mu=new xr}getName(){return"LockedFS<"+this._fs.getName()+">"}getFSUnlocked(){return this._fs}diskSpace(t,e){this._fs.diskSpace(t,e)}isReadOnly(){return this._fs.isReadOnly()}supportsLinks(){return this._fs.supportsLinks()}supportsProps(){return this._fs.supportsProps()}supportsSynch(){return this._fs.supportsSynch()}rename(t,e,i,n){this._mu.lock(()=>{this._fs.rename(t,e,i,s=>{this._mu.unlock(),n(s)})})}renameSync(t,e,i){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.renameSync(t,e,i)}stat(t,e,i,n){this._mu.lock(()=>{this._fs.stat(t,e,i,(s,a)=>{this._mu.unlock(),n(s,a)})})}statSync(t,e,i){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.statSync(t,e,i)}access(t,e,i,n){this._mu.lock(()=>{this._fs.access(t,e,i,s=>{this._mu.unlock(),n(s)})})}accessSync(t,e,i){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.accessSync(t,e,i)}open(t,e,i,n,s){this._mu.lock(()=>{this._fs.open(t,e,i,n,(a,o)=>{this._mu.unlock(),s(a,o)})})}openSync(t,e,i,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.openSync(t,e,i,n)}unlink(t,e,i){this._mu.lock(()=>{this._fs.unlink(t,e,n=>{this._mu.unlock(),i(n)})})}unlinkSync(t,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.unlinkSync(t,e)}rmdir(t,e,i){this._mu.lock(()=>{this._fs.rmdir(t,e,n=>{this._mu.unlock(),i(n)})})}rmdirSync(t,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.rmdirSync(t,e)}mkdir(t,e,i,n){this._mu.lock(()=>{this._fs.mkdir(t,e,i,s=>{this._mu.unlock(),n(s)})})}mkdirSync(t,e,i){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.mkdirSync(t,e,i)}readdir(t,e,i){this._mu.lock(()=>{this._fs.readdir(t,e,(n,s)=>{this._mu.unlock(),i(n,s)})})}readdirSync(t,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readdirSync(t,e)}exists(t,e,i){this._mu.lock(()=>{this._fs.exists(t,e,n=>{this._mu.unlock(),i(n)})})}existsSync(t,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.existsSync(t,e)}realpath(t,e,i,n){this._mu.lock(()=>{this._fs.realpath(t,e,i,(s,a)=>{this._mu.unlock(),n(s,a)})})}realpathSync(t,e,i){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.realpathSync(t,e,i)}truncate(t,e,i,n){this._mu.lock(()=>{this._fs.truncate(t,e,i,s=>{this._mu.unlock(),n(s)})})}truncateSync(t,e,i){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.truncateSync(t,e,i)}readFile(t,e,i,n,s){this._mu.lock(()=>{this._fs.readFile(t,e,i,n,(a,o)=>{this._mu.unlock(),s(a,o)})})}readFileSync(t,e,i,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readFileSync(t,e,i,n)}writeFile(t,e,i,n,s,a,o){this._mu.lock(()=>{this._fs.writeFile(t,e,i,n,s,a,c=>{this._mu.unlock(),o(c)})})}writeFileSync(t,e,i,n,s,a){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.writeFileSync(t,e,i,n,s,a)}appendFile(t,e,i,n,s,a,o){this._mu.lock(()=>{this._fs.appendFile(t,e,i,n,s,a,c=>{this._mu.unlock(),o(c)})})}appendFileSync(t,e,i,n,s,a){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.appendFileSync(t,e,i,n,s,a)}chmod(t,e,i,n,s){this._mu.lock(()=>{this._fs.chmod(t,e,i,n,a=>{this._mu.unlock(),s(a)})})}chmodSync(t,e,i,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chmodSync(t,e,i,n)}chown(t,e,i,n,s,a){this._mu.lock(()=>{this._fs.chown(t,e,i,n,s,o=>{this._mu.unlock(),a(o)})})}chownSync(t,e,i,n,s){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chownSync(t,e,i,n,s)}utimes(t,e,i,n,s){this._mu.lock(()=>{this._fs.utimes(t,e,i,n,a=>{this._mu.unlock(),s(a)})})}utimesSync(t,e,i,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.utimesSync(t,e,i,n)}link(t,e,i,n){this._mu.lock(()=>{this._fs.link(t,e,i,s=>{this._mu.unlock(),n(s)})})}linkSync(t,e,i){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.linkSync(t,e,i)}symlink(t,e,i,n,s){this._mu.lock(()=>{this._fs.symlink(t,e,i,n,a=>{this._mu.unlock(),s(a)})})}symlinkSync(t,e,i,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.symlinkSync(t,e,i,n)}readlink(t,e,i){this._mu.lock(()=>{this._fs.readlink(t,e,(n,s)=>{this._mu.unlock(),i(n,s)})})}readlinkSync(t,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readlinkSync(t,e)}};var Je="/.deletedFiles.log";function xo(r){return 146|r}function Fe(r){return T.getFileFlag(r)}var Ci=class extends le{constructor(t,e,i,n,s){super(t,e,i,n,s)}sync(t){if(!this.isDirty()){t(null);return}this._fs._syncAsync(this,e=>{this.resetDirty(),t(e)})}syncSync(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())}close(t){this.sync(t)}closeSync(){this.syncSync()}},xi=class extends ie{constructor(e,i){super();this._isInitialized=!1;this._initializeCallbacks=[];this._deletedFiles={};this._deleteLog="";this._deleteLogUpdatePending=!1;this._deleteLogUpdateNeeded=!1;this._deleteLogError=null;if(this._writable=e,this._readable=i,this._writable.isReadOnly())throw new f(22,"Writable file system must be writable.")}static isAvailable(){return!0}getOverlayedFileSystems(){return{readable:this._readable,writable:this._writable}}_syncAsync(e,i){let n=e.getStats();this.createParentDirectoriesAsync(e.getPath(),n.getCred(0,0),s=>{if(s)return i(s);this._writable.writeFile(e.getPath(),e.getBuffer(),null,Fe("w"),n.mode,n.getCred(0,0),i)})}_syncSync(e){let i=e.getStats();this.createParentDirectories(e.getPath(),i.getCred(0,0)),this._writable.writeFileSync(e.getPath(),e.getBuffer(),null,Fe("w"),i.mode,i.getCred(0,0))}getName(){return Qe.Name}_initialize(e){let i=this._initializeCallbacks,n=s=>{this._isInitialized=!s,this._initializeCallbacks=[],i.forEach(a=>a(s))};if(this._isInitialized)return e();i.push(e),i.length===1&&this._writable.readFile(Je,"utf8",Fe("r"),z.Root,(s,a)=>{if(s){if(s.errno!==2)return n(s)}else this._deleteLog=a;this._reparseDeletionLog(),n()})}isReadOnly(){return!1}supportsSynch(){return this._readable.supportsSynch()&&this._writable.supportsSynch()}supportsLinks(){return!1}supportsProps(){return this._readable.supportsProps()&&this._writable.supportsProps()}getDeletionLog(){return this._deleteLog}restoreDeletionLog(e,i){this._deleteLog=e,this._reparseDeletionLog(),this.updateLog("",i)}rename(e,i,n,s){if(!(!this.checkInitAsync(s)||this.checkPathAsync(e,s)||this.checkPathAsync(i,s))){if(e===Je||i===Je)return s(f.EPERM("Cannot rename deletion log."));if(e===i)return s();this.stat(e,!1,n,(a,o)=>a?s(a):this.stat(i,!1,n,(c,l)=>{let u=this;function d(p){let m=p.shift();if(!m)return s();let y=Y(e,m),b=Y(i,m);u.rename(y,b,n,S=>{if(S)return s(S);d(p)})}let h=511;if(o.isDirectory()){if(c)return c.errno!==2?s(c):this._writable.exists(e,n,p=>{if(p)return this._writable.rename(e,i,n,s);this._writable.mkdir(i,h,n,m=>{if(m)return s(m);this._readable.readdir(e,n,(y,b)=>{if(y)return s();d(b)})})});if(h=l.mode,!l.isDirectory())return s(f.ENOTDIR(i));this.readdir(i,n,(p,m)=>{if(m&&m.length)return s(f.ENOTEMPTY(i));this._readable.readdir(e,n,(y,b)=>{if(y)return s();d(b)})})}if(l&&l.isDirectory())return s(f.EISDIR(i));this.readFile(e,null,Fe("r"),n,(p,m)=>p?s(p):this.writeFile(i,m,null,Fe("w"),o.mode,n,y=>y?s(y):this.unlink(e,n,s)))}))}}renameSync(e,i,n){if(this.checkInitialized(),this.checkPath(e),this.checkPath(i),e===Je||i===Je)throw f.EPERM("Cannot rename deletion log.");let s=this.statSync(e,!1,n);if(s.isDirectory()){if(e===i)return;let a=511;if(this.existsSync(i,n)){let o=this.statSync(i,!1,n);if(a=o.mode,o.isDirectory()){if(this.readdirSync(i,n).length>0)throw f.ENOTEMPTY(i)}else throw f.ENOTDIR(i)}this._writable.existsSync(e,n)?this._writable.renameSync(e,i,n):this._writable.existsSync(i,n)||this._writable.mkdirSync(i,a,n),this._readable.existsSync(e,n)&&this._readable.readdirSync(e,n).forEach(o=>{this.renameSync(Y(e,o),Y(i,o),n)})}else{if(this.existsSync(i,n)&&this.statSync(i,!1,n).isDirectory())throw f.EISDIR(i);this.writeFileSync(i,this.readFileSync(e,null,Fe("r"),n),null,Fe("w"),s.mode,n)}e!==i&&this.existsSync(e,n)&&this.unlinkSync(e,n)}stat(e,i,n,s){this.checkInitAsync(s)&&this._writable.stat(e,i,n,(a,o)=>{a&&a.errno===2?(this._deletedFiles[e]&&s(f.ENOENT(e)),this._readable.stat(e,i,n,(c,l)=>{l&&(l=C.clone(l),l.mode=xo(l.mode)),s(c,l)})):s(a,o)})}statSync(e,i,n){this.checkInitialized();try{return this._writable.statSync(e,i,n)}catch(s){if(this._deletedFiles[e])throw f.ENOENT(e);let a=C.clone(this._readable.statSync(e,i,n));return a.mode=xo(a.mode),a}}open(e,i,n,s,a){!this.checkInitAsync(a)||this.checkPathAsync(e,a)||this.stat(e,!1,s,(o,c)=>{if(c)switch(i.pathExistsAction()){case 2:return this.createParentDirectoriesAsync(e,s,l=>{if(l)return a(l);this._writable.open(e,i,n,s,a)});case 0:return this._writable.exists(e,s,l=>{l?this._writable.open(e,i,n,s,a):(c=C.clone(c),c.mode=n,this._readable.readFile(e,null,Fe("r"),s,(u,d)=>{if(u)return a(u);c.size===-1&&(c.size=d.length);let h=new Ci(this,e,i,c,d);a(null,h)}))});default:return a(f.EEXIST(e))}else switch(i.pathNotExistsAction()){case 3:return this.createParentDirectoriesAsync(e,s,l=>l?a(l):this._writable.open(e,i,n,s,a));default:return a(f.ENOENT(e))}})}openSync(e,i,n,s){if(this.checkInitialized(),this.checkPath(e),e===Je)throw f.EPERM("Cannot open deletion log.");if(this.existsSync(e,s))switch(i.pathExistsAction()){case 2:return this.createParentDirectories(e,s),this._writable.openSync(e,i,n,s);case 0:if(this._writable.existsSync(e,s))return this._writable.openSync(e,i,n,s);{let a=this._readable.readFileSync(e,null,Fe("r"),s),o=C.clone(this._readable.statSync(e,!1,s));return o.mode=n,new Ci(this,e,i,o,a)}default:throw f.EEXIST(e)}else switch(i.pathNotExistsAction()){case 3:return this.createParentDirectories(e,s),this._writable.openSync(e,i,n,s);default:throw f.ENOENT(e)}}unlink(e,i,n){!this.checkInitAsync(n)||this.checkPathAsync(e,n)||this.exists(e,i,s=>{if(!s)return n(f.ENOENT(e));this._writable.exists(e,i,a=>{if(a)return this._writable.unlink(e,i,o=>{if(o)return n(o);this.exists(e,i,c=>{c&&this.deletePath(e,i),n(null)})});this.deletePath(e,i),n(null)})})}unlinkSync(e,i){if(this.checkInitialized(),this.checkPath(e),this.existsSync(e,i))this._writable.existsSync(e,i)&&this._writable.unlinkSync(e,i),this.existsSync(e,i)&&this.deletePath(e,i);else throw f.ENOENT(e)}rmdir(e,i,n){if(!this.checkInitAsync(n))return;let s=()=>{this.readdir(e,i,(a,o)=>{if(a)return n(a);if(o.length)return n(f.ENOTEMPTY(e));this.deletePath(e,i),n(null)})};this.exists(e,i,a=>{if(!a)return n(f.ENOENT(e));this._writable.exists(e,i,o=>{o?this._writable.rmdir(e,i,c=>{if(c)return n(c);this._readable.exists(e,i,l=>{l?s():n()})}):s()})})}rmdirSync(e,i){if(this.checkInitialized(),this.existsSync(e,i)){if(this._writable.existsSync(e,i)&&this._writable.rmdirSync(e,i),this.existsSync(e,i)){if(this.readdirSync(e,i).length>0)throw f.ENOTEMPTY(e);this.deletePath(e,i)}}else throw f.ENOENT(e)}mkdir(e,i,n,s){this.checkInitAsync(s)&&this.exists(e,n,a=>{if(a)return s(f.EEXIST(e));this.createParentDirectoriesAsync(e,n,o=>{if(o)return s(o);this._writable.mkdir(e,i,n,s)})})}mkdirSync(e,i,n){if(this.checkInitialized(),this.existsSync(e,n))throw f.EEXIST(e);this.createParentDirectories(e,n),this._writable.mkdirSync(e,i,n)}readdir(e,i,n){this.checkInitAsync(n)&&this.stat(e,!1,i,(s,a)=>{if(s)return n(s);if(!a.isDirectory())return n(f.ENOTDIR(e));this._writable.readdir(e,i,(o,c)=>{if(o&&o.code!=="ENOENT")return n(o);(o||!c)&&(c=[]),this._readable.readdir(e,i,(l,u)=>{(l||!u)&&(u=[]);let d={},h=c.concat(u.filter(p=>!this._deletedFiles[`${e}/${p}`])).filter(p=>{let m=!d[p];return d[p]=!0,m});n(null,h)})})})}readdirSync(e,i){if(this.checkInitialized(),!this.statSync(e,!1,i).isDirectory())throw f.ENOTDIR(e);let s=[];try{s=s.concat(this._writable.readdirSync(e,i))}catch(o){}try{s=s.concat(this._readable.readdirSync(e,i).filter(o=>!this._deletedFiles[`${e}/${o}`]))}catch(o){}let a={};return s.filter(o=>{let c=!a[o];return a[o]=!0,c})}exists(e,i,n){this.checkInitialized(),this._writable.exists(e,i,s=>{if(s)return n(!0);this._readable.exists(e,i,a=>{n(a&&this._deletedFiles[e]!==!0)})})}existsSync(e,i){return this.checkInitialized(),this._writable.existsSync(e,i)||this._readable.existsSync(e,i)&&this._deletedFiles[e]!==!0}chmod(e,i,n,s,a){this.checkInitAsync(a)&&this.operateOnWritableAsync(e,s,o=>{if(o)return a(o);this._writable.chmod(e,i,n,s,a)})}chmodSync(e,i,n,s){this.checkInitialized(),this.operateOnWritable(e,s,()=>{this._writable.chmodSync(e,i,n,s)})}chown(e,i,n,s,a,o){this.checkInitAsync(o)&&this.operateOnWritableAsync(e,a,c=>{if(c)return o(c);this._writable.chown(e,i,n,s,a,o)})}chownSync(e,i,n,s,a){this.checkInitialized(),this.operateOnWritable(e,a,()=>{this._writable.chownSync(e,i,n,s,a)})}utimes(e,i,n,s,a){this.checkInitAsync(a)&&this.operateOnWritableAsync(e,s,o=>{if(o)return a(o);this._writable.utimes(e,i,n,s,a)})}utimesSync(e,i,n,s){this.checkInitialized(),this.operateOnWritable(e,s,()=>{this._writable.utimesSync(e,i,n,s)})}deletePath(e,i){this._deletedFiles[e]=!0,this.updateLog(`d${e}
`,i)}updateLog(e,i){this._deleteLog+=e,this._deleteLogUpdatePending?this._deleteLogUpdateNeeded=!0:(this._deleteLogUpdatePending=!0,this._writable.writeFile(Je,this._deleteLog,"utf8",T.getFileFlag("w"),420,i,n=>{this._deleteLogUpdatePending=!1,n?this._deleteLogError=n:this._deleteLogUpdateNeeded&&(this._deleteLogUpdateNeeded=!1,this.updateLog("",i))}))}_reparseDeletionLog(){this._deletedFiles={},this._deleteLog.split(`
`).forEach(e=>{this._deletedFiles[e.slice(1)]=e.slice(0,1)==="d"})}checkInitialized(){if(this._isInitialized){if(this._deleteLogError!==null){let e=this._deleteLogError;throw this._deleteLogError=null,e}}else throw new f(1,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")}checkInitAsync(e){if(this._isInitialized){if(this._deleteLogError!==null){let i=this._deleteLogError;return this._deleteLogError=null,e(i),!1}}else return e(new f(1,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")),!1;return!0}checkPath(e){if(e===Je)throw f.EPERM(e)}checkPathAsync(e,i){return e===Je?(i(f.EPERM(e)),!0):!1}createParentDirectoriesAsync(e,i,n){let s=B(e),a=[],o=this;this._writable.stat(s,!1,i,c);function c(u,d){u?s==="/"?n(new f(16,"Invariant failed: root does not exist!")):(a.push(s),s=B(s),o._writable.stat(s,!1,i,c)):l()}function l(){if(!a.length)return n();let u=a.pop();o._readable.stat(u,!1,i,(d,h)=>{if(!h)return n();o._writable.mkdir(u,h.mode,i,p=>{if(p)return n(p);l()})})}}createParentDirectories(e,i){let n=B(e),s=[];for(;!this._writable.existsSync(n,i);)s.push(n),n=B(n);s=s.reverse(),s.forEach(a=>{this._writable.mkdirSync(a,this.statSync(a,!1,i).mode,i)})}operateOnWritable(e,i,n){if(this.existsSync(e,i))this._writable.existsSync(e,i)||this.copyToWritable(e,i),n();else throw f.ENOENT(e)}operateOnWritableAsync(e,i,n){this.exists(e,i,s=>{if(!s)return n(f.ENOENT(e));this._writable.exists(e,i,a=>{if(a)n();else return this.copyToWritableAsync(e,i,n)})})}copyToWritable(e,i){let n=this.statSync(e,!1,i);n.isDirectory()?this._writable.mkdirSync(e,n.mode,i):this.writeFileSync(e,this._readable.readFileSync(e,null,Fe("r"),i),null,Fe("w"),this.statSync(e,!1,i).mode,i)}copyToWritableAsync(e,i,n){this.stat(e,!1,i,(s,a)=>{if(s)return n(s);if(a.isDirectory())return this._writable.mkdir(e,a.mode,i,n);this._readable.readFile(e,null,Fe("r"),i,(o,c)=>{if(o)return n(o);this.writeFile(e,c,null,Fe("w"),a.mode,i,n)})})}},Qn=class extends Ar{static Create(t,e){try{let i=new Qn(t.writable,t.readable);i._initialize(n=>{e(n,i)})}catch(i){e(i)}}static CreateAsync(t){return new Promise((e,i)=>{this.Create(t,(n,s)=>{n||!s?i(n):e(s)})})}static isAvailable(){return xi.isAvailable()}constructor(t,e){super(new xi(t,e))}getOverlayedFileSystems(){return super.getFSUnlocked().getOverlayedFileSystems()}unwrap(){return super.getFSUnlocked()}_initialize(t){super.getFSUnlocked()._initialize(t)}},Qe=Qn;Qe.Name="OverlayFS",Qe.Options={writable:{type:"object",description:"The file system to write modified files to."},readable:{type:"object",description:"The file system that initially populates this file system."}};var es=class{constructor(){this._callbacks={};this._nextId=0}toRemoteArg(t){let e=this._nextId++;return this._callbacks[e]=t,{type:0,id:e}}toLocalArg(t){let e=this._callbacks[t];return delete this._callbacks[t],e}},ts=class{constructor(){this._fileDescriptors={};this._nextId=0}toRemoteArg(t,e,i,n){let s=this._nextId++,a,o;this._fileDescriptors[s]=t,t.stat((c,l)=>{c?n(c):(o=Ht(l.toBuffer()),i.isReadable()?t.read(g.alloc(l.size),0,l.size,0,(u,d,h)=>{u?n(u):(a=Ht(h),n(null,{type:1,id:s,data:a,stat:o,path:e,flag:i.getFlagString()}))}):n(null,{type:1,id:s,data:new ArrayBuffer(0),stat:o,path:e,flag:i.getFlagString()}))})}applyFdAPIRequest(t,e){let i=t.args[0];this._applyFdChanges(i,(n,s)=>{n?e(n):s[t.method](a=>{t.method==="close"&&delete this._fileDescriptors[i.id],e(a)})})}_applyFdChanges(t,e){let i=this._fileDescriptors[t.id],n=jt(t.data),s=C.fromBuffer(jt(t.stat)),a=T.getFileFlag(t.flag);a.isWriteable()?i.write(n,0,n.length,a.isAppendable()?i.getPos():0,o=>{function c(){i.stat((l,u)=>{l?e(l):u.mode!==s.mode?i.chmod(s.mode,d=>{e(d,i)}):e(l,i)})}o?e(o):a.isAppendable()?c():i.truncate(n.length,()=>{c()})}):e(null,i)}};function Ai(r){return{type:2,errorData:Ht(r.writeToBuffer())}}function Ao(r){return f.fromBuffer(jt(r.errorData))}function ko(r){return{type:7,name:r.name,message:r.message,stack:r.stack}}function Bo(r){let t=globalThis[r.name];typeof t!="function"&&(t=Error);let e=new t(r.message);return e.stack=r.stack,e}function Oo(r){return{type:3,statsData:Ht(r.toBuffer())}}function Io(r){return C.fromBuffer(jt(r.statsData))}function To(r){return{type:5,flagStr:r.getFlagString()}}function Do(r){return T.getFileFlag(r.flagStr)}function Ht(r){return ut(r)}function jt(r){return ft(r)}function Ro(r){return{type:6,data:Ht(r)}}function No(r){return jt(r.data)}function Mu(r){return r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"browserfsMessage")&&r.browserfsMessage}function Pu(r){return r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"browserfsMessage")&&r.browserfsMessage}var ki=class extends le{constructor(e,i,n,s,a,o){super(e,i,n,s,o);this._remoteFdId=a}getRemoteFdId(){return this._remoteFdId}toRemoteArg(){return{type:1,id:this._remoteFdId,data:Ht(this.getBuffer()),stat:Ht(this.getStats().toBuffer()),path:this.getPath(),flag:this.getFlag().getFlagString()}}sync(e){this._syncClose("sync",e)}close(e){this._syncClose("close",e)}_syncClose(e,i){this.isDirty()?this._fs.syncClose(e,this,n=>{n||this.resetDirty(),i(n)}):i()}},Bi=class extends ie{constructor(e){super();this._callbackConverter=new es;this._isInitialized=!1;this._isReadOnly=!1;this._supportLinks=!1;this._supportProps=!1;this._worker=e,this._worker.addEventListener("message",i=>{let n=i.data;if(Pu(n)){let s,a=n.args,o=new Array(a.length);for(s=0;s<o.length;s++)o[s]=this._argRemote2Local(a[s]);this._callbackConverter.toLocalArg(n.cbId).apply(null,o)}})}static Create(e,i){let n=new Bi(e.worker);n._initialize(()=>{i(null,n)})}static CreateAsync(e){return new Promise((i,n)=>{this.Create(e,(s,a)=>{s||!a?n(s):i(a)})})}static isAvailable(){return typeof importScripts!="undefined"||typeof Worker!="undefined"}static attachRemoteListener(e){let i=new ts;function n(a,o,c){switch(typeof a){case"object":a instanceof C?c(null,Oo(a)):a instanceof f?c(null,Ai(a)):a instanceof dt?c(null,i.toRemoteArg(a,o[0],o[1],c)):a instanceof T?c(null,To(a)):a instanceof g?c(null,Ro(a)):a instanceof Error?c(null,ko(a)):c(null,a);break;default:c(null,a);break}}function s(a,o){if(!a)return a;switch(typeof a){case"object":if(typeof a.type=="number"){let c=a;switch(c.type){case 0:let l=a.id;return function(){let u,d=new Array(arguments.length),h,p=arguments.length;function m(y){p>0&&(p=-1,h={browserfsMessage:!0,cbId:l,args:[Ai(y)]},e.postMessage(h))}for(u=0;u<arguments.length;u++)((y,b)=>{n(b,o,(S,w)=>{d[y]=w,S?m(S):--p===0&&(h={browserfsMessage:!0,cbId:l,args:d},e.postMessage(h))})})(u,arguments[u]);arguments.length===0&&(h={browserfsMessage:!0,cbId:l,args:d},e.postMessage(h))};case 2:return Ao(c);case 3:return Io(c);case 5:return Do(c);case 6:return No(c);case 7:return Bo(c);default:return a}}else return a;default:return a}}e.addEventListener("message",a=>{let o=a.data;if(Mu(o)){let c=o.args,l=new Array(c.length);switch(o.method){case"close":case"sync":(()=>{let d=c[1];i.applyFdAPIRequest(o,h=>{let p={browserfsMessage:!0,cbId:d.id,args:h?[Ai(h)]:[]};e.postMessage(p)})})();break;case"probe":(()=>{let d=re.getRootFS(),h=c[1],p={type:4,isReadOnly:d.isReadOnly(),supportsLinks:d.supportsLinks(),supportsProps:d.supportsProps()},m={browserfsMessage:!0,cbId:h.id,args:[p]};e.postMessage(m)})();break;default:for(let d=0;d<c.length;d++)l[d]=s(c[d],l);let u=re.getRootFS();u[o.method].apply(u,l);break}}})}getName(){return Bi.Name}isReadOnly(){return this._isReadOnly}supportsSynch(){return!1}supportsLinks(){return this._supportLinks}supportsProps(){return this._supportProps}rename(e,i,n,s){this._rpc("rename",arguments)}stat(e,i,n,s){this._rpc("stat",arguments)}open(e,i,n,s,a){this._rpc("open",arguments)}unlink(e,i,n){this._rpc("unlink",arguments)}rmdir(e,i,n){this._rpc("rmdir",arguments)}mkdir(e,i,n,s){this._rpc("mkdir",arguments)}readdir(e,i,n){this._rpc("readdir",arguments)}exists(e,i,n){this._rpc("exists",arguments)}realpath(e,i,n,s){this._rpc("realpath",arguments)}truncate(e,i,n,s){this._rpc("truncate",arguments)}readFile(e,i,n,s,a){this._rpc("readFile",arguments)}writeFile(e,i,n,s,a,o,c){this._rpc("writeFile",arguments)}appendFile(e,i,n,s,a,o,c){this._rpc("appendFile",arguments)}chmod(e,i,n,s,a){this._rpc("chmod",arguments)}chown(e,i,n,s,a,o){this._rpc("chown",arguments)}utimes(e,i,n,s,a){this._rpc("utimes",arguments)}link(e,i,n,s){this._rpc("link",arguments)}symlink(e,i,n,s,a){this._rpc("symlink",arguments)}readlink(e,i,n){this._rpc("readlink",arguments)}syncClose(e,i,n){this._worker.postMessage({browserfsMessage:!0,method:e,args:[i.toRemoteArg(),this._callbackConverter.toRemoteArg(n)]})}_initialize(e){if(this._isInitialized)e();else{let i={browserfsMessage:!0,method:"probe",args:[this._argLocal2Remote(_e()),this._callbackConverter.toRemoteArg(n=>{this._isInitialized=!0,this._isReadOnly=n.isReadOnly,this._supportLinks=n.supportsLinks,this._supportProps=n.supportsProps,e()})]};this._worker.postMessage(i)}}_argRemote2Local(e){if(!e)return e;switch(typeof e){case"object":if(typeof e.type=="number"){let i=e;switch(i.type){case 2:return Ao(i);case 1:let n=i;return new ki(this,n.path,T.getFileFlag(n.flag),C.fromBuffer(jt(n.stat)),n.id,jt(n.data));case 3:return Io(i);case 5:return Do(i);case 6:return No(i);case 7:return Bo(i);default:return e}}else return e;default:return e}}_rpc(e,i){let n=new Array(i.length);for(let a=0;a<i.length;a++)n[a]=this._argLocal2Remote(i[a]);let s={browserfsMessage:!0,method:e,args:n};this._worker.postMessage(s)}_argLocal2Remote(e){if(!e)return e;switch(typeof e){case"object":return e instanceof C?Oo(e):e instanceof f?Ai(e):e instanceof ki?e.toRemoteArg():e instanceof T?To(e):e instanceof g?Ro(e):e instanceof Error?ko(e):"Unknown argument";case"function":return this._callbackConverter.toRemoteArg(e);default:return e}}},St=Bi;St.Name="WorkerFS",St.Options={worker:{type:"object",description:"The target worker that you want to connect to, or the current worker if in a worker context.",validator:function(e,i){e.postMessage?i():i(new f(22,"option must be a Web Worker instance."))}}};var kr=typeof XMLHttpRequest!="undefined"&&XMLHttpRequest!==null;function Uu(r,t,e){let i=new XMLHttpRequest;i.open("GET",r,!0);let n=!0;switch(t){case"buffer":i.responseType="arraybuffer";break;case"json":try{i.responseType="json",n=i.responseType==="json"}catch(s){n=!1}break;default:return e(new f(22,"Invalid download type: "+t))}i.onreadystatechange=function(s){if(i.readyState===4)if(i.status===200)switch(t){case"buffer":return e(null,i.response?g.from(i.response):_e());case"json":return n?e(null,i.response):e(null,JSON.parse(i.responseText))}else return e(new f(5,`XHR error: response returned code ${i.status}`))},i.send()}function zu(r,t){let e=new XMLHttpRequest;e.open("GET",r,!1);let i=null,n=null;if(e.overrideMimeType("text/plain; charset=x-user-defined"),e.onreadystatechange=function(s){if(e.readyState===4)if(e.status===200)switch(t){case"buffer":let a=e.responseText;i=g.alloc(a.length);for(let o=0;o<a.length;o++)i[o]=a.charCodeAt(o);return;case"json":i=JSON.parse(e.responseText);return}else{n=new f(5,`XHR error: response returned code ${e.status}`);return}},e.send(),n)throw n;return i}function Hu(r,t){let e=new XMLHttpRequest;switch(e.open("GET",r,!1),t){case"buffer":e.responseType="arraybuffer";break;case"json":break;default:throw new f(22,"Invalid download type: "+t)}let i,n;if(e.onreadystatechange=function(s){if(e.readyState===4)if(e.status===200)switch(t){case"buffer":i=g.from(e.response);break;case"json":i=JSON.parse(e.response);break}else n=new f(5,`XHR error: response returned code ${e.status}`)},e.send(),n)throw n;return i}function Lo(r,t,e){let i=new XMLHttpRequest;i.open("HEAD",t,r),i.onreadystatechange=function(n){if(i.readyState===4)if(i.status===200)try{return e(null,parseInt(i.getResponseHeader("Content-Length")||"-1",10))}catch(s){return e(new f(5,"XHR HEAD error: Could not read content-length."))}else return e(new f(5,`XHR HEAD error: response returned code ${i.status}`))},i.send()}var rs=Uu,Mo=Tn&&typeof Blob!="undefined"?Hu:zu;function Po(r){let t=-1;return Lo(!1,r,function(e,i){if(e)throw e;t=i}),t}function Uo(r,t){Lo(!0,r,t)}var is=typeof fetch!="undefined"&&fetch!==null;function zo(r,t,e){let i;try{i=fetch(r)}catch(n){return e(new f(22,n.message))}i.then(n=>{if(n.ok)switch(t){case"buffer":n.arrayBuffer().then(s=>e(null,g.from(s))).catch(s=>e(new f(5,s.message)));break;case"json":n.json().then(s=>e(null,s)).catch(s=>e(new f(5,s.message)));break;default:e(new f(22,"Invalid download type: "+t))}else return e(new f(5,`fetch error: response returned code ${n.status}`))}).catch(n=>e(new f(5,n.message)))}function Ho(r,t){fetch(r,{method:"HEAD"}).then(e=>e.ok?t(null,parseInt(e.headers.get("Content-Length")||"-1",10)):t(new f(5,`fetch HEAD error: response returned code ${e.status}`))).catch(e=>t(new f(5,e.message)))}var tt=class{static fromListing(t){let e=new tt,i=new et;e._index["/"]=i;let n=[["",t,i]];for(;n.length>0;){let s,a=n.pop(),o=a[0],c=a[1],l=a[2];for(let u in c)if(Object.prototype.hasOwnProperty.call(c,u)){let d=c[u],h=`${o}/${u}`;d?(e._index[h]=s=new et,n.push([h,d,s])):s=new Br(new C(32768,-1,365)),l&&(l._ls[u]=s)}}return e}constructor(){this._index={},this.addPath("/",new et)}fileIterator(t){for(let e in this._index)if(Object.prototype.hasOwnProperty.call(this._index,e)){let i=this._index[e],n=i.getListing();for(let s of n){let a=i.getItem(s);Oe(a)&&t(a.getData())}}}addPath(t,e){if(!e)throw new Error("Inode must be specified");if(t[0]!=="/")throw new Error("Path must be absolute, got: "+t);if(Object.prototype.hasOwnProperty.call(this._index,t))return this._index[t]===e;let i=this._split_path(t),n=i[0],s=i[1],a=this._index[n];return a===void 0&&t!=="/"&&(a=new et,!this.addPath(n,a))||t!=="/"&&!a.addItem(s,e)?!1:(fe(e)&&(this._index[t]=e),!0)}addPathFast(t,e){let i=t.lastIndexOf("/"),n=i===0?"/":t.substring(0,i),s=t.substring(i+1),a=this._index[n];return a===void 0&&(a=new et,this.addPathFast(n,a)),a.addItem(s,e)?(e.isDir()&&(this._index[t]=e),!0):!1}removePath(t){let e=this._split_path(t),i=e[0],n=e[1],s=this._index[i];if(s===void 0)return null;let a=s.remItem(n);if(a===null)return null;if(fe(a)){let o=a.getListing();for(let c of o)this.removePath(t+"/"+c);t!=="/"&&delete this._index[t]}return a}ls(t){let e=this._index[t];return e===void 0?null:e.getListing()}getInode(t){let e=this._split_path(t),i=e[0],n=e[1],s=this._index[i];return s===void 0?null:i===t?s:s.getItem(n)}_split_path(t){let e=B(t),i=t.substr(e.length+(e==="/"?0:1));return[e,i]}},Br=class{constructor(t){this.data=t}isFile(){return!0}isDir(){return!1}getData(){return this.data}setData(t){this.data=t}toStats(){return new C(32768,4096,438)}},et=class{constructor(t=null){this.data=t;this._ls={}}isFile(){return!1}isDir(){return!0}getData(){return this.data}getStats(){return new C(16384,4096,365)}toStats(){return this.getStats()}getListing(){return Object.keys(this._ls)}getItem(t){let e=this._ls[t];return e||null}addItem(t,e){return t in this._ls?!1:(this._ls[t]=e,!0)}remItem(t){let e=this._ls[t];return e===void 0?null:(delete this._ls[t],e)}};function Oe(r){return!!r&&r.isFile()}function fe(r){return!!r&&r.isDir()}function ju(r,t,e){try{e(null,r.toString(t))}catch(i){e(i)}}function jo(){throw new f(95,"Synchronous HTTP download methods are not available in this environment.")}var Or=class extends ie{constructor(e,i="",n=!1){super();i.length>0&&i.charAt(i.length-1)!=="/"&&(i=i+"/"),this.prefixUrl=i,this._index=tt.fromListing(e),is&&(!n||!kr)?(this._requestFileAsyncInternal=zo,this._requestFileSizeAsyncInternal=Ho):(this._requestFileAsyncInternal=rs,this._requestFileSizeAsyncInternal=Uo),kr?(this._requestFileSyncInternal=Mo,this._requestFileSizeSyncInternal=Po):(this._requestFileSyncInternal=jo,this._requestFileSizeSyncInternal=jo)}static Create(e,i){e.index===void 0&&(e.index="index.json"),typeof e.index=="string"?rs(e.index,"json",(n,s)=>{n?i(n):i(null,new Or(s,e.baseUrl))}):i(null,new Or(e.index,e.baseUrl))}static CreateAsync(e){return new Promise((i,n)=>{this.Create(e,(s,a)=>{s||!a?n(s):i(a)})})}static isAvailable(){return kr||is}empty(){this._index.fileIterator(function(e){e.fileData=null})}getName(){return Or.Name}diskSpace(e,i){i(0,0)}isReadOnly(){return!0}supportsLinks(){return!1}supportsProps(){return!1}supportsSynch(){return kr}preloadFile(e,i){let n=this._index.getInode(e);if(Oe(n)){if(n===null)throw f.ENOENT(e);let s=n.getData();s.size=i.length,s.fileData=i}else throw f.EISDIR(e)}stat(e,i,n,s){let a=this._index.getInode(e);if(a===null)return s(f.ENOENT(e));let o;if(!a.toStats().hasAccess(4,n))return s(f.EACCES(e));Oe(a)?(o=a.getData(),o.size<0?this._requestFileSizeAsync(e,function(c,l){if(c)return s(c);o.size=l,s(null,C.clone(o))}):s(null,C.clone(o))):fe(a)?(o=a.getStats(),s(null,o)):s(f.FileError(22,e))}statSync(e,i,n){let s=this._index.getInode(e);if(s===null)throw f.ENOENT(e);if(!s.toStats().hasAccess(4,n))throw f.EACCES(e);let a;if(Oe(s))a=s.getData(),a.size<0&&(a.size=this._requestFileSizeSync(e));else if(fe(s))a=s.getStats();else throw f.FileError(22,e);return a}open(e,i,n,s,a){if(i.isWriteable())return a(new f(1,e));let o=this,c=this._index.getInode(e);if(c===null)return a(f.ENOENT(e));if(!c.toStats().hasAccess(i.getMode(),s))return a(f.EACCES(e));if(Oe(c)||fe(c))switch(i.pathExistsAction()){case 1:case 2:return a(f.EEXIST(e));case 0:if(fe(c)){let u=c.getStats();return a(null,new ve(o,e,i,u,u.fileData||void 0))}let l=c.getData();if(l.fileData)return a(null,new ve(o,e,i,C.clone(l),l.fileData));this._requestFileAsync(e,"buffer",function(u,d){return u?a(u):(l.size=d.length,l.fileData=d,a(null,new ve(o,e,i,C.clone(l),d)))});break;default:return a(new f(22,"Invalid FileMode object."))}else return a(f.EPERM(e))}openSync(e,i,n,s){if(i.isWriteable())throw new f(1,e);let a=this._index.getInode(e);if(a===null)throw f.ENOENT(e);if(!a.toStats().hasAccess(i.getMode(),s))throw f.EACCES(e);if(Oe(a)||fe(a))switch(i.pathExistsAction()){case 1:case 2:throw f.EEXIST(e);case 0:if(fe(a)){let l=a.getStats();return new ve(this,e,i,l,l.fileData||void 0)}let o=a.getData();if(o.fileData)return new ve(this,e,i,C.clone(o),o.fileData);let c=this._requestFileSync(e,"buffer");return o.size=c.length,o.fileData=c,new ve(this,e,i,C.clone(o),c);default:throw new f(22,"Invalid FileMode object.")}else throw f.EPERM(e)}readdir(e,i,n){try{n(null,this.readdirSync(e,i))}catch(s){n(s)}}readdirSync(e,i){let n=this._index.getInode(e);if(n===null)throw f.ENOENT(e);if(n.toStats().hasAccess(4,i)){if(fe(n))return n.getListing();throw f.ENOTDIR(e)}else throw f.EACCES(e)}readFile(e,i,n,s,a){let o=a;this.open(e,n,420,s,function(c,l){if(c)return a(c);a=function(h,p){l.close(function(m){return h||(h=m),o(h,p)})};let d=l.getBuffer();i===null?a(c,Ve(d)):ju(d,i,a)})}readFileSync(e,i,n,s){let a=this.openSync(e,n,420,s);try{let c=a.getBuffer();return i===null?Ve(c):c.toString(i)}finally{a.closeSync()}}_getHTTPPath(e){return e.charAt(0)==="/"&&(e=e.slice(1)),this.prefixUrl+e}_requestFileAsync(e,i,n){this._requestFileAsyncInternal(this._getHTTPPath(e),i,n)}_requestFileSync(e,i){return this._requestFileSyncInternal(this._getHTTPPath(e),i)}_requestFileSizeAsync(e,i){this._requestFileSizeAsyncInternal(this._getHTTPPath(e),i)}_requestFileSizeSync(e){return this._requestFileSizeSyncInternal(this._getHTTPPath(e))}},rt=Or;rt.Name="HTTPRequest",rt.Options={index:{type:["string","object"],optional:!0,description:"URL to a file index as a JSON file or the file index object itself, generated with the make_http_index script. Defaults to `index.json`."},baseUrl:{type:"string",optional:!0,description:"Used as the URL prefix for fetched files. Default: Fetch files relative to the index."},preferXHR:{type:"boolean",optional:!0,description:"Whether to prefer XmlHttpRequest or fetch for async operations if both are available. Default: false"}};var Oi=class{static str2byte(t,e){let i=t.length>e.length?e.length:t.length;for(let n=0;n<i;n++){let s=t.charCodeAt(n);if(s>127){let a=Oi.extendedChars.indexOf(t.charAt(n));a>-1&&(s=a+128)}e[s]=n}return i}static byte2str(t){let e=new Array(t.length);for(let i=0;i<t.length;i++){let n=t[i];n>127?e[i]=Oi.extendedChars[n-128]:e[i]=String.fromCharCode(n)}return e.join("")}static byteLength(t){return t.length}},ar=Oi;ar.extendedChars=["\xC7","\xFC","\xE9","\xE2","\xE4","\xE0","\xE5","\xE7","\xEA","\xEB","\xE8","\xEF","\xEE","\xEC","\xC4","\xC5","\xC9","\xE6","\xC6","\xF4","\xF6","\xF2","\xFB","\xF9","\xFF","\xD6","\xDC","\xF8","\xA3","\xD8","\xD7","\u0192","\xE1","\xED","\xF3","\xFA","\xF1","\xD1","\xAA","\xBA","\xBF","\xAE","\xAC","\xBD","\xBC","\xA1","\xAB","\xBB","_","_","_","\xA6","\xA6","\xC1","\xC2","\xC0","\xA9","\xA6","\xA6","+","+","\xA2","\xA5","+","+","-","-","+","-","+","\xE3","\xC3","+","+","-","-","\xA6","-","+","\xA4","\xF0","\xD0","\xCA","\xCB","\xC8","i","\xCD","\xCE","\xCF","+","+","_","_","\xA6","\xCC","_","\xD3","\xDF","\xD4","\xD2","\xF5","\xD5","\xB5","\xFE","\xDE","\xDA","\xDB","\xD9","\xFD","\xDD","\xAF","\xB4","\xAD","\xB1","_","\xBE","\xB6","\xA7","\xF7","\xB8","\xB0","\xA8","\xB7","\xB9","\xB3","\xB2","_"," "];var ns;function _t(){}_t.prototype=Object.create(null);function M(){M.init.call(this)}var vt=M;M.EventEmitter=M;M.usingDomains=!1;M.prototype.domain=void 0;M.prototype._events=void 0;M.prototype._maxListeners=void 0;M.defaultMaxListeners=10;M.init=function(){this.domain=null,M.usingDomains&&ns.active&&!(this instanceof ns.Domain)&&(this.domain=ns.active),(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new _t,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};M.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function Zo(r){return r._maxListeners===void 0?M.defaultMaxListeners:r._maxListeners}M.prototype.getMaxListeners=function(){return Zo(this)};function Zu(r,t,e){if(t)r.call(e);else for(var i=r.length,n=Ir(r,i),s=0;s<i;++s)n[s].call(e)}function Vu(r,t,e,i){if(t)r.call(e,i);else for(var n=r.length,s=Ir(r,n),a=0;a<n;++a)s[a].call(e,i)}function Wu(r,t,e,i,n){if(t)r.call(e,i,n);else for(var s=r.length,a=Ir(r,s),o=0;o<s;++o)a[o].call(e,i,n)}function qu(r,t,e,i,n,s){if(t)r.call(e,i,n,s);else for(var a=r.length,o=Ir(r,a),c=0;c<a;++c)o[c].call(e,i,n,s)}function Yu(r,t,e,i){if(t)r.apply(e,i);else for(var n=r.length,s=Ir(r,n),a=0;a<n;++a)s[a].apply(e,i)}M.prototype.emit=function(t){var e,i,n,s,a,o,c,l=!1,u=t==="error";if(o=this._events,o)u=u&&o.error==null;else if(!u)return!1;if(c=this.domain,u){if(e=arguments[1],c)e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=c,e.domainThrown=!1,c.emit("error",e);else{if(e instanceof Error)throw e;var d=new Error('Uncaught, unspecified "error" event. ('+e+")");throw d.context=e,d}return!1}if(i=o[t],!i)return!1;var h=typeof i=="function";switch(n=arguments.length,n){case 1:Zu(i,h,this);break;case 2:Vu(i,h,this,arguments[1]);break;case 3:Wu(i,h,this,arguments[1],arguments[2]);break;case 4:qu(i,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(s=new Array(n-1),a=1;a<n;a++)s[a-1]=arguments[a];Yu(i,h,this,s)}return l&&c.exit(),!0};function Vo(r,t,e,i){var n,s,a;if(typeof e!="function")throw new TypeError('"listener" argument must be a function');if(s=r._events,s?(s.newListener&&(r.emit("newListener",t,e.listener?e.listener:e),s=r._events),a=s[t]):(s=r._events=new _t,r._eventsCount=0),!a)a=s[t]=e,++r._eventsCount;else if(typeof a=="function"?a=s[t]=i?[e,a]:[a,e]:i?a.unshift(e):a.push(e),!a.warned&&(n=Zo(r),n&&n>0&&a.length>n)){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=r,o.type=t,o.count=a.length,Ku(o)}return r}function Ku(r){typeof console.warn=="function"?console.warn(r):console.log(r)}M.prototype.addListener=function(t,e){return Vo(this,t,e,!1)};M.prototype.on=M.prototype.addListener;M.prototype.prependListener=function(t,e){return Vo(this,t,e,!0)};function Wo(r,t,e){var i=!1;function n(){r.removeListener(t,n),i||(i=!0,e.apply(r,arguments))}return n.listener=e,n}M.prototype.once=function(t,e){if(typeof e!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,Wo(this,t,e)),this};M.prototype.prependOnceListener=function(t,e){if(typeof e!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,Wo(this,t,e)),this};M.prototype.removeListener=function(t,e){var i,n,s,a,o;if(typeof e!="function")throw new TypeError('"listener" argument must be a function');if(n=this._events,!n)return this;if(i=n[t],!i)return this;if(i===e||i.listener&&i.listener===e)--this._eventsCount===0?this._events=new _t:(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if(typeof i!="function"){for(s=-1,a=i.length;a-- >0;)if(i[a]===e||i[a].listener&&i[a].listener===e){o=i[a].listener,s=a;break}if(s<0)return this;if(i.length===1){if(i[0]=void 0,--this._eventsCount===0)return this._events=new _t,this;delete n[t]}else Xu(i,s);n.removeListener&&this.emit("removeListener",t,o||e)}return this};M.prototype.removeAllListeners=function(t){var e,i;if(i=this._events,!i)return this;if(!i.removeListener)return arguments.length===0?(this._events=new _t,this._eventsCount=0):i[t]&&(--this._eventsCount===0?this._events=new _t:delete i[t]),this;if(arguments.length===0){for(var n=Object.keys(i),s=0,a;s<n.length;++s)a=n[s],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=new _t,this._eventsCount=0,this}if(e=i[t],typeof e=="function")this.removeListener(t,e);else if(e)do this.removeListener(t,e[e.length-1]);while(e[0]);return this};M.prototype.listeners=function(t){var e,i,n=this._events;return n?(e=n[t],e?typeof e=="function"?i=[e.listener||e]:i=Gu(e):i=[]):i=[],i};M.listenerCount=function(r,t){return typeof r.listenerCount=="function"?r.listenerCount(t):qo.call(r,t)};M.prototype.listenerCount=qo;function qo(r){var t=this._events;if(t){var e=t[r];if(typeof e=="function")return 1;if(e)return e.length}return 0}M.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function Xu(r,t){for(var e=t,i=e+1,n=r.length;i<n;e+=1,i+=1)r[e]=r[i];r.pop()}function Ir(r,t){for(var e=new Array(t);t--;)e[t]=r[t];return e}function Gu(r){for(var t=new Array(r.length),e=0;e<t.length;++e)t[e]=r[e].listener||r[e];return t}var ss;typeof Object.create=="function"?ss=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:ss=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t};var X=ss;var $u=/%[sdj%]/g;function Ju(r){if(!ps(r)){for(var t=[],e=0;e<arguments.length;e++)t.push(Et(arguments[e]));return t.join(" ")}for(var e=1,i=arguments,n=i.length,s=String(r).replace($u,function(o){if(o==="%%")return"%";if(e>=n)return o;switch(o){case"%s":return String(i[e++]);case"%d":return Number(i[e++]);case"%j":try{return JSON.stringify(i[e++])}catch(c){return"[Circular]"}default:return o}}),a=i[e];e<n;a=i[++e])hs(a)||!Tr(a)?s+=" "+a:s+=" "+Et(a);return s}function ds(r,t){if(wt(globalThis.process))return function(){return ds(r,t).apply(this,arguments)};if(ir.noDeprecation===!0)return r;var e=!1;function i(){if(!e){if(ir.throwDeprecation)throw new Error(t);ir.traceDeprecation?console.trace(t):console.error(t),e=!0}return r.apply(this,arguments)}return i}var Ii={},as;function Ko(r){if(wt(as)&&(as=ir.env.NODE_DEBUG||""),r=r.toUpperCase(),!Ii[r])if(new RegExp("\\b"+r+"\\b","i").test(as)){var t=0;Ii[r]=function(){var e=Ju.apply(null,arguments);console.error("%s %d: %s",r,t,e)}}else Ii[r]=function(){};return Ii[r]}function Et(r,t){var e={seen:[],stylize:ef};return arguments.length>=3&&(e.depth=arguments[2]),arguments.length>=4&&(e.colors=arguments[3]),Xo(t)?e.showHidden=t:t&&lf(e,t),wt(e.showHidden)&&(e.showHidden=!1),wt(e.depth)&&(e.depth=2),wt(e.colors)&&(e.colors=!1),wt(e.customInspect)&&(e.customInspect=!0),e.colors&&(e.stylize=Qu),Ti(e,r,e.depth)}Et.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Et.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Qu(r,t){var e=Et.styles[t];return e?"\x1B["+Et.colors[e][0]+"m"+r+"\x1B["+Et.colors[e][1]+"m":r}function ef(r,t){return r}function tf(r){var t={};return r.forEach(function(e,i){t[e]=!0}),t}function Ti(r,t,e){if(r.customInspect&&t&&us(t.inspect)&&t.inspect!==Et&&!(t.constructor&&t.constructor.prototype===t)){var i=t.inspect(e,r);return ps(i)||(i=Ti(r,i,e)),i}var n=rf(r,t);if(n)return n;var s=Object.keys(t),a=tf(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(t)),cs(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return os(t);if(s.length===0){if(us(t)){var o=t.name?": "+t.name:"";return r.stylize("[Function"+o+"]","special")}if(ls(t))return r.stylize(RegExp.prototype.toString.call(t),"regexp");if(Yo(t))return r.stylize(Date.prototype.toString.call(t),"date");if(cs(t))return os(t)}var c="",l=!1,u=["{","}"];if(af(t)&&(l=!0,u=["[","]"]),us(t)){var d=t.name?": "+t.name:"";c=" [Function"+d+"]"}if(ls(t)&&(c=" "+RegExp.prototype.toString.call(t)),Yo(t)&&(c=" "+Date.prototype.toUTCString.call(t)),cs(t)&&(c=" "+os(t)),s.length===0&&(!l||t.length==0))return u[0]+c+u[1];if(e<0)return ls(t)?r.stylize(RegExp.prototype.toString.call(t),"regexp"):r.stylize("[Object]","special");r.seen.push(t);var h;return l?h=nf(r,t,e,a,s):h=s.map(function(p){return fs(r,t,e,a,p,l)}),r.seen.pop(),sf(h,c,u)}function rf(r,t){if(wt(t))return r.stylize("undefined","undefined");if(ps(t)){var e="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(e,"string")}if(of(t))return r.stylize(""+t,"number");if(Xo(t))return r.stylize(""+t,"boolean");if(hs(t))return r.stylize("null","null")}function os(r){return"["+Error.prototype.toString.call(r)+"]"}function nf(r,t,e,i,n){for(var s=[],a=0,o=t.length;a<o;++a)Go(t,String(a))?s.push(fs(r,t,e,i,String(a),!0)):s.push("");return n.forEach(function(c){c.match(/^\d+$/)||s.push(fs(r,t,e,i,c,!0))}),s}function fs(r,t,e,i,n,s){var a,o,c;if(c=Object.getOwnPropertyDescriptor(t,n)||{value:t[n]},c.get?c.set?o=r.stylize("[Getter/Setter]","special"):o=r.stylize("[Getter]","special"):c.set&&(o=r.stylize("[Setter]","special")),Go(i,n)||(a="["+n+"]"),o||(r.seen.indexOf(c.value)<0?(hs(e)?o=Ti(r,c.value,null):o=Ti(r,c.value,e-1),o.indexOf(`
`)>-1&&(s?o=o.split(`
`).map(function(l){return"  "+l}).join(`
`).substr(2):o=`
`+o.split(`
`).map(function(l){return"   "+l}).join(`
`))):o=r.stylize("[Circular]","special")),wt(a)){if(s&&n.match(/^\d+$/))return o;a=JSON.stringify(""+n),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=r.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=r.stylize(a,"string"))}return a+": "+o}function sf(r,t,e){var i=0,n=r.reduce(function(s,a){return i++,a.indexOf(`
`)>=0&&i++,s+a.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?e[0]+(t===""?"":t+`
 `)+" "+r.join(`,
  `)+" "+e[1]:e[0]+t+" "+r.join(", ")+" "+e[1]}function af(r){return Array.isArray(r)}function Xo(r){return typeof r=="boolean"}function hs(r){return r===null}function of(r){return typeof r=="number"}function ps(r){return typeof r=="string"}function wt(r){return r===void 0}function ls(r){return Tr(r)&&gs(r)==="[object RegExp]"}function Tr(r){return typeof r=="object"&&r!==null}function Yo(r){return Tr(r)&&gs(r)==="[object Date]"}function cs(r){return Tr(r)&&(gs(r)==="[object Error]"||r instanceof Error)}function us(r){return typeof r=="function"}function gs(r){return Object.prototype.toString.call(r)}function lf(r,t){if(!t||!Tr(t))return r;for(var e=Object.keys(t),i=e.length;i--;)r[e[i]]=t[e[i]];return r}function Go(r,t){return Object.prototype.hasOwnProperty.call(r,t)}var $o=Zt;function Zt(){this.head=null,this.tail=null,this.length=0}Zt.prototype.push=function(r){var t={data:r,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length};Zt.prototype.unshift=function(r){var t={data:r,next:this.head};this.length===0&&(this.tail=t),this.head=t,++this.length};Zt.prototype.shift=function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}};Zt.prototype.clear=function(){this.head=this.tail=null,this.length=0};Zt.prototype.join=function(r){if(this.length===0)return"";for(var t=this.head,e=""+t.data;t=t.next;)e+=r+t.data;return e};Zt.prototype.concat=function(r){if(this.length===0)return g.alloc(0);if(this.length===1)return this.head.data;for(var t=g.allocUnsafe(r>>>0),e=this.head,i=0;e;)e.data.copy(t,i),i+=e.data.length,e=e.next;return t};var cf=g.isEncoding||function(r){switch(r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function uf(r){if(r&&!cf(r))throw new Error("Unknown encoding: "+r)}function or(r){switch(this.encoding=(r||"utf8").toLowerCase().replace(/[-_]/,""),uf(r),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=df;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=hf;break;default:this.write=ff;return}this.charBuffer=new g(6),this.charReceived=0,this.charLength=0}or.prototype.write=function(r){for(var t="";this.charLength;){var e=r.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:r.length;if(r.copy(this.charBuffer,this.charReceived,0,e),this.charReceived+=e,this.charReceived<this.charLength)return"";r=r.slice(e,r.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var n=t.charCodeAt(t.length-1);if(n>=55296&&n<=56319){this.charLength+=this.surrogateSize,t="";continue}if(this.charReceived=this.charLength=0,r.length===0)return t;break}this.detectIncompleteChar(r);var i=r.length;this.charLength&&(r.copy(this.charBuffer,0,r.length-this.charReceived,i),i-=this.charReceived),t+=r.toString(this.encoding,0,i);var i=t.length-1,n=t.charCodeAt(i);if(n>=55296&&n<=56319){var s=this.surrogateSize;return this.charLength+=s,this.charReceived+=s,this.charBuffer.copy(this.charBuffer,s,0,s),r.copy(this.charBuffer,0,0,s),t.substring(0,i)}return t};or.prototype.detectIncompleteChar=function(r){for(var t=r.length>=3?3:r.length;t>0;t--){var e=r[r.length-t];if(t==1&&e>>5==6){this.charLength=2;break}if(t<=2&&e>>4==14){this.charLength=3;break}if(t<=3&&e>>3==30){this.charLength=4;break}}this.charReceived=t};or.prototype.end=function(r){var t="";if(r&&r.length&&(t=this.write(r)),this.charReceived){var e=this.charReceived,i=this.charBuffer,n=this.encoding;t+=i.slice(0,e).toString(n)}return t};function ff(r){return r.toString(this.encoding)}function df(r){this.charReceived=r.length%2,this.charLength=this.charReceived?2:0}function hf(r){this.charReceived=r.length%3,this.charLength=this.charReceived?3:0}j.ReadableState=tl;var U=Ko("stream");X(j,vt);function pf(r,t,e){if(typeof r.prependListener=="function")return r.prependListener(t,e);!r._events||!r._events[t]?r.on(t,e):Array.isArray(r._events[t])?r._events[t].unshift(e):r._events[t]=[e,r._events[t]]}function gf(r,t){return r.listeners(t).length}function tl(r,t){r=r||{},this.objectMode=!!r.objectMode,t instanceof he&&(this.objectMode=this.objectMode||!!r.readableObjectMode);var e=r.highWaterMark,i=this.objectMode?16:16*1024;this.highWaterMark=e||e===0?e:i,this.highWaterMark=~~this.highWaterMark,this.buffer=new $o,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(this.decoder=new or(r.encoding),this.encoding=r.encoding)}function j(r){if(!(this instanceof j))return new j(r);this._readableState=new tl(r,this),this.readable=!0,r&&typeof r.read=="function"&&(this._read=r.read),vt.call(this)}j.prototype.push=function(r,t){var e=this._readableState;return!e.objectMode&&typeof r=="string"&&(t=t||e.defaultEncoding,t!==e.encoding&&(r=Buffer.from(r,t),t="")),rl(this,e,r,t,!1)};j.prototype.unshift=function(r){var t=this._readableState;return rl(this,t,r,"",!0)};j.prototype.isPaused=function(){return this._readableState.flowing===!1};function rl(r,t,e,i,n){var s=yf(t,e);if(s)r.emit("error",s);else if(e===null)t.reading=!1,Sf(r,t);else if(t.objectMode||e&&e.length>0)if(t.ended&&!n){var a=new Error("stream.push() after EOF");r.emit("error",a)}else if(t.endEmitted&&n){var o=new Error("stream.unshift() after end event");r.emit("error",o)}else{var c;t.decoder&&!n&&!i&&(e=t.decoder.write(e),c=!t.objectMode&&e.length===0),n||(t.reading=!1),c||(t.flowing&&t.length===0&&!t.sync?(r.emit("data",e),r.read(0)):(t.length+=t.objectMode?1:e.length,n?t.buffer.unshift(e):t.buffer.push(e),t.needReadable&&Di(r))),_f(r,t)}else n||(t.reading=!1);return mf(t)}function mf(r){return!r.ended&&(r.needReadable||r.length<r.highWaterMark||r.length===0)}j.prototype.setEncoding=function(r){return this._readableState.decoder=new or(r),this._readableState.encoding=r,this};var Jo=8388608;function bf(r){return r>=Jo?r=Jo:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r}function Qo(r,t){return r<=0||t.length===0&&t.ended?0:t.objectMode?1:r!==r?t.flowing&&t.length?t.buffer.head.data.length:t.length:(r>t.highWaterMark&&(t.highWaterMark=bf(r)),r<=t.length?r:t.ended?t.length:(t.needReadable=!0,0))}j.prototype.read=function(r){U("read",r),r=parseInt(r,10);var t=this._readableState,e=r;if(r!==0&&(t.emittedReadable=!1),r===0&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return U("read: emitReadable",t.length,t.ended),t.length===0&&t.ended?ms(this):Di(this),null;if(r=Qo(r,t),r===0&&t.ended)return t.length===0&&ms(this),null;var i=t.needReadable;U("need readable",i),(t.length===0||t.length-r<t.highWaterMark)&&(i=!0,U("length less than watermark",i)),t.ended||t.reading?(i=!1,U("reading or ended",i)):i&&(U("do read"),t.reading=!0,t.sync=!0,t.length===0&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(r=Qo(e,t)));var n;return r>0?n=il(r,t):n=null,n===null?(t.needReadable=!0,r=0):t.length-=r,t.length===0&&(t.ended||(t.needReadable=!0),e!==r&&t.ended&&ms(this)),n!==null&&this.emit("data",n),n};function yf(r,t){var e=null;return!Buffer.isBuffer(t)&&typeof t!="string"&&t!==null&&t!==void 0&&!r.objectMode&&(e=new TypeError("Invalid non-string/buffer chunk")),e}function Sf(r,t){if(!t.ended){if(t.decoder){var e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,Di(r)}}function Di(r){var t=r._readableState;t.needReadable=!1,t.emittedReadable||(U("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?ue(el,r):el(r))}function el(r){U("emit readable"),r.emit("readable"),bs(r)}function _f(r,t){t.readingMore||(t.readingMore=!0,ue(vf,r,t))}function vf(r,t){for(var e=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(U("maybeReadMore read 0"),r.read(0),e!==t.length);)e=t.length;t.readingMore=!1}j.prototype._read=function(r){this.emit("error",new Error("not implemented"))};j.prototype.pipe=function(r,t){var e=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=r;break;case 1:i.pipes=[i.pipes,r];break;default:i.pipes.push(r);break}i.pipesCount+=1,U("pipe count=%d opts=%j",i.pipesCount,t);var n=!t||t.end!==!1,s=n?o:u;i.endEmitted?ue(s):e.once("end",s),r.on("unpipe",a);function a(S){U("onunpipe"),S===e&&u()}function o(){U("onend"),r.end()}var c=wf(e);r.on("drain",c);var l=!1;function u(){U("cleanup"),r.removeListener("close",m),r.removeListener("finish",y),r.removeListener("drain",c),r.removeListener("error",p),r.removeListener("unpipe",a),e.removeListener("end",o),e.removeListener("end",u),e.removeListener("data",h),l=!0,i.awaitDrain&&(!r._writableState||r._writableState.needDrain)&&c()}var d=!1;e.on("data",h);function h(S){U("ondata"),d=!1;var w=r.write(S);w===!1&&!d&&((i.pipesCount===1&&i.pipes===r||i.pipesCount>1&&nl(i.pipes,r)!==-1)&&!l&&(U("false write response, pause",e._readableState.awaitDrain),e._readableState.awaitDrain++,d=!0),e.pause())}function p(S){U("onerror",S),b(),r.removeListener("error",p),gf(r,"error")===0&&r.emit("error",S)}pf(r,"error",p);function m(){r.removeListener("finish",y),b()}r.once("close",m);function y(){U("onfinish"),r.removeListener("close",m),b()}r.once("finish",y);function b(){U("unpipe"),e.unpipe(r)}return r.emit("pipe",e),i.flowing||(U("pipe resume"),e.resume()),r};function wf(r){return function(){var t=r._readableState;U("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,t.awaitDrain===0&&r.listeners("data").length&&(t.flowing=!0,bs(r))}}j.prototype.unpipe=function(r){var t=this._readableState;if(t.pipesCount===0)return this;if(t.pipesCount===1)return r&&r!==t.pipes?this:(r||(r=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,r&&r.emit("unpipe",this),this);if(!r){var e=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var n=0;n<i;n++)e[n].emit("unpipe",this);return this}var s=nl(t.pipes,r);return s===-1?this:(t.pipes.splice(s,1),t.pipesCount-=1,t.pipesCount===1&&(t.pipes=t.pipes[0]),r.emit("unpipe",this),this)};j.prototype.on=function(r,t){var e=vt.prototype.on.call(this,r,t);if(r==="data")this._readableState.flowing!==!1&&this.resume();else if(r==="readable"){var i=this._readableState;!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&Di(this,i):ue(Ef,this))}return e};j.prototype.addListener=j.prototype.on;function Ef(r){U("readable nexttick read 0"),r.read(0)}j.prototype.resume=function(){var r=this._readableState;return r.flowing||(U("resume"),r.flowing=!0,Ff(this,r)),this};function Ff(r,t){t.resumeScheduled||(t.resumeScheduled=!0,ue(Cf,r,t))}function Cf(r,t){t.reading||(U("resume read 0"),r.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,r.emit("resume"),bs(r),t.flowing&&!t.reading&&r.read(0)}j.prototype.pause=function(){return U("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(U("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function bs(r){var t=r._readableState;for(U("flow",t.flowing);t.flowing&&r.read()!==null;);}j.prototype.wrap=function(r){var t=this._readableState,e=!1,i=this;r.on("end",function(){if(U("wrapped end"),t.decoder&&!t.ended){var a=t.decoder.end();a&&a.length&&i.push(a)}i.push(null)}),r.on("data",function(a){if(U("wrapped data"),t.decoder&&(a=t.decoder.write(a)),!(t.objectMode&&a==null)&&!(!t.objectMode&&(!a||!a.length))){var o=i.push(a);o||(e=!0,r.pause())}});for(var n in r)this[n]===void 0&&typeof r[n]=="function"&&(this[n]=function(a){return function(){return r[a].apply(r,arguments)}}(n));var s=["error","close","destroy","pause","resume"];return Of(s,function(a){r.on(a,i.emit.bind(i,a))}),i._read=function(a){U("wrapped _read",a),e&&(e=!1,r.resume())},i};j._fromList=il;function il(r,t){if(t.length===0)return null;var e;return t.objectMode?e=t.buffer.shift():!r||r>=t.length?(t.decoder?e=t.buffer.join(""):t.buffer.length===1?e=t.buffer.head.data:e=t.buffer.concat(t.length),t.buffer.clear()):e=xf(r,t.buffer,t.decoder),e}function xf(r,t,e){var i;return r<t.head.data.length?(i=t.head.data.slice(0,r),t.head.data=t.head.data.slice(r)):r===t.head.data.length?i=t.shift():i=e?Af(r,t):kf(r,t),i}function Af(r,t){var e=t.head,i=1,n=e.data;for(r-=n.length;e=e.next;){var s=e.data,a=r>s.length?s.length:r;if(a===s.length?n+=s:n+=s.slice(0,r),r-=a,r===0){a===s.length?(++i,e.next?t.head=e.next:t.head=t.tail=null):(t.head=e,e.data=s.slice(a));break}++i}return t.length-=i,n}function kf(r,t){var e=Buffer.allocUnsafe(r),i=t.head,n=1;for(i.data.copy(e),r-=i.data.length;i=i.next;){var s=i.data,a=r>s.length?s.length:r;if(s.copy(e,e.length-r,0,a),r-=a,r===0){a===s.length?(++n,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=s.slice(a));break}++n}return t.length-=n,e}function ms(r){var t=r._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,ue(Bf,t,r))}function Bf(r,t){!r.endEmitted&&r.length===0&&(r.endEmitted=!0,t.readable=!1,t.emit("end"))}function Of(r,t){for(var e=0,i=r.length;e<i;e++)t(r[e],e)}function nl(r,t){for(var e=0,i=r.length;e<i;e++)if(r[e]===t)return e;return-1}oe.WritableState=Ss;X(oe,M);function If(){}function Tf(r,t,e){this.chunk=r,this.encoding=t,this.callback=e,this.next=null}function Ss(r,t){Object.defineProperty(this,"buffer",{get:ds(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),r=r||{},this.objectMode=!!r.objectMode,t instanceof he&&(this.objectMode=this.objectMode||!!r.writableObjectMode);var e=r.highWaterMark,i=this.objectMode?16:16*1024;this.highWaterMark=e||e===0?e:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var n=r.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(s){Uf(t,s)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new ul(this)}Ss.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e};function oe(r){if(!(this instanceof oe)&&!(this instanceof he))return new oe(r);this._writableState=new Ss(r,this),this.writable=!0,r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev)),M.call(this)}oe.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function Df(r,t){var e=new Error("write after end");r.emit("error",e),ue(t,e)}function Rf(r,t,e,i){var n=!0,s=!1;return e===null?s=new TypeError("May not write null values to stream"):!g.isBuffer(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(s=new TypeError("Invalid non-string/buffer chunk")),s&&(r.emit("error",s),ue(i,s),n=!1),n}oe.prototype.write=function(r,t,e){var i=this._writableState,n=!1;return typeof t=="function"&&(e=t,t=null),g.isBuffer(r)?t="buffer":t||(t=i.defaultEncoding),typeof e!="function"&&(e=If),i.ended?Df(this,e):Rf(this,i,r,e)&&(i.pendingcb++,n=Lf(this,i,r,t,e)),n};oe.prototype.cork=function(){var r=this._writableState;r.corked++};oe.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,!r.writing&&!r.corked&&!r.finished&&!r.bufferProcessing&&r.bufferedRequest&&ol(this,r))};oe.prototype.setDefaultEncoding=function(t){if(typeof t=="string"&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this};function Nf(r,t,e){return!r.objectMode&&r.decodeStrings!==!1&&typeof t=="string"&&(t=g.from(t,e)),t}function Lf(r,t,e,i,n){e=Nf(t,e,i),g.isBuffer(e)&&(i="buffer");var s=t.objectMode?1:e.length;t.length+=s;var a=t.length<t.highWaterMark;if(a||(t.needDrain=!0),t.writing||t.corked){var o=t.lastBufferedRequest;t.lastBufferedRequest=new Tf(e,i,n),o?o.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else ys(r,t,!1,s,e,i,n);return a}function ys(r,t,e,i,n,s,a){t.writelen=i,t.writecb=a,t.writing=!0,t.sync=!0,e?r._writev(n,t.onwrite):r._write(n,s,t.onwrite),t.sync=!1}function Mf(r,t,e,i,n){--t.pendingcb,e?ue(n,i):n(i),r._writableState.errorEmitted=!0,r.emit("error",i)}function Pf(r){r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0}function Uf(r,t){var e=r._writableState,i=e.sync,n=e.writecb;if(Pf(e),t)Mf(r,e,i,t,n);else{var s=ll(e);!s&&!e.corked&&!e.bufferProcessing&&e.bufferedRequest&&ol(r,e),i?ue(sl,r,e,s,n):sl(r,e,s,n)}}function sl(r,t,e,i){e||zf(r,t),t.pendingcb--,i(),cl(r,t)}function zf(r,t){t.length===0&&t.needDrain&&(t.needDrain=!1,r.emit("drain"))}function ol(r,t){t.bufferProcessing=!0;var e=t.bufferedRequest;if(r._writev&&e&&e.next){var i=t.bufferedRequestCount,n=new Array(i),s=t.corkedRequestsFree;s.entry=e;for(var a=0;e;)n[a]=e,e=e.next,a+=1;ys(r,t,!0,t.length,n,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new ul(t)}else{for(;e;){var o=e.chunk,c=e.encoding,l=e.callback,u=t.objectMode?1:o.length;if(ys(r,t,!1,u,o,c,l),e=e.next,t.writing)break}e===null&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=e,t.bufferProcessing=!1}oe.prototype._write=function(r,t,e){e(new Error("not implemented"))};oe.prototype._writev=null;oe.prototype.end=function(r,t,e){var i=this._writableState;typeof r=="function"?(e=r,r=null,t=null):typeof t=="function"&&(e=t,t=null),r!=null&&this.write(r,t),i.corked&&(i.corked=1,this.uncork()),!i.ending&&!i.finished&&Hf(this,i,e)};function ll(r){return r.ending&&r.length===0&&r.bufferedRequest===null&&!r.finished&&!r.writing}function al(r,t){t.prefinished||(t.prefinished=!0,r.emit("prefinish"))}function cl(r,t){var e=ll(t);return e&&(t.pendingcb===0?(al(r,t),t.finished=!0,r.emit("finish")):al(r,t)),e}function Hf(r,t,e){t.ending=!0,cl(r,t),e&&(t.finished?ue(e):r.once("finish",e)),t.ended=!0,r.writable=!1}function ul(r){var t=this;this.next=null,this.entry=null,this.finish=function(e){var i=t.entry;for(t.entry=null;i;){var n=i.callback;r.pendingcb--,n(e),i=i.next}r.corkedRequestsFree?r.corkedRequestsFree.next=t:r.corkedRequestsFree=t}}X(he,j);var fl=Object.keys(oe.prototype);for(Ri=0;Ri<fl.length;Ri++)Ni=fl[Ri],he.prototype[Ni]||(he.prototype[Ni]=oe.prototype[Ni]);var Ni,Ri;function he(r){if(!(this instanceof he))return new he(r);j.call(this,r),oe.call(this,r),r&&r.readable===!1&&(this.readable=!1),r&&r.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,r&&r.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",jf)}function jf(){this.allowHalfOpen||this._writableState.ended||ue(Zf,this)}function Zf(r){r.end()}X(pe,he);function Vf(r){this.afterTransform=function(t,e){return Wf(r,t,e)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function Wf(r,t,e){var i=r._transformState;i.transforming=!1;var n=i.writecb;if(!n)return r.emit("error",new Error("no writecb in Transform class"));i.writechunk=null,i.writecb=null,e!=null&&r.push(e),n(t);var s=r._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&r._read(s.highWaterMark)}function pe(r){if(!(this instanceof pe))return new pe(r);he.call(this,r),this._transformState=new Vf(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(e){dl(t,e)}):dl(t)})}pe.prototype.push=function(r,t){return this._transformState.needTransform=!1,he.prototype.push.call(this,r,t)};pe.prototype._transform=function(r,t,e){throw new Error("Not implemented")};pe.prototype._write=function(r,t,e){var i=this._transformState;if(i.writecb=e,i.writechunk=r,i.writeencoding=t,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};pe.prototype._read=function(r){var t=this._transformState;t.writechunk!==null&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};function dl(r,t){if(t)return r.emit("error",t);var e=r._writableState,i=r._transformState;if(e.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}X(lr,pe);function lr(r){if(!(this instanceof lr))return new lr(r);pe.call(this,r)}lr.prototype._transform=function(r,t,e){e(null,r)};X(it,vt);it.Readable=j;it.Writable=oe;it.Duplex=he;it.Transform=pe;it.PassThrough=lr;it.Stream=it;function it(){vt.call(this)}it.prototype.pipe=function(r,t){var e=this;function i(u){r.writable&&r.write(u)===!1&&e.pause&&e.pause()}e.on("data",i);function n(){e.readable&&e.resume&&e.resume()}r.on("drain",n),!r._isStdio&&(!t||t.end!==!1)&&(e.on("end",a),e.on("close",o));var s=!1;function a(){s||(s=!0,r.end())}function o(){s||(s=!0,typeof r.destroy=="function"&&r.destroy())}function c(u){if(l(),vt.listenerCount(this,"error")===0)throw u}e.on("error",c),r.on("error",c);function l(){e.removeListener("data",i),r.removeListener("drain",n),e.removeListener("end",a),e.removeListener("close",o),e.removeListener("error",c),r.removeListener("error",c),e.removeListener("end",l),e.removeListener("close",l),r.removeListener("close",l)}return e.on("end",l),e.on("close",l),r.on("close",l),r.emit("pipe",e),r};var $i={};Dt($i,{DEFLATE:()=>br,DEFLATERAW:()=>mr,GUNZIP:()=>Ki,GZIP:()=>qr,INFLATE:()=>Xi,INFLATERAW:()=>Yr,NONE:()=>qs,UNZIP:()=>Kr,Z_BEST_COMPRESSION:()=>uh,Z_BEST_SPEED:()=>ch,Z_BINARY:()=>bh,Z_BLOCK:()=>Rc,Z_BUF_ERROR:()=>oh,Z_DATA_ERROR:()=>ah,Z_DEFAULT_COMPRESSION:()=>fh,Z_DEFAULT_STRATEGY:()=>mh,Z_DEFLATED:()=>Lc,Z_ERRNO:()=>nh,Z_FILTERED:()=>dh,Z_FINISH:()=>Dc,Z_FIXED:()=>gh,Z_FULL_FLUSH:()=>Tc,Z_HUFFMAN_ONLY:()=>hh,Z_NEED_DICT:()=>ih,Z_NO_COMPRESSION:()=>lh,Z_NO_FLUSH:()=>Bc,Z_OK:()=>Gi,Z_PARTIAL_FLUSH:()=>Oc,Z_RLE:()=>ph,Z_STREAM_END:()=>Nc,Z_STREAM_ERROR:()=>sh,Z_SYNC_FLUSH:()=>Ic,Z_TEXT:()=>yh,Z_TREES:()=>rh,Z_UNKNOWN:()=>Sh,Zlib:()=>Ue});var Li={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function qf(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var hl=qf;function ke(r,t,e,i,n){if(t.subarray&&r.subarray){r.set(t.subarray(e,e+i),n);return}for(var s=0;s<i;s++)r[n+s]=t[e+s]}var cr=Uint8Array,ge=Uint16Array,Dr=Int32Array;var Yf=4,pl=0,gl=1,Kf=2;function fr(r){for(var t=r.length;--t>=0;)r[t]=0}var Xf=0,vl=1,Gf=2,$f=3,Jf=258,xs=29,Ur=256,Nr=Ur+1+xs,ur=30,As=19,wl=2*Nr+1,Vt=15,_s=16,Qf=7,ks=256,El=16,Fl=17,Cl=18,Fs=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Mi=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ed=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],xl=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],td=512,nt=new Array((Nr+2)*2);fr(nt);var Rr=new Array(ur*2);fr(Rr);var Lr=new Array(td);fr(Lr);var Mr=new Array(Jf-$f+1);fr(Mr);var Bs=new Array(xs);fr(Bs);var Pi=new Array(ur);fr(Pi);function vs(r,t,e,i,n){this.static_tree=r,this.extra_bits=t,this.extra_base=e,this.elems=i,this.max_length=n,this.has_stree=r&&r.length}var Al,kl,Bl;function ws(r,t){this.dyn_tree=r,this.max_code=0,this.stat_desc=t}function Ol(r){return r<256?Lr[r]:Lr[256+(r>>>7)]}function Pr(r,t){r.pending_buf[r.pending++]=t&255,r.pending_buf[r.pending++]=t>>>8&255}function ye(r,t,e){r.bi_valid>_s-e?(r.bi_buf|=t<<r.bi_valid&65535,Pr(r,r.bi_buf),r.bi_buf=t>>_s-r.bi_valid,r.bi_valid+=e-_s):(r.bi_buf|=t<<r.bi_valid&65535,r.bi_valid+=e)}function Me(r,t,e){ye(r,e[t*2],e[t*2+1])}function Il(r,t){var e=0;do e|=r&1,r>>>=1,e<<=1;while(--t>0);return e>>>1}function rd(r){r.bi_valid===16?(Pr(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=r.bi_buf&255,r.bi_buf>>=8,r.bi_valid-=8)}function id(r,t){var e=t.dyn_tree,i=t.max_code,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,c=t.stat_desc.max_length,l,u,d,h,p,m,y=0;for(h=0;h<=Vt;h++)r.bl_count[h]=0;for(e[r.heap[r.heap_max]*2+1]=0,l=r.heap_max+1;l<wl;l++)u=r.heap[l],h=e[e[u*2+1]*2+1]+1,h>c&&(h=c,y++),e[u*2+1]=h,!(u>i)&&(r.bl_count[h]++,p=0,u>=o&&(p=a[u-o]),m=e[u*2],r.opt_len+=m*(h+p),s&&(r.static_len+=m*(n[u*2+1]+p)));if(y!==0){do{for(h=c-1;r.bl_count[h]===0;)h--;r.bl_count[h]--,r.bl_count[h+1]+=2,r.bl_count[c]--,y-=2}while(y>0);for(h=c;h!==0;h--)for(u=r.bl_count[h];u!==0;)d=r.heap[--l],!(d>i)&&(e[d*2+1]!==h&&(r.opt_len+=(h-e[d*2+1])*e[d*2],e[d*2+1]=h),u--)}}function Tl(r,t,e){var i=new Array(Vt+1),n=0,s,a;for(s=1;s<=Vt;s++)i[s]=n=n+e[s-1]<<1;for(a=0;a<=t;a++){var o=r[a*2+1];o!==0&&(r[a*2]=Il(i[o]++,o))}}function nd(){var r,t,e,i,n,s=new Array(Vt+1);for(e=0,i=0;i<xs-1;i++)for(Bs[i]=e,r=0;r<1<<Fs[i];r++)Mr[e++]=i;for(Mr[e-1]=i,n=0,i=0;i<16;i++)for(Pi[i]=n,r=0;r<1<<Mi[i];r++)Lr[n++]=i;for(n>>=7;i<ur;i++)for(Pi[i]=n<<7,r=0;r<1<<Mi[i]-7;r++)Lr[256+n++]=i;for(t=0;t<=Vt;t++)s[t]=0;for(r=0;r<=143;)nt[r*2+1]=8,r++,s[8]++;for(;r<=255;)nt[r*2+1]=9,r++,s[9]++;for(;r<=279;)nt[r*2+1]=7,r++,s[7]++;for(;r<=287;)nt[r*2+1]=8,r++,s[8]++;for(Tl(nt,Nr+1,s),r=0;r<ur;r++)Rr[r*2+1]=5,Rr[r*2]=Il(r,5);Al=new vs(nt,Fs,Ur+1,Nr,Vt),kl=new vs(Rr,Mi,0,ur,Vt),Bl=new vs(new Array(0),ed,0,As,Qf)}function Dl(r){var t;for(t=0;t<Nr;t++)r.dyn_ltree[t*2]=0;for(t=0;t<ur;t++)r.dyn_dtree[t*2]=0;for(t=0;t<As;t++)r.bl_tree[t*2]=0;r.dyn_ltree[ks*2]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0}function Rl(r){r.bi_valid>8?Pr(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0}function sd(r,t,e,i){Rl(r),i&&(Pr(r,e),Pr(r,~e)),ke(r.pending_buf,r.window,t,e,r.pending),r.pending+=e}function ml(r,t,e,i){var n=t*2,s=e*2;return r[n]<r[s]||r[n]===r[s]&&i[t]<=i[e]}function Es(r,t,e){for(var i=r.heap[e],n=e<<1;n<=r.heap_len&&(n<r.heap_len&&ml(t,r.heap[n+1],r.heap[n],r.depth)&&n++,!ml(t,i,r.heap[n],r.depth));)r.heap[e]=r.heap[n],e=n,n<<=1;r.heap[e]=i}function bl(r,t,e){var i,n,s=0,a,o;if(r.last_lit!==0)do i=r.pending_buf[r.d_buf+s*2]<<8|r.pending_buf[r.d_buf+s*2+1],n=r.pending_buf[r.l_buf+s],s++,i===0?Me(r,n,t):(a=Mr[n],Me(r,a+Ur+1,t),o=Fs[a],o!==0&&(n-=Bs[a],ye(r,n,o)),i--,a=Ol(i),Me(r,a,e),o=Mi[a],o!==0&&(i-=Pi[a],ye(r,i,o)));while(s<r.last_lit);Me(r,ks,t)}function Cs(r,t){var e=t.dyn_tree,i=t.stat_desc.static_tree,n=t.stat_desc.has_stree,s=t.stat_desc.elems,a,o,c=-1,l;for(r.heap_len=0,r.heap_max=wl,a=0;a<s;a++)e[a*2]!==0?(r.heap[++r.heap_len]=c=a,r.depth[a]=0):e[a*2+1]=0;for(;r.heap_len<2;)l=r.heap[++r.heap_len]=c<2?++c:0,e[l*2]=1,r.depth[l]=0,r.opt_len--,n&&(r.static_len-=i[l*2+1]);for(t.max_code=c,a=r.heap_len>>1;a>=1;a--)Es(r,e,a);l=s;do a=r.heap[1],r.heap[1]=r.heap[r.heap_len--],Es(r,e,1),o=r.heap[1],r.heap[--r.heap_max]=a,r.heap[--r.heap_max]=o,e[l*2]=e[a*2]+e[o*2],r.depth[l]=(r.depth[a]>=r.depth[o]?r.depth[a]:r.depth[o])+1,e[a*2+1]=e[o*2+1]=l,r.heap[1]=l++,Es(r,e,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],id(r,t),Tl(e,c,r.bl_count)}function yl(r,t,e){var i,n=-1,s,a=t[0*2+1],o=0,c=7,l=4;for(a===0&&(c=138,l=3),t[(e+1)*2+1]=65535,i=0;i<=e;i++)s=a,a=t[(i+1)*2+1],!(++o<c&&s===a)&&(o<l?r.bl_tree[s*2]+=o:s!==0?(s!==n&&r.bl_tree[s*2]++,r.bl_tree[El*2]++):o<=10?r.bl_tree[Fl*2]++:r.bl_tree[Cl*2]++,o=0,n=s,a===0?(c=138,l=3):s===a?(c=6,l=3):(c=7,l=4))}function Sl(r,t,e){var i,n=-1,s,a=t[0*2+1],o=0,c=7,l=4;for(a===0&&(c=138,l=3),i=0;i<=e;i++)if(s=a,a=t[(i+1)*2+1],!(++o<c&&s===a)){if(o<l)do Me(r,s,r.bl_tree);while(--o!==0);else s!==0?(s!==n&&(Me(r,s,r.bl_tree),o--),Me(r,El,r.bl_tree),ye(r,o-3,2)):o<=10?(Me(r,Fl,r.bl_tree),ye(r,o-3,3)):(Me(r,Cl,r.bl_tree),ye(r,o-11,7));o=0,n=s,a===0?(c=138,l=3):s===a?(c=6,l=3):(c=7,l=4)}}function ad(r){var t;for(yl(r,r.dyn_ltree,r.l_desc.max_code),yl(r,r.dyn_dtree,r.d_desc.max_code),Cs(r,r.bl_desc),t=As-1;t>=3&&r.bl_tree[xl[t]*2+1]===0;t--);return r.opt_len+=3*(t+1)+5+5+4,t}function od(r,t,e,i){var n;for(ye(r,t-257,5),ye(r,e-1,5),ye(r,i-4,4),n=0;n<i;n++)ye(r,r.bl_tree[xl[n]*2+1],3);Sl(r,r.dyn_ltree,t-1),Sl(r,r.dyn_dtree,e-1)}function ld(r){var t=4093624447,e;for(e=0;e<=31;e++,t>>>=1)if(t&1&&r.dyn_ltree[e*2]!==0)return pl;if(r.dyn_ltree[9*2]!==0||r.dyn_ltree[10*2]!==0||r.dyn_ltree[13*2]!==0)return gl;for(e=32;e<Ur;e++)if(r.dyn_ltree[e*2]!==0)return gl;return pl}var _l=!1;function Nl(r){_l||(nd(),_l=!0),r.l_desc=new ws(r.dyn_ltree,Al),r.d_desc=new ws(r.dyn_dtree,kl),r.bl_desc=new ws(r.bl_tree,Bl),r.bi_buf=0,r.bi_valid=0,Dl(r)}function Os(r,t,e,i){ye(r,(Xf<<1)+(i?1:0),3),sd(r,t,e,!0)}function Ll(r){ye(r,vl<<1,3),Me(r,ks,nt),rd(r)}function Ml(r,t,e,i){var n,s,a=0;r.level>0?(r.strm.data_type===Kf&&(r.strm.data_type=ld(r)),Cs(r,r.l_desc),Cs(r,r.d_desc),a=ad(r),n=r.opt_len+3+7>>>3,s=r.static_len+3+7>>>3,s<=n&&(n=s)):n=s=e+5,e+4<=n&&t!==-1?Os(r,t,e,i):r.strategy===Yf||s===n?(ye(r,(vl<<1)+(i?1:0),3),bl(r,nt,Rr)):(ye(r,(Gf<<1)+(i?1:0),3),od(r,r.l_desc.max_code+1,r.d_desc.max_code+1,a+1),bl(r,r.dyn_ltree,r.dyn_dtree)),Dl(r),i&&Rl(r)}function st(r,t,e){return r.pending_buf[r.d_buf+r.last_lit*2]=t>>>8&255,r.pending_buf[r.d_buf+r.last_lit*2+1]=t&255,r.pending_buf[r.l_buf+r.last_lit]=e&255,r.last_lit++,t===0?r.dyn_ltree[e*2]++:(r.matches++,t--,r.dyn_ltree[(Mr[e]+Ur+1)*2]++,r.dyn_dtree[Ol(t)*2]++),r.last_lit===r.lit_bufsize-1}function cd(r,t,e,i){for(var n=r&65535|0,s=r>>>16&65535|0,a=0;e!==0;){a=e>2e3?2e3:e,e-=a;do n=n+t[i++]|0,s=s+n|0;while(--a);n%=65521,s%=65521}return n|s<<16|0}var zr=cd;function ud(){for(var r,t=[],e=0;e<256;e++){r=e;for(var i=0;i<8;i++)r=r&1?3988292384^r>>>1:r>>>1;t[e]=r}return t}var fd=ud();function dd(r,t,e,i){var n=fd,s=i+e;r^=-1;for(var a=i;a<s;a++)r=r>>>8^n[(r^t[a])&255];return r^-1}var ee=dd;var Kt=0,hd=1,pd=3,kt=4,Pl=5,Ct=0,Ul=1,Bt=-2,gd=-3,Is=-5,md=-1,bd=1,Ui=2,yd=3,Sd=4;var _d=2,Ns=8,vd=9;var wd=29,Ed=256,Ds=Ed+1+wd,Fd=30,Cd=19,xd=2*Ds+1,Ad=15,P=3,xt=258,Ie=xt+P+1,kd=32,Ls=42,Rs=69,zi=73,Hi=91,ji=103,qt=113,jr=666,ne=1,Zr=2,Yt=3,pr=4,Bd=3;function At(r,t){return r.msg=Li[t],t}function zl(r){return(r<<1)-(r>4?9:0)}function Wt(r){for(var t=r.length;--t>=0;)r[t]=0}function Ft(r){var t=r.state,e=t.pending;e>r.avail_out&&(e=r.avail_out),e!==0&&(ke(r.output,t.pending_buf,t.pending_out,e,r.next_out),r.next_out+=e,t.pending_out+=e,r.total_out+=e,r.avail_out-=e,t.pending-=e,t.pending===0&&(t.pending_out=0))}function de(r,t){Ml(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,t),r.block_start=r.strstart,Ft(r.strm)}function R(r,t){r.pending_buf[r.pending++]=t}function Hr(r,t){r.pending_buf[r.pending++]=t>>>8&255,r.pending_buf[r.pending++]=t&255}function Od(r,t,e,i){var n=r.avail_in;return n>i&&(n=i),n===0?0:(r.avail_in-=n,ke(t,r.input,r.next_in,n,e),r.state.wrap===1?r.adler=zr(r.adler,t,n,e):r.state.wrap===2&&(r.adler=ee(r.adler,t,n,e)),r.next_in+=n,r.total_in+=n,n)}function Hl(r,t){var e=r.max_chain_length,i=r.strstart,n,s,a=r.prev_length,o=r.nice_match,c=r.strstart>r.w_size-Ie?r.strstart-(r.w_size-Ie):0,l=r.window,u=r.w_mask,d=r.prev,h=r.strstart+xt,p=l[i+a-1],m=l[i+a];r.prev_length>=r.good_match&&(e>>=2),o>r.lookahead&&(o=r.lookahead);do if(n=t,!(l[n+a]!==m||l[n+a-1]!==p||l[n]!==l[i]||l[++n]!==l[i+1])){i+=2,n++;do;while(l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&i<h);if(s=xt-(h-i),i=h-xt,s>a){if(r.match_start=t,a=s,s>=o)break;p=l[i+a-1],m=l[i+a]}}while((t=d[t&u])>c&&--e!==0);return a<=r.lookahead?a:r.lookahead}function Vr(r){var t=r.w_size,e,i,n,s,a;do{if(s=r.window_size-r.lookahead-r.strstart,r.strstart>=t+(t-Ie)){ke(r.window,r.window,t,t,0),r.match_start-=t,r.strstart-=t,r.block_start-=t,i=r.hash_size,e=i;do n=r.head[--e],r.head[e]=n>=t?n-t:0;while(--i);i=t,e=i;do n=r.prev[--e],r.prev[e]=n>=t?n-t:0;while(--i);s+=t}if(r.strm.avail_in===0)break;if(i=Od(r.strm,r.window,r.strstart+r.lookahead,s),r.lookahead+=i,r.lookahead+r.insert>=P)for(a=r.strstart-r.insert,r.ins_h=r.window[a],r.ins_h=(r.ins_h<<r.hash_shift^r.window[a+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[a+P-1])&r.hash_mask,r.prev[a&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=a,a++,r.insert--,!(r.lookahead+r.insert<P)););}while(r.lookahead<Ie&&r.strm.avail_in!==0)}function Id(r,t){var e=65535;for(e>r.pending_buf_size-5&&(e=r.pending_buf_size-5);;){if(r.lookahead<=1){if(Vr(r),r.lookahead===0&&t===Kt)return ne;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;var i=r.block_start+e;if((r.strstart===0||r.strstart>=i)&&(r.lookahead=r.strstart-i,r.strstart=i,de(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-Ie&&(de(r,!1),r.strm.avail_out===0))return ne}return r.insert=0,t===kt?(de(r,!0),r.strm.avail_out===0?Yt:pr):(r.strstart>r.block_start&&(de(r,!1),r.strm.avail_out===0),ne)}function Ts(r,t){for(var e,i;;){if(r.lookahead<Ie){if(Vr(r),r.lookahead<Ie&&t===Kt)return ne;if(r.lookahead===0)break}if(e=0,r.lookahead>=P&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+P-1])&r.hash_mask,e=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),e!==0&&r.strstart-e<=r.w_size-Ie&&(r.match_length=Hl(r,e)),r.match_length>=P)if(i=st(r,r.strstart-r.match_start,r.match_length-P),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=P){r.match_length--;do r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+P-1])&r.hash_mask,e=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!==0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else i=st(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(i&&(de(r,!1),r.strm.avail_out===0))return ne}return r.insert=r.strstart<P-1?r.strstart:P-1,t===kt?(de(r,!0),r.strm.avail_out===0?Yt:pr):r.last_lit&&(de(r,!1),r.strm.avail_out===0)?ne:Zr}function dr(r,t){for(var e,i,n;;){if(r.lookahead<Ie){if(Vr(r),r.lookahead<Ie&&t===Kt)return ne;if(r.lookahead===0)break}if(e=0,r.lookahead>=P&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+P-1])&r.hash_mask,e=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=P-1,e!==0&&r.prev_length<r.max_lazy_match&&r.strstart-e<=r.w_size-Ie&&(r.match_length=Hl(r,e),r.match_length<=5&&(r.strategy===bd||r.match_length===P&&r.strstart-r.match_start>4096)&&(r.match_length=P-1)),r.prev_length>=P&&r.match_length<=r.prev_length){n=r.strstart+r.lookahead-P,i=st(r,r.strstart-1-r.prev_match,r.prev_length-P),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=n&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+P-1])&r.hash_mask,e=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!==0);if(r.match_available=0,r.match_length=P-1,r.strstart++,i&&(de(r,!1),r.strm.avail_out===0))return ne}else if(r.match_available){if(i=st(r,0,r.window[r.strstart-1]),i&&de(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return ne}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(i=st(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<P-1?r.strstart:P-1,t===kt?(de(r,!0),r.strm.avail_out===0?Yt:pr):r.last_lit&&(de(r,!1),r.strm.avail_out===0)?ne:Zr}function Td(r,t){for(var e,i,n,s,a=r.window;;){if(r.lookahead<=xt){if(Vr(r),r.lookahead<=xt&&t===Kt)return ne;if(r.lookahead===0)break}if(r.match_length=0,r.lookahead>=P&&r.strstart>0&&(n=r.strstart-1,i=a[n],i===a[++n]&&i===a[++n]&&i===a[++n])){s=r.strstart+xt;do;while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&n<s);r.match_length=xt-(s-n),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=P?(e=st(r,1,r.match_length-P),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(e=st(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),e&&(de(r,!1),r.strm.avail_out===0))return ne}return r.insert=0,t===kt?(de(r,!0),r.strm.avail_out===0?Yt:pr):r.last_lit&&(de(r,!1),r.strm.avail_out===0)?ne:Zr}function Dd(r,t){for(var e;;){if(r.lookahead===0&&(Vr(r),r.lookahead===0)){if(t===Kt)return ne;break}if(r.match_length=0,e=st(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,e&&(de(r,!1),r.strm.avail_out===0))return ne}return r.insert=0,t===kt?(de(r,!0),r.strm.avail_out===0?Yt:pr):r.last_lit&&(de(r,!1),r.strm.avail_out===0)?ne:Zr}function Pe(r,t,e,i,n){this.good_length=r,this.max_lazy=t,this.nice_length=e,this.max_chain=i,this.func=n}var hr;hr=[new Pe(0,0,0,0,Id),new Pe(4,4,8,4,Ts),new Pe(4,5,16,8,Ts),new Pe(4,6,32,32,Ts),new Pe(4,4,16,16,dr),new Pe(8,16,32,32,dr),new Pe(8,16,128,128,dr),new Pe(8,32,128,256,dr),new Pe(32,128,258,1024,dr),new Pe(32,258,258,4096,dr)];function Rd(r){r.window_size=2*r.w_size,Wt(r.head),r.max_lazy_match=hr[r.level].max_lazy,r.good_match=hr[r.level].good_length,r.nice_match=hr[r.level].nice_length,r.max_chain_length=hr[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=P-1,r.match_available=0,r.ins_h=0}function Nd(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ns,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new ge(xd*2),this.dyn_dtree=new ge((2*Fd+1)*2),this.bl_tree=new ge((2*Cd+1)*2),Wt(this.dyn_ltree),Wt(this.dyn_dtree),Wt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new ge(Ad+1),this.heap=new ge(2*Ds+1),Wt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new ge(2*Ds+1),Wt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ld(r){var t;return!r||!r.state?At(r,Bt):(r.total_in=r.total_out=0,r.data_type=_d,t=r.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?Ls:qt,r.adler=t.wrap===2?0:1,t.last_flush=Kt,Nl(t),Ct)}function Ms(r){var t=Ld(r);return t===Ct&&Rd(r.state),t}function jl(r,t,e,i,n,s){if(!r)return Bt;var a=1;if(t===md&&(t=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),n<1||n>vd||e!==Ns||i<8||i>15||t<0||t>9||s<0||s>Sd)return At(r,Bt);i===8&&(i=9);var o=new Nd;return r.state=o,o.strm=r,o.wrap=a,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+P-1)/P),o.window=new cr(o.w_size*2),o.head=new ge(o.hash_size),o.prev=new ge(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new cr(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=(1+2)*o.lit_bufsize,o.level=t,o.strategy=s,o.method=e,Ms(r)}function Zl(r,t){var e,i,n,s;if(!r||!r.state||t>Pl||t<0)return r?At(r,Bt):Bt;if(i=r.state,!r.output||!r.input&&r.avail_in!==0||i.status===jr&&t!==kt)return At(r,r.avail_out===0?Is:Bt);if(i.strm=r,e=i.last_flush,i.last_flush=t,i.status===Ls)if(i.wrap===2)r.adler=0,R(i,31),R(i,139),R(i,8),i.gzhead?(R(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),R(i,i.gzhead.time&255),R(i,i.gzhead.time>>8&255),R(i,i.gzhead.time>>16&255),R(i,i.gzhead.time>>24&255),R(i,i.level===9?2:i.strategy>=Ui||i.level<2?4:0),R(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(R(i,i.gzhead.extra.length&255),R(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(r.adler=ee(r.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=Rs):(R(i,0),R(i,0),R(i,0),R(i,0),R(i,0),R(i,i.level===9?2:i.strategy>=Ui||i.level<2?4:0),R(i,Bd),i.status=qt);else{var a=Ns+(i.w_bits-8<<4)<<8,o=-1;i.strategy>=Ui||i.level<2?o=0:i.level<6?o=1:i.level===6?o=2:o=3,a|=o<<6,i.strstart!==0&&(a|=kd),a+=31-a%31,i.status=qt,Hr(i,a),i.strstart!==0&&(Hr(i,r.adler>>>16),Hr(i,r.adler&65535)),r.adler=1}if(i.status===Rs)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(r.adler=ee(r.adler,i.pending_buf,i.pending-n,n)),Ft(r),n=i.pending,i.pending===i.pending_buf_size));)R(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(r.adler=ee(r.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=zi)}else i.status=zi;if(i.status===zi)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(r.adler=ee(r.adler,i.pending_buf,i.pending-n,n)),Ft(r),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.name.length?s=i.gzhead.name.charCodeAt(i.gzindex++)&255:s=0,R(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(r.adler=ee(r.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.gzindex=0,i.status=Hi)}else i.status=Hi;if(i.status===Hi)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(r.adler=ee(r.adler,i.pending_buf,i.pending-n,n)),Ft(r),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.comment.length?s=i.gzhead.comment.charCodeAt(i.gzindex++)&255:s=0,R(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(r.adler=ee(r.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.status=ji)}else i.status=ji;if(i.status===ji&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Ft(r),i.pending+2<=i.pending_buf_size&&(R(i,r.adler&255),R(i,r.adler>>8&255),r.adler=0,i.status=qt)):i.status=qt),i.pending!==0){if(Ft(r),r.avail_out===0)return i.last_flush=-1,Ct}else if(r.avail_in===0&&zl(t)<=zl(e)&&t!==kt)return At(r,Is);if(i.status===jr&&r.avail_in!==0)return At(r,Is);if(r.avail_in!==0||i.lookahead!==0||t!==Kt&&i.status!==jr){var c=i.strategy===Ui?Dd(i,t):i.strategy===yd?Td(i,t):hr[i.level].func(i,t);if((c===Yt||c===pr)&&(i.status=jr),c===ne||c===Yt)return r.avail_out===0&&(i.last_flush=-1),Ct;if(c===Zr&&(t===hd?Ll(i):t!==Pl&&(Os(i,0,0,!1),t===pd&&(Wt(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Ft(r),r.avail_out===0))return i.last_flush=-1,Ct}return t!==kt?Ct:i.wrap<=0?Ul:(i.wrap===2?(R(i,r.adler&255),R(i,r.adler>>8&255),R(i,r.adler>>16&255),R(i,r.adler>>24&255),R(i,r.total_in&255),R(i,r.total_in>>8&255),R(i,r.total_in>>16&255),R(i,r.total_in>>24&255)):(Hr(i,r.adler>>>16),Hr(i,r.adler&65535)),Ft(r),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Ct:Ul)}function Vl(r){var t;return!r||!r.state?Bt:(t=r.state.status,t!==Ls&&t!==Rs&&t!==zi&&t!==Hi&&t!==ji&&t!==qt&&t!==jr?At(r,Bt):(r.state=null,t===qt?At(r,gd):Ct))}var Zi=30,Md=12;function Ps(r,t){var e,i,n,s,a,o,c,l,u,d,h,p,m,y,b,S,w,x,_,I,q,E,L,N,k;e=r.state,i=r.next_in,N=r.input,n=i+(r.avail_in-5),s=r.next_out,k=r.output,a=s-(t-r.avail_out),o=s+(r.avail_out-257),c=e.dmax,l=e.wsize,u=e.whave,d=e.wnext,h=e.window,p=e.hold,m=e.bits,y=e.lencode,b=e.distcode,S=(1<<e.lenbits)-1,w=(1<<e.distbits)-1;e:do{m<15&&(p+=N[i++]<<m,m+=8,p+=N[i++]<<m,m+=8),x=y[p&S];t:for(;;){if(_=x>>>24,p>>>=_,m-=_,_=x>>>16&255,_===0)k[s++]=x&65535;else if(_&16){I=x&65535,_&=15,_&&(m<_&&(p+=N[i++]<<m,m+=8),I+=p&(1<<_)-1,p>>>=_,m-=_),m<15&&(p+=N[i++]<<m,m+=8,p+=N[i++]<<m,m+=8),x=b[p&w];r:for(;;){if(_=x>>>24,p>>>=_,m-=_,_=x>>>16&255,_&16){if(q=x&65535,_&=15,m<_&&(p+=N[i++]<<m,m+=8,m<_&&(p+=N[i++]<<m,m+=8)),q+=p&(1<<_)-1,q>c){r.msg="invalid distance too far back",e.mode=Zi;break e}if(p>>>=_,m-=_,_=s-a,q>_){if(_=q-_,_>u&&e.sane){r.msg="invalid distance too far back",e.mode=Zi;break e}if(E=0,L=h,d===0){if(E+=l-_,_<I){I-=_;do k[s++]=h[E++];while(--_);E=s-q,L=k}}else if(d<_){if(E+=l+d-_,_-=d,_<I){I-=_;do k[s++]=h[E++];while(--_);if(E=0,d<I){_=d,I-=_;do k[s++]=h[E++];while(--_);E=s-q,L=k}}}else if(E+=d-_,_<I){I-=_;do k[s++]=h[E++];while(--_);E=s-q,L=k}for(;I>2;)k[s++]=L[E++],k[s++]=L[E++],k[s++]=L[E++],I-=3;I&&(k[s++]=L[E++],I>1&&(k[s++]=L[E++]))}else{E=s-q;do k[s++]=k[E++],k[s++]=k[E++],k[s++]=k[E++],I-=3;while(I>2);I&&(k[s++]=k[E++],I>1&&(k[s++]=k[E++]))}}else if(_&64){r.msg="invalid distance code",e.mode=Zi;break e}else{x=b[(x&65535)+(p&(1<<_)-1)];continue r}break}}else if(_&64)if(_&32){e.mode=Md;break e}else{r.msg="invalid literal/length code",e.mode=Zi;break e}else{x=y[(x&65535)+(p&(1<<_)-1)];continue t}break}}while(i<n&&s<o);I=m>>3,i-=I,m-=I<<3,p&=(1<<m)-1,r.next_in=i,r.next_out=s,r.avail_in=i<n?5+(n-i):5-(i-n),r.avail_out=s<o?257+(o-s):257-(s-o),e.hold=p,e.bits=m}var gr=15,Wl=852,ql=592,Yl=0,Us=1,Kl=2,Pd=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Ud=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],zd=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Hd=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function Xt(r,t,e,i,n,s,a,o){var c=o.bits,l=0,u=0,d=0,h=0,p=0,m=0,y=0,b=0,S=0,w=0,x,_,I,q,E,L=null,N=0,k,te=new ge(gr+1),Tt=new ge(gr+1),Jr=null,Sa=0,_a,Qr,ei;for(l=0;l<=gr;l++)te[l]=0;for(u=0;u<i;u++)te[t[e+u]]++;for(p=c,h=gr;h>=1&&te[h]===0;h--);if(p>h&&(p=h),h===0)return n[s++]=1<<24|64<<16|0,n[s++]=1<<24|64<<16|0,o.bits=1,0;for(d=1;d<h&&te[d]===0;d++);for(p<d&&(p=d),b=1,l=1;l<=gr;l++)if(b<<=1,b-=te[l],b<0)return-1;if(b>0&&(r===Yl||h!==1))return-1;for(Tt[1]=0,l=1;l<gr;l++)Tt[l+1]=Tt[l]+te[l];for(u=0;u<i;u++)t[e+u]!==0&&(a[Tt[t[e+u]]++]=u);if(r===Yl?(L=Jr=a,k=19):r===Us?(L=Pd,N-=257,Jr=Ud,Sa-=257,k=256):(L=zd,Jr=Hd,k=-1),w=0,u=0,l=d,E=s,m=p,y=0,I=-1,S=1<<p,q=S-1,r===Us&&S>Wl||r===Kl&&S>ql)return 1;for(var jc=0;;){jc++,_a=l-y,a[u]<k?(Qr=0,ei=a[u]):a[u]>k?(Qr=Jr[Sa+a[u]],ei=L[N+a[u]]):(Qr=32+64,ei=0),x=1<<l-y,_=1<<m,d=_;do _-=x,n[E+(w>>y)+_]=_a<<24|Qr<<16|ei|0;while(_!==0);for(x=1<<l-1;w&x;)x>>=1;if(x!==0?(w&=x-1,w+=x):w=0,u++,--te[l]===0){if(l===h)break;l=t[e+a[u]]}if(l>p&&(w&q)!==I){for(y===0&&(y=p),E+=d,m=l-y,b=1<<m;m+y<h&&(b-=te[m+y],!(b<=0));)m++,b<<=1;if(S+=1<<m,r===Us&&S>Wl||r===Kl&&S>ql)return 1;I=w&q,n[I]=p<<24|m<<16|E-s|0}}return w!==0&&(n[E+w]=l-y<<24|64<<16|0),o.bits=p,0}var jd=0,Ec=1,Fc=2,Xl=4,Zd=5,Vi=6,Wr=0,Vd=1,Wd=2,Ot=-2,qd=-3,Gl=-4,Yd=-5,$l=8,Cc=1,Jl=2,Ql=3,ec=4,tc=5,rc=6,ic=7,nc=8,sc=9,ac=10,oc=11,at=12,zs=13,lc=14,Hs=15,cc=16,uc=17,fc=18,dc=19,Wi=20,qi=21,hc=22,pc=23,gc=24,mc=25,bc=26,js=27,yc=28,Sc=29,Z=30,_c=31,Kd=32,Xd=852,Gd=592;function vc(r){return(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24)}function $d(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new ge(320),this.work=new ge(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Jd(r){var t;return!r||!r.state?Ot:(t=r.state,r.total_in=r.total_out=t.total=0,r.msg="",t.wrap&&(r.adler=t.wrap&1),t.mode=Cc,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Dr(Xd),t.distcode=t.distdyn=new Dr(Gd),t.sane=1,t.back=-1,Wr)}function Ws(r){var t;return!r||!r.state?Ot:(t=r.state,t.wsize=0,t.whave=0,t.wnext=0,Jd(r))}function Qd(r,t){var e,i;return!r||!r.state||(i=r.state,t<0?(e=0,t=-t):(e=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15))?Ot:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=e,i.wbits=t,Ws(r))}function xc(r,t){var e,i;return r?(i=new $d,r.state=i,i.window=null,e=Qd(r,t),e!==Wr&&(r.state=null),e):Ot}var wc=!0,Zs,Vs;function eh(r){if(wc){var t;for(Zs=new Dr(512),Vs=new Dr(32),t=0;t<144;)r.lens[t++]=8;for(;t<256;)r.lens[t++]=9;for(;t<280;)r.lens[t++]=7;for(;t<288;)r.lens[t++]=8;for(Xt(Ec,r.lens,0,288,Zs,0,r.work,{bits:9}),t=0;t<32;)r.lens[t++]=5;Xt(Fc,r.lens,0,32,Vs,0,r.work,{bits:5}),wc=!1}r.lencode=Zs,r.lenbits=9,r.distcode=Vs,r.distbits=5}function th(r,t,e,i){var n,s=r.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new cr(s.wsize)),i>=s.wsize?(ke(s.window,t,e-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),ke(s.window,t,e-i,n,s.wnext),i-=n,i?(ke(s.window,t,e-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0}function Ac(r,t){var e,i,n,s,a,o,c,l,u,d,h,p,m,y,b=0,S,w,x,_,I,q,E,L,N=new cr(4),k,te,Tt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!r||!r.state||!r.output||!r.input&&r.avail_in!==0)return Ot;e=r.state,e.mode===at&&(e.mode=zs),a=r.next_out,n=r.output,c=r.avail_out,s=r.next_in,i=r.input,o=r.avail_in,l=e.hold,u=e.bits,d=o,h=c,L=Wr;e:for(;;)switch(e.mode){case Cc:if(e.wrap===0){e.mode=zs;break}for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(e.wrap&2&&l===35615){e.check=0,N[0]=l&255,N[1]=l>>>8&255,e.check=ee(e.check,N,2,0),l=0,u=0,e.mode=Jl;break}if(e.flags=0,e.head&&(e.head.done=!1),!(e.wrap&1)||(((l&255)<<8)+(l>>8))%31){r.msg="incorrect header check",e.mode=Z;break}if((l&15)!==$l){r.msg="unknown compression method",e.mode=Z;break}if(l>>>=4,u-=4,E=(l&15)+8,e.wbits===0)e.wbits=E;else if(E>e.wbits){r.msg="invalid window size",e.mode=Z;break}e.dmax=1<<E,r.adler=e.check=1,e.mode=l&512?ac:at,l=0,u=0;break;case Jl:for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(e.flags=l,(e.flags&255)!==$l){r.msg="unknown compression method",e.mode=Z;break}if(e.flags&57344){r.msg="unknown header flags set",e.mode=Z;break}e.head&&(e.head.text=l>>8&1),e.flags&512&&(N[0]=l&255,N[1]=l>>>8&255,e.check=ee(e.check,N,2,0)),l=0,u=0,e.mode=Ql;case Ql:for(;u<32;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}e.head&&(e.head.time=l),e.flags&512&&(N[0]=l&255,N[1]=l>>>8&255,N[2]=l>>>16&255,N[3]=l>>>24&255,e.check=ee(e.check,N,4,0)),l=0,u=0,e.mode=ec;case ec:for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}e.head&&(e.head.xflags=l&255,e.head.os=l>>8),e.flags&512&&(N[0]=l&255,N[1]=l>>>8&255,e.check=ee(e.check,N,2,0)),l=0,u=0,e.mode=tc;case tc:if(e.flags&1024){for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}e.length=l,e.head&&(e.head.extra_len=l),e.flags&512&&(N[0]=l&255,N[1]=l>>>8&255,e.check=ee(e.check,N,2,0)),l=0,u=0}else e.head&&(e.head.extra=null);e.mode=rc;case rc:if(e.flags&1024&&(p=e.length,p>o&&(p=o),p&&(e.head&&(E=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Array(e.head.extra_len)),ke(e.head.extra,i,s,p,E)),e.flags&512&&(e.check=ee(e.check,i,p,s)),o-=p,s+=p,e.length-=p),e.length))break e;e.length=0,e.mode=ic;case ic:if(e.flags&2048){if(o===0)break e;p=0;do E=i[s+p++],e.head&&E&&e.length<65536&&(e.head.name+=String.fromCharCode(E));while(E&&p<o);if(e.flags&512&&(e.check=ee(e.check,i,p,s)),o-=p,s+=p,E)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=nc;case nc:if(e.flags&4096){if(o===0)break e;p=0;do E=i[s+p++],e.head&&E&&e.length<65536&&(e.head.comment+=String.fromCharCode(E));while(E&&p<o);if(e.flags&512&&(e.check=ee(e.check,i,p,s)),o-=p,s+=p,E)break e}else e.head&&(e.head.comment=null);e.mode=sc;case sc:if(e.flags&512){for(;u<16;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(l!==(e.check&65535)){r.msg="header crc mismatch",e.mode=Z;break}l=0,u=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),r.adler=e.check=0,e.mode=at;break;case ac:for(;u<32;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}r.adler=e.check=vc(l),l=0,u=0,e.mode=oc;case oc:if(e.havedict===0)return r.next_out=a,r.avail_out=c,r.next_in=s,r.avail_in=o,e.hold=l,e.bits=u,Wd;r.adler=e.check=1,e.mode=at;case at:if(t===Zd||t===Vi)break e;case zs:if(e.last){l>>>=u&7,u-=u&7,e.mode=js;break}for(;u<3;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}switch(e.last=l&1,l>>>=1,u-=1,l&3){case 0:e.mode=lc;break;case 1:if(eh(e),e.mode=Wi,t===Vi){l>>>=2,u-=2;break e}break;case 2:e.mode=uc;break;case 3:r.msg="invalid block type",e.mode=Z}l>>>=2,u-=2;break;case lc:for(l>>>=u&7,u-=u&7;u<32;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if((l&65535)!==(l>>>16^65535)){r.msg="invalid stored block lengths",e.mode=Z;break}if(e.length=l&65535,l=0,u=0,e.mode=Hs,t===Vi)break e;case Hs:e.mode=cc;case cc:if(p=e.length,p){if(p>o&&(p=o),p>c&&(p=c),p===0)break e;ke(n,i,s,p,a),o-=p,s+=p,c-=p,a+=p,e.length-=p;break}e.mode=at;break;case uc:for(;u<14;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(e.nlen=(l&31)+257,l>>>=5,u-=5,e.ndist=(l&31)+1,l>>>=5,u-=5,e.ncode=(l&15)+4,l>>>=4,u-=4,e.nlen>286||e.ndist>30){r.msg="too many length or distance symbols",e.mode=Z;break}e.have=0,e.mode=fc;case fc:for(;e.have<e.ncode;){for(;u<3;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}e.lens[Tt[e.have++]]=l&7,l>>>=3,u-=3}for(;e.have<19;)e.lens[Tt[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,k={bits:e.lenbits},L=Xt(jd,e.lens,0,19,e.lencode,0,e.work,k),e.lenbits=k.bits,L){r.msg="invalid code lengths set",e.mode=Z;break}e.have=0,e.mode=dc;case dc:for(;e.have<e.nlen+e.ndist;){for(;b=e.lencode[l&(1<<e.lenbits)-1],S=b>>>24,w=b>>>16&255,x=b&65535,!(S<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(x<16)l>>>=S,u-=S,e.lens[e.have++]=x;else{if(x===16){for(te=S+2;u<te;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(l>>>=S,u-=S,e.have===0){r.msg="invalid bit length repeat",e.mode=Z;break}E=e.lens[e.have-1],p=3+(l&3),l>>>=2,u-=2}else if(x===17){for(te=S+3;u<te;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}l>>>=S,u-=S,E=0,p=3+(l&7),l>>>=3,u-=3}else{for(te=S+7;u<te;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}l>>>=S,u-=S,E=0,p=11+(l&127),l>>>=7,u-=7}if(e.have+p>e.nlen+e.ndist){r.msg="invalid bit length repeat",e.mode=Z;break}for(;p--;)e.lens[e.have++]=E}}if(e.mode===Z)break;if(e.lens[256]===0){r.msg="invalid code -- missing end-of-block",e.mode=Z;break}if(e.lenbits=9,k={bits:e.lenbits},L=Xt(Ec,e.lens,0,e.nlen,e.lencode,0,e.work,k),e.lenbits=k.bits,L){r.msg="invalid literal/lengths set",e.mode=Z;break}if(e.distbits=6,e.distcode=e.distdyn,k={bits:e.distbits},L=Xt(Fc,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,k),e.distbits=k.bits,L){r.msg="invalid distances set",e.mode=Z;break}if(e.mode=Wi,t===Vi)break e;case Wi:e.mode=qi;case qi:if(o>=6&&c>=258){r.next_out=a,r.avail_out=c,r.next_in=s,r.avail_in=o,e.hold=l,e.bits=u,Ps(r,h),a=r.next_out,n=r.output,c=r.avail_out,s=r.next_in,i=r.input,o=r.avail_in,l=e.hold,u=e.bits,e.mode===at&&(e.back=-1);break}for(e.back=0;b=e.lencode[l&(1<<e.lenbits)-1],S=b>>>24,w=b>>>16&255,x=b&65535,!(S<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(w&&!(w&240)){for(_=S,I=w,q=x;b=e.lencode[q+((l&(1<<_+I)-1)>>_)],S=b>>>24,w=b>>>16&255,x=b&65535,!(_+S<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}l>>>=_,u-=_,e.back+=_}if(l>>>=S,u-=S,e.back+=S,e.length=x,w===0){e.mode=bc;break}if(w&32){e.back=-1,e.mode=at;break}if(w&64){r.msg="invalid literal/length code",e.mode=Z;break}e.extra=w&15,e.mode=hc;case hc:if(e.extra){for(te=e.extra;u<te;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}e.length+=l&(1<<e.extra)-1,l>>>=e.extra,u-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=pc;case pc:for(;b=e.distcode[l&(1<<e.distbits)-1],S=b>>>24,w=b>>>16&255,x=b&65535,!(S<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(!(w&240)){for(_=S,I=w,q=x;b=e.distcode[q+((l&(1<<_+I)-1)>>_)],S=b>>>24,w=b>>>16&255,x=b&65535,!(_+S<=u);){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}l>>>=_,u-=_,e.back+=_}if(l>>>=S,u-=S,e.back+=S,w&64){r.msg="invalid distance code",e.mode=Z;break}e.offset=x,e.extra=w&15,e.mode=gc;case gc:if(e.extra){for(te=e.extra;u<te;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}e.offset+=l&(1<<e.extra)-1,l>>>=e.extra,u-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){r.msg="invalid distance too far back",e.mode=Z;break}e.mode=mc;case mc:if(c===0)break e;if(p=h-c,e.offset>p){if(p=e.offset-p,p>e.whave&&e.sane){r.msg="invalid distance too far back",e.mode=Z;break}p>e.wnext?(p-=e.wnext,m=e.wsize-p):m=e.wnext-p,p>e.length&&(p=e.length),y=e.window}else y=n,m=a-e.offset,p=e.length;p>c&&(p=c),c-=p,e.length-=p;do n[a++]=y[m++];while(--p);e.length===0&&(e.mode=qi);break;case bc:if(c===0)break e;n[a++]=e.length,c--,e.mode=qi;break;case js:if(e.wrap){for(;u<32;){if(o===0)break e;o--,l|=i[s++]<<u,u+=8}if(h-=c,r.total_out+=h,e.total+=h,h&&(r.adler=e.check=e.flags?ee(e.check,n,h,a-h):zr(e.check,n,h,a-h)),h=c,(e.flags?l:vc(l))!==e.check){r.msg="incorrect data check",e.mode=Z;break}l=0,u=0}e.mode=yc;case yc:if(e.wrap&&e.flags){for(;u<32;){if(o===0)break e;o--,l+=i[s++]<<u,u+=8}if(l!==(e.total&4294967295)){r.msg="incorrect length check",e.mode=Z;break}l=0,u=0}e.mode=Sc;case Sc:L=Vd;break e;case Z:L=qd;break e;case _c:return Gl;case Kd:default:return Ot}return r.next_out=a,r.avail_out=c,r.next_in=s,r.avail_in=o,e.hold=l,e.bits=u,(e.wsize||h!==r.avail_out&&e.mode<Z&&(e.mode<js||t!==Xl))&&th(r,r.output,r.next_out,h-r.avail_out)?(e.mode=_c,Gl):(d-=r.avail_in,h-=r.avail_out,r.total_in+=d,r.total_out+=h,e.total+=h,e.wrap&&h&&(r.adler=e.check=e.flags?ee(e.check,n,h,r.next_out-h):zr(e.check,n,h,r.next_out-h)),r.data_type=e.bits+(e.last?64:0)+(e.mode===at?128:0)+(e.mode===Wi||e.mode===Hs?256:0),(d===0&&h===0||t===Xl)&&L===Wr&&(L=Yd),L)}function kc(r){if(!r||!r.state)return Ot;var t=r.state;return t.window&&(t.window=null),r.state=null,Wr}var qs=0,br=1,Xi=2,qr=3,Ki=4,mr=5,Yr=6,Kr=7,Bc=0,Oc=1,Ic=2,Tc=3,Dc=4,Rc=5,rh=6,Gi=0,Nc=1,ih=2,nh=-1,sh=-2,ah=-3,oh=-5,lh=0,ch=1,uh=9,fh=-1,dh=1,hh=2,ph=3,gh=4,mh=0,bh=0,yh=1,Sh=2,Lc=8;function Ue(r){if(r<br||r>Kr)throw new TypeError("Bad argument");this.mode=r,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}Ue.prototype.init=function(r,t,e,i,n){this.windowBits=r,this.level=t,this.memLevel=e,this.strategy=i,(this.mode===qr||this.mode===Ki)&&(this.windowBits+=16),this.mode===Kr&&(this.windowBits+=32),(this.mode===mr||this.mode===Yr)&&(this.windowBits=-this.windowBits),this.strm=new hl;var s;switch(this.mode){case br:case qr:case mr:s=jl(this.strm,this.level,Lc,this.windowBits,this.memLevel,this.strategy);break;case Xi:case Ki:case Yr:case Kr:s=xc(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}if(s!==Gi){this._error(s);return}this.write_in_progress=!1,this.init_done=!0};Ue.prototype.params=function(){throw new Error("deflateParams Not supported")};Ue.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(this.mode===qs)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")};Ue.prototype.write=function(r,t,e,i,n,s,a){this._writeCheck(),this.write_in_progress=!0;var o=this;return process.nextTick(function(){o.write_in_progress=!1;var c=o._write(r,t,e,i,n,s,a);o.callback(c[0],c[1]),o.pending_close&&o.close()}),this};function _h(r,t){for(var e=0;e<r.length;e++)this[t+e]=r[e]}Ue.prototype.writeSync=function(r,t,e,i,n,s,a){return this._writeCheck(),this._write(r,t,e,i,n,s,a)};Ue.prototype._write=function(r,t,e,i,n,s,a){if(this.write_in_progress=!0,r!==Bc&&r!==Oc&&r!==Ic&&r!==Tc&&r!==Dc&&r!==Rc)throw new Error("Invalid flush value");t==null&&(t=new Buffer(0),i=0,e=0),n._set?n.set=n._set:n.set=_h;var o=this.strm;o.avail_in=i,o.input=t,o.next_in=e,o.avail_out=a,o.output=n,o.next_out=s;var c;switch(this.mode){case br:case qr:case mr:c=Zl(o,r);break;case Kr:case Xi:case Ki:case Yr:c=Ac(o,r);break;default:throw new Error("Unknown mode "+this.mode)}return c!==Nc&&c!==Gi&&this._error(c),this.write_in_progress=!1,[o.avail_in,o.avail_out]};Ue.prototype.close=function(){if(this.write_in_progress){this.pending_close=!0;return}this.pending_close=!1,this.mode===br||this.mode===qr||this.mode===mr?Vl(this.strm):kc(this.strm),this.mode=qs};var Yi;Ue.prototype.reset=function(){switch(this.mode){case br:case mr:Yi=Ms(this.strm);break;case Xi:case Yr:Yi=Ws(this.strm);break}Yi!==Gi&&this._error(Yi)};Ue.prototype._error=function(r){this.onerror(Li[r]+": "+this.strm.msg,r),this.write_in_progress=!1,this.pending_close&&this.close()};function vh(r,t){if(!r)throw new Error(t)}var v={};Object.keys($i).forEach(function(r){v[r]=$i[r]});v.Z_MIN_WINDOWBITS=8;v.Z_MAX_WINDOWBITS=15;v.Z_DEFAULT_WINDOWBITS=15;v.Z_MIN_CHUNK=64;v.Z_MAX_CHUNK=1/0;v.Z_DEFAULT_CHUNK=16*1024;v.Z_MIN_MEMLEVEL=1;v.Z_MAX_MEMLEVEL=9;v.Z_DEFAULT_MEMLEVEL=8;v.Z_MIN_LEVEL=-1;v.Z_MAX_LEVEL=9;v.Z_DEFAULT_LEVEL=v.Z_DEFAULT_COMPRESSION;var Ys={Z_OK:v.Z_OK,Z_STREAM_END:v.Z_STREAM_END,Z_NEED_DICT:v.Z_NEED_DICT,Z_ERRNO:v.Z_ERRNO,Z_STREAM_ERROR:v.Z_STREAM_ERROR,Z_DATA_ERROR:v.Z_DATA_ERROR,Z_MEM_ERROR:v.Z_MEM_ERROR,Z_BUF_ERROR:v.Z_BUF_ERROR,Z_VERSION_ERROR:v.Z_VERSION_ERROR};Object.keys(Ys).forEach(function(r){Ys[Ys[r]]=r});function Mc(r,t){return wh(new Ji(t),r)}function wh(r,t){if(typeof t=="string"&&(t=new Buffer(t)),!Buffer.isBuffer(t))throw new TypeError("Not a string or buffer");var e=v.Z_FINISH;return r._processChunk(t,e)}function Ks(r){if(!(this instanceof Ks))return new Ks(r);G.call(this,r,v.DEFLATE)}function Xs(r){if(!(this instanceof Xs))return new Xs(r);G.call(this,r,v.INFLATE)}function Gs(r){if(!(this instanceof Gs))return new Gs(r);G.call(this,r,v.GZIP)}function $s(r){if(!(this instanceof $s))return new $s(r);G.call(this,r,v.GUNZIP)}function Js(r){if(!(this instanceof Js))return new Js(r);G.call(this,r,v.DEFLATERAW)}function Ji(r){if(!(this instanceof Ji))return new Ji(r);G.call(this,r,v.INFLATERAW)}function Qs(r){if(!(this instanceof Qs))return new Qs(r);G.call(this,r,v.UNZIP)}function G(r,t){if(this._opts=r=r||{},this._chunkSize=r.chunkSize||v.Z_DEFAULT_CHUNK,pe.call(this,r),r.flush&&r.flush!==v.Z_NO_FLUSH&&r.flush!==v.Z_PARTIAL_FLUSH&&r.flush!==v.Z_SYNC_FLUSH&&r.flush!==v.Z_FULL_FLUSH&&r.flush!==v.Z_FINISH&&r.flush!==v.Z_BLOCK)throw new Error("Invalid flush flag: "+r.flush);if(this._flushFlag=r.flush||v.Z_NO_FLUSH,r.chunkSize&&(r.chunkSize<v.Z_MIN_CHUNK||r.chunkSize>v.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+r.chunkSize);if(r.windowBits&&(r.windowBits<v.Z_MIN_WINDOWBITS||r.windowBits>v.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+r.windowBits);if(r.level&&(r.level<v.Z_MIN_LEVEL||r.level>v.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+r.level);if(r.memLevel&&(r.memLevel<v.Z_MIN_MEMLEVEL||r.memLevel>v.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+r.memLevel);if(r.strategy&&r.strategy!=v.Z_FILTERED&&r.strategy!=v.Z_HUFFMAN_ONLY&&r.strategy!=v.Z_RLE&&r.strategy!=v.Z_FIXED&&r.strategy!=v.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+r.strategy);if(r.dictionary&&!Buffer.isBuffer(r.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new v.Zlib(t);var e=this;this._hadError=!1,this._binding.onerror=function(s,a){e._binding=null,e._hadError=!0;var o=new Error(s);o.errno=a,o.code=v.codes[a],e.emit("error",o)};var i=v.Z_DEFAULT_COMPRESSION;typeof r.level=="number"&&(i=r.level);var n=v.Z_DEFAULT_STRATEGY;typeof r.strategy=="number"&&(n=r.strategy),this._binding.init(r.windowBits||v.Z_DEFAULT_WINDOWBITS,i,r.memLevel||v.Z_DEFAULT_MEMLEVEL,n,r.dictionary),this._buffer=new Buffer(this._chunkSize),this._offset=0,this._closed=!1,this._level=i,this._strategy=n,this.once("end",this.close)}X(G,pe);G.prototype.params=function(r,t,e){if(r<v.Z_MIN_LEVEL||r>v.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+r);if(t!=v.Z_FILTERED&&t!=v.Z_HUFFMAN_ONLY&&t!=v.Z_RLE&&t!=v.Z_FIXED&&t!=v.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+t);if(this._level!==r||this._strategy!==t){var i=this;this.flush(v.Z_SYNC_FLUSH,function(){i._binding.params(r,t),i._hadError||(i._level=r,i._strategy=t,e&&e())})}else process.nextTick(e)};G.prototype.reset=function(){return this._binding.reset()};G.prototype._flush=function(r){this._transform(new Buffer(0),"",r)};G.prototype.flush=function(r,t){var e=this._writableState;if((typeof r=="function"||r===void 0&&!t)&&(t=r,r=v.Z_FULL_FLUSH),e.ended)t&&process.nextTick(t);else if(e.ending)t&&this.once("end",t);else if(e.needDrain){var i=this;this.once("drain",function(){i.flush(t)})}else this._flushFlag=r,this.write(new Buffer(0),"",t)};G.prototype.close=function(r){if(r&&process.nextTick(r),!this._closed){this._closed=!0,this._binding.close();var t=this;process.nextTick(function(){t.emit("close")})}};G.prototype._transform=function(r,t,e){var i,n=this._writableState,s=n.ending||n.ended,a=s&&(!r||n.length===r.length);if(!r===null&&!Buffer.isBuffer(r))return e(new Error("invalid input"));a?i=v.Z_FINISH:(i=this._flushFlag,r.length>=n.length&&(this._flushFlag=this._opts.flush||v.Z_NO_FLUSH)),this._processChunk(r,i,e)};G.prototype._processChunk=function(r,t,e){var i=r&&r.length,n=this._chunkSize-this._offset,s=0,a=this,o=typeof e=="function";if(!o){var c=[],l=0,u;this.on("error",function(y){u=y});do var d=this._binding.writeSync(t,r,s,i,this._buffer,this._offset,n);while(!this._hadError&&m(d[0],d[1]));if(this._hadError)throw u;var h=Buffer.concat(c,l);return this.close(),h}var p=this._binding.write(t,r,s,i,this._buffer,this._offset,n);p.buffer=r,p.callback=m;function m(y,b){if(!a._hadError){var S=n-b;if(vh(S>=0,"have should not go down"),S>0){var w=a._buffer.slice(a._offset,a._offset+S);a._offset+=S,o?a.push(w):(c.push(w),l+=w.length)}if((b===0||a._offset>=a._chunkSize)&&(n=a._chunkSize,a._offset=0,a._buffer=new Buffer(a._chunkSize)),b===0){if(s+=i-y,i=y,!o)return!0;var x=a._binding.write(t,r,s,i,a._buffer,a._offset,a._chunkSize);x.callback=m,x.buffer=r;return}if(!o)return!1;e()}}};X(Ks,G);X(Xs,G);X(Gs,G);X($s,G);X(Js,G);X(Ji,G);X(Qs,G);var Pc={};var sa=(b=>(b[b.STORED=0]="STORED",b[b.SHRUNK=1]="SHRUNK",b[b.REDUCED_1=2]="REDUCED_1",b[b.REDUCED_2=3]="REDUCED_2",b[b.REDUCED_3=4]="REDUCED_3",b[b.REDUCED_4=5]="REDUCED_4",b[b.IMPLODE=6]="IMPLODE",b[b.DEFLATE=8]="DEFLATE",b[b.DEFLATE64=9]="DEFLATE64",b[b.TERSE_OLD=10]="TERSE_OLD",b[b.BZIP2=12]="BZIP2",b[b.LZMA=14]="LZMA",b[b.TERSE_NEW=18]="TERSE_NEW",b[b.LZ77=19]="LZ77",b[b.WAVPACK=97]="WAVPACK",b[b.PPMD=98]="PPMD",b))(sa||{});function Uc(r,t){let e=t&31,i=(t>>5&15)-1,n=(t>>9)+1980,s=r&31,a=r>>5&63,o=r>>11;return new Date(n,i,e,o,a,s)}function Qi(r,t,e,i){return i===0?"":t?r.toString("utf8",e,e+i):ar.byte2str(r.slice(e,e+i))}var ea=class{constructor(t){this.data=t;if(t.readUInt32LE(0)!==67324752)throw new f(22,"Invalid Zip file: Local file header has invalid signature: "+this.data.readUInt32LE(0))}versionNeeded(){return this.data.readUInt16LE(4)}flags(){return this.data.readUInt16LE(6)}compressionMethod(){return this.data.readUInt16LE(8)}lastModFileTime(){return Uc(this.data.readUInt16LE(10),this.data.readUInt16LE(12))}rawLastModFileTime(){return this.data.readUInt32LE(10)}crc32(){return this.data.readUInt32LE(14)}fileNameLength(){return this.data.readUInt16LE(26)}extraFieldLength(){return this.data.readUInt16LE(28)}fileName(){return Qi(this.data,this.useUTF8(),30,this.fileNameLength())}extraField(){let t=30+this.fileNameLength();return this.data.slice(t,t+this.extraFieldLength())}totalSize(){return 30+this.fileNameLength()+this.extraFieldLength()}useUTF8(){return(this.flags()&2048)===2048}},ta=class{constructor(t,e,i){this.header=t;this.record=e;this.data=i}decompress(){let t=this.header.compressionMethod(),e=Pc[t];if(e)return e(this.data,this.record.compressedSize(),this.record.uncompressedSize(),this.record.flag());{let i=sa[t];throw i||(i=`Unknown: ${t}`),new f(22,`Invalid compression method on file '${this.header.fileName()}': ${i}`)}}getHeader(){return this.header}getRecord(){return this.record}getRawData(){return this.data}};var ra=class{constructor(t,e){this.zipData=t;this.data=e;if(this.data.readUInt32LE(0)!==33639248)throw new f(22,`Invalid Zip file: Central directory record has invalid signature: ${this.data.readUInt32LE(0)}`);this._filename=this.produceFilename()}versionMadeBy(){return this.data.readUInt16LE(4)}versionNeeded(){return this.data.readUInt16LE(6)}flag(){return this.data.readUInt16LE(8)}compressionMethod(){return this.data.readUInt16LE(10)}lastModFileTime(){return Uc(this.data.readUInt16LE(12),this.data.readUInt16LE(14))}rawLastModFileTime(){return this.data.readUInt32LE(12)}crc32(){return this.data.readUInt32LE(16)}compressedSize(){return this.data.readUInt32LE(20)}uncompressedSize(){return this.data.readUInt32LE(24)}fileNameLength(){return this.data.readUInt16LE(28)}extraFieldLength(){return this.data.readUInt16LE(30)}fileCommentLength(){return this.data.readUInt16LE(32)}diskNumberStart(){return this.data.readUInt16LE(34)}internalAttributes(){return this.data.readUInt16LE(36)}externalAttributes(){return this.data.readUInt32LE(38)}headerRelativeOffset(){return this.data.readUInt32LE(42)}produceFilename(){return Qi(this.data,this.useUTF8(),46,this.fileNameLength()).replace(/\\/g,"/")}fileName(){return this._filename}rawFileName(){return this.data.slice(46,46+this.fileNameLength())}extraField(){let t=44+this.fileNameLength();return this.data.slice(t,t+this.extraFieldLength())}fileComment(){let t=46+this.fileNameLength()+this.extraFieldLength();return Qi(this.data,this.useUTF8(),t,this.fileCommentLength())}rawFileComment(){let t=46+this.fileNameLength()+this.extraFieldLength();return this.data.slice(t,t+this.fileCommentLength())}totalSize(){return 46+this.fileNameLength()+this.extraFieldLength()+this.fileCommentLength()}isDirectory(){let t=this.fileName();return!!(this.externalAttributes()&16)||t.charAt(t.length-1)==="/"}isFile(){return!this.isDirectory()}useUTF8(){return(this.flag()&2048)===2048}isEncrypted(){return(this.flag()&1)===1}getFileData(){let t=this.headerRelativeOffset(),e=new ea(this.zipData.slice(t));return new ta(e,this,this.zipData.slice(t+e.totalSize()))}getData(){return this.getFileData().decompress()}getRawData(){return this.getFileData().getRawData()}getStats(){return new C(32768,this.uncompressedSize(),365,Date.now(),this.lastModFileTime().getTime())}},ia=class{constructor(t){this.data=t;if(this.data.readUInt32LE(0)!==101010256)throw new f(22,`Invalid Zip file: End of central directory record has invalid signature: ${this.data.readUInt32LE(0)}`)}diskNumber(){return this.data.readUInt16LE(4)}cdDiskNumber(){return this.data.readUInt16LE(6)}cdDiskEntryCount(){return this.data.readUInt16LE(8)}cdTotalEntryCount(){return this.data.readUInt16LE(10)}cdSize(){return this.data.readUInt32LE(12)}cdOffset(){return this.data.readUInt32LE(16)}cdZipCommentLength(){return this.data.readUInt16LE(20)}cdZipComment(){return Qi(this.data,!0,22,this.cdZipCommentLength())}rawCdZipComment(){return this.data.slice(22,22+this.cdZipCommentLength())}},na=class{constructor(t,e,i,n){this.index=t;this.directoryEntries=e;this.eocd=i;this.data=n}},ze=class extends Ae{constructor(e,i=""){super();this.name=i;this._index=new tt;this._directoryEntries=[];this._eocd=null;this._index=e.index,this._directoryEntries=e.directoryEntries,this._eocd=e.eocd,this.data=e.data}static Create(e,i){try{ze._computeIndex(e.zipData,(n,s)=>{if(s){let a=new ze(s,e.name);i(null,a)}else i(n)})}catch(n){i(n)}}static CreateAsync(e){return new Promise((i,n)=>{this.Create(e,(s,a)=>{s||!a?n(s):i(a)})})}static isAvailable(){return!0}static RegisterDecompressionMethod(e,i){Pc[e]=i}static _getEOCD(e){let n=Math.min(65557,e.length-1);for(let s=22;s<n;s++)if(e.readUInt32LE(e.length-s)===101010256)return new ia(e.slice(e.length-s));throw new f(22,"Invalid ZIP file: Could not locate End of Central Directory signature.")}static _addToIndex(e,i){let n=e.fileName();if(n.charAt(0)==="/")throw new f(1,"Unexpectedly encountered an absolute path in a zip file. Please file a bug.");n.charAt(n.length-1)==="/"&&(n=n.substr(0,n.length-1)),e.isDirectory()?i.addPathFast("/"+n,new et(e)):i.addPathFast("/"+n,new Br(e))}static _computeIndex(e,i){try{let n=new tt,s=ze._getEOCD(e);if(s.diskNumber()!==s.cdDiskNumber())return i(new f(22,"ZipFS does not support spanned zip files."));let a=s.cdOffset();if(a===4294967295)return i(new f(22,"ZipFS does not support Zip64."));let o=a+s.cdSize();ze._computeIndexResponsive(e,n,a,o,i,[],s)}catch(n){i(n)}}static _computeIndexResponsiveTrampoline(e,i,n,s,a,o,c){try{ze._computeIndexResponsive(e,i,n,s,a,o,c)}catch(l){a(l)}}static _computeIndexResponsive(e,i,n,s,a,o,c){if(n<s){let l=0;for(;l++<200&&n<s;){let u=new ra(e,e.slice(n));ze._addToIndex(u,i),n+=u.totalSize(),o.push(u)}xe(()=>{ze._computeIndexResponsiveTrampoline(e,i,n,s,a,o,c)})}else a(null,new na(i,o,c,e))}getName(){return ze.Name+(this.name!==""?` ${this.name}`:"")}getCentralDirectoryEntry(e){let i=this._index.getInode(e);if(i===null)throw f.ENOENT(e);if(Oe(i))return i.getData();if(fe(i))return i.getData();throw f.EPERM(`Invalid inode: ${i}`)}getCentralDirectoryEntryAt(e){let i=this._directoryEntries[e];if(!i)throw new RangeError(`Invalid directory index: ${e}.`);return i}getNumberOfCentralDirectoryEntries(){return this._directoryEntries.length}getEndOfCentralDirectory(){return this._eocd}diskSpace(e,i){i(this.data.length,0)}isReadOnly(){return!0}supportsLinks(){return!1}supportsProps(){return!1}supportsSynch(){return!0}statSync(e,i){let n=this._index.getInode(e);if(n===null)throw f.ENOENT(e);let s;if(Oe(n))s=n.getData().getStats();else if(fe(n))s=n.getStats();else throw new f(22,"Invalid inode.");return s}openSync(e,i,n){if(i.isWriteable())throw new f(1,e);let s=this._index.getInode(e);if(s)if(Oe(s)||fe(s)){let a=fe(s)?s.getStats():s.getData().getStats(),o=fe(s)?s.getStats().fileData:s.getData().getData();switch(i.pathExistsAction()){case 1:case 2:throw f.EEXIST(e);case 0:return new ve(this,e,i,a,o||void 0);default:throw new f(22,"Invalid FileMode object.")}}else throw f.EPERM(e);else throw f.ENOENT(e)}readdirSync(e){let i=this._index.getInode(e);if(i){if(fe(i))return i.getListing();throw f.ENOTDIR(e)}else throw f.ENOENT(e)}readFileSync(e,i,n){let s=this.openSync(e,n,420);try{let o=s.getBuffer();return i===null?Ve(o):o.toString(i)}finally{s.closeSync()}}},Te=ze;Te.Name="ZipFS",Te.Options={zipData:{type:"object",description:"The zip file as a Buffer object.",validator:Sr},name:{type:"string",optional:!0,description:"The name of the zip file (optional)."}},Te.CompressionMethod=sa;Te.RegisterDecompressionMethod(8,(r,t,e)=>Mc(r.slice(0,t),{chunkSize:e}));Te.RegisterDecompressionMethod(0,(r,t,e)=>Ve(r,0,e));var Eh="IEEE_P1282";function Se(r,t,e){return r.toString("ascii",t,t+e).trim()}function aa(r,t,e){if(e===1)return String.fromCharCode(r[t]);let i=Math.floor(e/2),n=new Array(i);for(let s=0;s<i;s++){let a=t+(s<<1);n[s]=String.fromCharCode(r[a+1]|r[a]<<8)}return n.join("")}function He(r,t){let e=parseInt(Se(r,t,4),10),i=parseInt(Se(r,t+4,2),10),n=parseInt(Se(r,t+6,2),10),s=parseInt(Se(r,t+8,2),10),a=parseInt(Se(r,t+10,2),10),o=parseInt(Se(r,t+12,2),10),c=parseInt(Se(r,t+14,2),10);return new Date(e,i,n,s,a,o,c*100)}function Gt(r,t){let e=r[t],i=r[t+1],n=r[t+2],s=r[t+3],a=r[t+4],o=r[t+5];return new Date(e,i-1,n,s,a,o)}function Fh(r,t){let e=r.slice(t),i=new se(e);switch(i.signatureWord()){case 17221:return new an(e);case 20548:return new ca(e);case 21328:return new on(e);case 21332:return new ln(e);case 17746:return new cn(e);case 17747:return new ua(e);case 20568:return new fn(e);case 20558:return new fa(e);case 21324:return new Xr(e);case 20045:return new dn(e);case 17228:return new Gr(e);case 20556:return new ha(e);case 21061:return new hn(e);case 21574:return new pn(e);case 21318:return new pa(e);case 21074:return new un(e);default:return i}}function zc(r,t,e,i){e=e-4;let n=new Array;for(;t<e;){let s=Fh(r,t),a=s.length();if(a===0)return n;if(t+=a,s instanceof ln)break;s instanceof an?n=n.concat(s.getEntries(i)):n.push(s)}return n}var en=class{constructor(t){this._data=t}type(){return this._data[0]}standardIdentifier(){return Se(this._data,1,5)}version(){return this._data[6]}data(){return this._data.slice(7,2048)}},tn=class extends en{constructor(e){super(e);this._root=null}systemIdentifier(){return this._getString32(8)}volumeIdentifier(){return this._getString32(40)}volumeSpaceSize(){return this._data.readUInt32LE(80)}volumeSetSize(){return this._data.readUInt16LE(120)}volumeSequenceNumber(){return this._data.readUInt16LE(124)}logicalBlockSize(){return this._data.readUInt16LE(128)}pathTableSize(){return this._data.readUInt32LE(132)}locationOfTypeLPathTable(){return this._data.readUInt32LE(140)}locationOfOptionalTypeLPathTable(){return this._data.readUInt32LE(144)}locationOfTypeMPathTable(){return this._data.readUInt32BE(148)}locationOfOptionalTypeMPathTable(){return this._data.readUInt32BE(152)}rootDirectoryEntry(e){return this._root===null&&(this._root=this._constructRootDirectoryRecord(this._data.slice(156)),this._root.rootCheckForRockRidge(e)),this._root}volumeSetIdentifier(){return this._getString(190,128)}publisherIdentifier(){return this._getString(318,128)}dataPreparerIdentifier(){return this._getString(446,128)}applicationIdentifier(){return this._getString(574,128)}copyrightFileIdentifier(){return this._getString(702,38)}abstractFileIdentifier(){return this._getString(740,36)}bibliographicFileIdentifier(){return this._getString(776,37)}volumeCreationDate(){return He(this._data,813)}volumeModificationDate(){return He(this._data,830)}volumeExpirationDate(){return He(this._data,847)}volumeEffectiveDate(){return He(this._data,864)}fileStructureVersion(){return this._data[881]}applicationUsed(){return this._data.slice(883,883+512)}reserved(){return this._data.slice(1395,1395+653)}_getString32(e){return this._getString(e,32)}},oa=class extends tn{constructor(t){if(super(t),this.type()!==1)throw new f(5,"Invalid primary volume descriptor.")}name(){return"ISO9660"}_constructRootDirectoryRecord(t){return new nn(t,-1)}_getString(t,e){return this._getString(t,e)}},la=class extends tn{constructor(t){if(super(t),this.type()!==2)throw new f(5,"Invalid supplementary volume descriptor.");let e=this.escapeSequence(),i=e[2];if(e[0]!==37||e[1]!==47||i!==64&&i!==67&&i!==69)throw new f(5,`Unrecognized escape sequence for SupplementaryVolumeDescriptor: ${e.toString()}`)}name(){return"Joliet"}escapeSequence(){return this._data.slice(88,120)}_constructRootDirectoryRecord(t){return new sn(t,-1)}_getString(t,e){return aa(this._data,t,e)}};var rn=class{constructor(t,e){this._suEntries=null;this._fileOrDir=null;this._data=t,this._rockRidgeOffset=e}hasRockRidge(){return this._rockRidgeOffset>-1}getRockRidgeOffset(){return this._rockRidgeOffset}rootCheckForRockRidge(t){let e=this.getDirectory(t);this._rockRidgeOffset=e.getDotEntry(t)._getRockRidgeOffset(t),this._rockRidgeOffset>-1&&(this._fileOrDir=null)}length(){return this._data[0]}extendedAttributeRecordLength(){return this._data[1]}lba(){return this._data.readUInt32LE(2)*2048}dataLength(){return this._data.readUInt32LE(10)}recordingDate(){return Gt(this._data,18)}fileFlags(){return this._data[25]}fileUnitSize(){return this._data[26]}interleaveGapSize(){return this._data[27]}volumeSequenceNumber(){return this._data.readUInt16LE(28)}identifier(){return this._getString(33,this._data[32])}fileName(t){if(this.hasRockRidge()){let n=this._rockRidgeFilename(t);if(n!==null)return n}let e=this.identifier();if(this.isDirectory(t))return e;let i=e.indexOf(";");return i===-1?e:e[i-1]==="."?e.slice(0,i-1):e.slice(0,i)}isDirectory(t){let e=!!(this.fileFlags()&2);return!e&&this.hasRockRidge()&&(e=this.getSUEntries(t).filter(i=>i instanceof Gr).length>0),e}isSymlink(t){return this.hasRockRidge()&&this.getSUEntries(t).filter(e=>e instanceof Xr).length>0}getSymlinkPath(t){let e="",i=this.getSUEntries(t),n=this._getGetString();for(let s of i)if(s instanceof Xr){let a=s.componentRecords();for(let o of a){let c=o.flags();c&2?e+="./":c&4?e+="../":c&8?e+="/":(e+=o.content(n),c&1||(e+="/"))}if(!s.continueFlag())break}return e.length>1&&e[e.length-1]==="/"?e.slice(0,e.length-1):e}getFile(t){if(this.isDirectory(t))throw new Error("Tried to get a File from a directory.");return this._fileOrDir===null&&(this._fileOrDir=t.slice(this.lba(),this.lba()+this.dataLength())),this._fileOrDir}getDirectory(t){if(!this.isDirectory(t))throw new Error("Tried to get a Directory from a file.");return this._fileOrDir===null&&(this._fileOrDir=this._constructDirectory(t)),this._fileOrDir}getSUEntries(t){return this._suEntries||this._constructSUEntries(t),this._suEntries}_rockRidgeFilename(t){let e=this.getSUEntries(t).filter(s=>s instanceof dn);if(e.length===0||e[0].flags()&6)return null;let i="",n=this._getGetString();for(let s of e)if(i+=s.name(n),!(s.flags()&1))break;return i}_constructSUEntries(t){let e=33+this._data[32];e%2===1&&e++,e+=this._rockRidgeOffset,this._suEntries=zc(this._data,e,this.length(),t)}_getRockRidgeOffset(t){this._rockRidgeOffset=0;let e=this.getSUEntries(t);if(e.length>0){let i=e[0];if(i instanceof on&&i.checkBytesPass())for(let n=1;n<e.length;n++){let s=e[n];if(s instanceof un||s instanceof cn&&s.extensionIdentifier()===Eh)return i.bytesSkipped()}}return this._rockRidgeOffset=-1,-1}},nn=class extends rn{constructor(t,e){super(t,e)}_getString(t,e){return Se(this._data,t,e)}_constructDirectory(t){return new ga(this,t)}_getGetString(){return Se}},sn=class extends rn{constructor(t,e){super(t,e)}_getString(t,e){return aa(this._data,t,e)}_constructDirectory(t){return new ma(this,t)}_getGetString(){return aa}};var se=class{constructor(t){this._data=t}signatureWord(){return this._data.readUInt16BE(0)}signatureWordString(){return Se(this._data,0,2)}length(){return this._data[2]}suVersion(){return this._data[3]}},an=class extends se{constructor(e){super(e);this._entries=null}continuationLba(){return this._data.readUInt32LE(4)}continuationLbaOffset(){return this._data.readUInt32LE(12)}continuationLength(){return this._data.readUInt32LE(20)}getEntries(e){if(!this._entries){let i=this.continuationLba()*2048+this.continuationLbaOffset();this._entries=zc(e,i,this.continuationLength(),e)}return this._entries}},ca=class extends se{constructor(t){super(t)}},on=class extends se{constructor(t){super(t)}checkBytesPass(){return this._data[4]===190&&this._data[5]===239}bytesSkipped(){return this._data[6]}},ln=class extends se{constructor(t){super(t)}},cn=class extends se{constructor(t){super(t)}identifierLength(){return this._data[4]}descriptorLength(){return this._data[5]}sourceLength(){return this._data[6]}extensionVersion(){return this._data[7]}extensionIdentifier(){return Se(this._data,8,this.identifierLength())}extensionDescriptor(){return Se(this._data,8+this.identifierLength(),this.descriptorLength())}extensionSource(){return Se(this._data,8+this.identifierLength()+this.descriptorLength(),this.sourceLength())}},ua=class extends se{constructor(t){super(t)}extensionSequence(){return this._data[4]}},un=class extends se{constructor(t){super(t)}},fn=class extends se{constructor(t){super(t)}mode(){return this._data.readUInt32LE(4)}fileLinks(){return this._data.readUInt32LE(12)}uid(){return this._data.readUInt32LE(20)}gid(){return this._data.readUInt32LE(28)}inode(){return this._data.readUInt32LE(36)}},fa=class extends se{constructor(t){super(t)}devTHigh(){return this._data.readUInt32LE(4)}devTLow(){return this._data.readUInt32LE(12)}},Xr=class extends se{constructor(t){super(t)}flags(){return this._data[4]}continueFlag(){return this.flags()&1}componentRecords(){let t=new Array,e=5;for(;e<this.length();){let i=new da(this._data.slice(e));t.push(i),e+=i.length()}return t}};var da=class{constructor(t){this._data=t}flags(){return this._data[0]}length(){return 2+this.componentLength()}componentLength(){return this._data[1]}content(t){return t(this._data,2,this.componentLength())}};var dn=class extends se{constructor(t){super(t)}flags(){return this._data[4]}name(t){return t(this._data,5,this.length()-5)}},Gr=class extends se{constructor(t){super(t)}childDirectoryLba(){return this._data.readUInt32LE(4)}},ha=class extends se{constructor(t){super(t)}parentDirectoryLba(){return this._data.readUInt32LE(4)}},hn=class extends se{constructor(t){super(t)}};var pn=class extends se{constructor(t){super(t)}flags(){return this._data[4]}creation(){return this.flags()&1?this._longFormDates()?He(this._data,5):Gt(this._data,5):null}modify(){if(this.flags()&2){let t=this.flags()&1?1:0;return this._longFormDates()?He(this._data,5+t*17):Gt(this._data,5+t*7)}else return null}access(){if(this.flags()&4){let t=this.flags()&1?1:0;return t+=this.flags()&2?1:0,this._longFormDates()?He(this._data,5+t*17):Gt(this._data,5+t*7)}else return null}backup(){if(this.flags()&16){let t=this.flags()&1?1:0;return t+=this.flags()&2?1:0,t+=this.flags()&4?1:0,this._longFormDates()?He(this._data,5+t*17):Gt(this._data,5+t*7)}else return null}expiration(){if(this.flags()&32){let t=this.flags()&1?1:0;return t+=this.flags()&2?1:0,t+=this.flags()&4?1:0,t+=this.flags()&16?1:0,this._longFormDates()?He(this._data,5+t*17):Gt(this._data,5+t*7)}else return null}effective(){if(this.flags()&64){let t=this.flags()&1?1:0;return t+=this.flags()&2?1:0,t+=this.flags()&4?1:0,t+=this.flags()&16?1:0,t+=this.flags()&32?1:0,this._longFormDates()?He(this._data,5+t*17):Gt(this._data,5+t*7)}else return null}_longFormDates(){return!!this.flags()}},pa=class extends se{constructor(t){super(t)}virtualSizeHigh(){return this._data.readUInt32LE(4)}virtualSizeLow(){return this._data.readUInt32LE(12)}tableDepth(){return this._data[20]}},gn=class{constructor(t,e){this._fileList=[];this._fileMap={};this._record=t;let i=t.lba(),n=i+t.dataLength();for(t.fileFlags()&2||(i=t.getSUEntries(e).filter(a=>a instanceof Gr)[0].childDirectoryLba()*2048,n=1/0);i<n;){if(e[i]===0){i++;continue}let a=this._constructDirectoryRecord(e.slice(i)),o=a.fileName(e);o!=="\0"&&o!==""?(!a.hasRockRidge()||a.getSUEntries(e).filter(c=>c instanceof hn).length===0)&&(this._fileMap[o]=a,this._fileList.push(o)):n===1/0&&(n=i+a.dataLength()),i+=a.length()}}getRecord(t){return this._fileMap[t]}getFileList(){return this._fileList}getDotEntry(t){return this._constructDirectoryRecord(t.slice(this._record.lba()))}},ga=class extends gn{constructor(t,e){super(t,e)}_constructDirectoryRecord(t){return new nn(t,this._record.getRockRidgeOffset())}},ma=class extends gn{constructor(t,e){super(t,e)}_constructDirectoryRecord(t){return new sn(t,this._record.getRockRidgeOffset())}},ba=class extends Ae{constructor(e,i=""){super();this._data=e;let n=!1,s=16*2048,a=new Array;for(;!n;){let o=e.slice(s);switch(new en(o).type()){case 1:a.push(new oa(o));break;case 2:a.push(new la(o));break;case 255:n=!0;break}s+=2048}if(a.length===0)throw new f(5,"Unable to find a suitable volume descriptor.");a.forEach(o=>{(!this._pvd||this._pvd.type()!==2)&&(this._pvd=o)}),this._root=this._pvd.rootDirectoryEntry(e),this._name=i}static Create(e,i){try{i(null,new ba(e.data,e.name))}catch(n){i(n)}}static CreateAsync(e){return new Promise((i,n)=>{this.Create(e,(s,a)=>{s||!a?n(s):i(a)})})}static isAvailable(){return!0}getName(){let e=`IsoFS${this._name}${this._pvd?`-${this._pvd.name()}`:""}`;return this._root&&this._root.hasRockRidge()&&(e+="-RockRidge"),e}diskSpace(e,i){i(this._data.length,0)}isReadOnly(){return!0}supportsLinks(){return!1}supportsProps(){return!1}supportsSynch(){return!0}statSync(e,i){let n=this._getDirectoryRecord(e);if(n===null)throw f.ENOENT(e);return this._getStats(e,n)}openSync(e,i,n){if(i.isWriteable())throw new f(1,e);let s=this._getDirectoryRecord(e);if(s){if(s.isSymlink(this._data))return this.openSync(Y(e,s.getSymlinkPath(this._data)),i,n);{let a=s.isDirectory(this._data)?void 0:s.getFile(this._data),o=this._getStats(e,s);switch(i.pathExistsAction()){case 1:case 2:throw f.EEXIST(e);case 0:return new ve(this,e,i,o,a);default:throw new f(22,"Invalid FileMode object.")}}}else throw f.ENOENT(e)}readdirSync(e){let i=this._getDirectoryRecord(e);if(i){if(i.isDirectory(this._data))return i.getDirectory(this._data).getFileList().slice(0);throw f.ENOTDIR(e)}else throw f.ENOENT(e)}readFileSync(e,i,n){let s=this.openSync(e,n,420);try{let o=s.getBuffer();return i===null?Ve(o):o.toString(i)}finally{s.closeSync()}}_getDirectoryRecord(e){if(e==="/")return this._root;let i=e.split("/").slice(1),n=this._root;for(let s of i)if(n.isDirectory(this._data)){if(n=n.getDirectory(this._data).getRecord(s),!n)return null}else return null;return n}_getStats(e,i){if(i.isSymlink(this._data)){let n=Y(e,i.getSymlinkPath(this._data)),s=this._getDirectoryRecord(n);return s?this._getStats(n,s):null}else{let n=i.dataLength(),s=365,a=i.recordingDate().getTime(),o=a,c=a,l=a;if(i.hasRockRidge()){let u=i.getSUEntries(this._data);for(let d of u)if(d instanceof fn)s=d.mode();else if(d instanceof pn){let h=d.flags();h&4&&(o=d.access().getTime()),h&2&&(c=d.modify().getTime()),h&1&&(l=d.creation().getTime())}}return s=s&365,new C(i.isDirectory(this._data)?16384:32768,n,s,o,c,l)}}},It=ba;It.Name="IsoFS",It.Options={data:{type:"object",description:"The ISO file in a buffer",validator:Sr}};[ht,pt,gt,mt,Ne,Be,Ge,It,$e,Le,Qe,St,rt,Te].forEach(r=>{let t=r.Create;r.Create=function(e,i){let n=typeof e=="function",s=n?e:i,a=n?{}:e;function o(c){c?s(c):t.call(r,a,s)}Rn(r,a,o)}});var Ch={AsyncMirror:ht,Dropbox:pt,Emscripten:gt,FileSystemAccess:mt,FolderAdapter:Ne,InMemory:Be,IndexedDB:Ge,IsoFS:It,LocalStorage:$e,MountableFileSystem:Le,OverlayFS:Qe,WorkerFS:St,HTTPRequest:rt,XmlHttpRequest:rt,ZipFS:Te};var $r=Ch;Ke&&void 0&&(void 0)();function xh(r){r.Buffer=Buffer,r.process=Ke;let t=r.require?r.require:null;r.require=function(e){let i=Hc(e);return i||t.apply(null,Array.prototype.slice.call(arguments,0))}}function Ah(r,t){$r[r]=t}function Hc(r){switch(r){case"fs":return re;case"path":return be;case"buffer":return En;case"process":return Ke;case"bfs_utils":case"bfs-utils":return Nn;default:return $r[r]}}function ya(r,t=0,e=0){let i=new z(t,e,t,e,t,e);return re.initialize(r,i)}function kh(r,t){mn(r,(e,i)=>{i?(ya(i),t()):t(e)})}function Bh(r){return new Promise((t,e)=>{mn(r,(i,n)=>{n?(ya(n),t(n)):e(i)})})}function mn(r,t){let e=r.fs;if(!e)return t(new f(1,'Missing "fs" property on configuration object.'));let i=r.options,n=0,s=!1;function a(){if(!s){s=!0;let o=$r[e];o?o.Create(i,t):t(new f(1,`File system ${e} is not available in BrowserFS.`))}}if(i!==null&&typeof i=="object"){let o=!1;Object.keys(i).filter(l=>l!=="fs").forEach(l=>{let u=i[l];u!==null&&typeof u=="object"&&u.fs&&(n++,mn(u,function(d,h){if(n--,d){if(s)return;s=!0,t(d)}else i[l]=h,n===0&&o&&a()}))}),o=!0}n===0&&a()}return Yc(Oh);})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
//# sourceMappingURL=browserfs.min.js.map
